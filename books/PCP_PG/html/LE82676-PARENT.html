<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns:d="http://docbook.org/ns/docbook">2.2.2. DSO PMDA</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.2" /><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content="PCP-pcp-programmers-guide-3-en-US-4.0-4" /><link rel="home" href="index.html" title="Performance Co-Pilot™ Programmer's Guide" /><link rel="up" href="id5188149.html" title="2.2. PMDA Architecture" /><link rel="prev" href="id5188149.html" title="2.2. PMDA Architecture" /><link rel="next" href="id5188840.html" title="2.2.3. Daemon PMDA" /></head><body><p id="title"><a class="left" href="https://fedorahosted.org/publican"><img alt="Product Site" src="Common_Content/images//image_left.png" /></a><a class="right" href="https://fedorahosted.org/publican"><img alt="Documentation Site" src="Common_Content/images//image_right.png" /></a></p><ul class="docnav top"><li class="previous"><a accesskey="p" href="id5188149.html"><strong>Prev</strong></a></li><li class="home">pcp-programmers-guide</li><li class="next"><a accesskey="n" href="id5188840.html"><strong>Next</strong></a></li></ul><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="LE82676-PARENT">
      ⁠</a>2.2.2. DSO PMDA</h3></div></div></div><div class="para">
					<a id="IG3134017795" class="indexterm"></a> <a id="IG3134017796" class="indexterm"></a>Each PMDA is required to implement a function that handles each of the request types. By implementing these functions as library functions, a PMDA can be implemented as a dynamically shared object (DSO) and attached by PMCD at run time with a platform-specific call, such as <code class="command">dlopen</code>; see the <code class="command">dlopen(3)</code> man page. This eliminates the need for an IPC layer (typically a pipe) between each PMDA and PMCD, because each request becomes a function call rather than a message exchange. The required library functions are detailed in <a class="xref" href="LE21831-PARENT.html">Section 2.5, “PMDA Interface”</a>.
				</div><div class="para">
					A PMDA that interacts with PMCD in this fashion must abide by a formal initialization protocol so that PMCD can discover the location of the library functions that are subsequently called with function pointers. When a DSO PMDA is installed, the PMCD configuration file, <code class="filename">${PCP_PMCDCONF_PATH}</code>, is updated to reflect the domain and name of the PMDA, the location of the shared object, and the name of the initialization function. The initialization sequence is discussed in <a class="xref" href="LE19047-PARENT.html">Section 2.6, “Initializing a PMDA”</a>.
				</div><div class="para">
					<a id="IG3134017797" class="indexterm"></a>As superuser, install the simple PMDA as a DSO, as shown in <a class="xref" href="LE82676-PARENT.html#Z1033502809tls">Example 2.1, “Simple PMDA as a DSO”</a>, and observe the changes in the PMCD configuration file. The output may differ slightly depending on the operating system you are using, any other PMDAs you have installed or any PMCD access controls you have in place.
				</div><div class="para">
					<div class="example"><a id="Z1033502809tls">
      ⁠</a><p class="title"><strong>Example 2.1. Simple PMDA as a DSO</strong></p><div class="example-contents"><pre class="programlisting">
              <strong class="userinput"><code>cat ${PCP_PMCDCONF_PATH}</code></strong>
# Performance Metrics Domain Specifications
# 
# This file is automatically generated during the build
# Name  Id      IPC     IPC Params      File/Cmd
pmcd    2       dso     pmcd_init       ${PCP_PMDAS_DIR}/pmcd/pmda_pmcd.so
linux   60      dso     linux_init      ${PCP_PMDAS_DIR}/linux/pmda_linux.so
proc    3       pipe    binary          ${PCP_PMDAS_DIR}/linux/pmda_proc.so -d 3
simple  254     dso     simple_init     ${PCP_PMDAS_DIR}/simple/pmda_simple.so</pre></div></div>

				</div><div class="para">
					As can be seen from the contents of <code class="filename">${PCP_PMCDCONF_PATH}</code>, the DSO version of the simple PMDA is in a library named <code class="filename">pmda_simple.so</code> and has an initialization function called <a id="IG3134017799" class="indexterm"></a> <code class="command">simple_init</code>. The domain of the simple PMDA is 254, as shown in the column headed <code class="literal">Id</code>.
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						For some platforms the DSO file name will not be <code class="filename">pmda_simple.so</code>. On Mac OS X it is <code class="filename">pmda_simple.dylib</code> and on Windows it is <code class="filename">pmda_simple.dll</code>.
					</div></div></div></div><ul class="docnav"><li class="previous"><a accesskey="p" href="id5188149.html"><strong>Prev</strong>2.2. PMDA Architecture</a></li><li class="up"><a accesskey="u" href="#"><strong>Up</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Home</strong></a></li><li class="next"><a accesskey="n" href="id5188840.html"><strong>Next</strong>2.2.3. Daemon PMDA</a></li></ul></body></html>