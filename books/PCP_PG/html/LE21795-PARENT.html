<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format"><head xmlns="http://www.w3.org/1999/xhtml"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns:d="http://docbook.org/ns/docbook">Chapter 1. Programming Performance Co-Pilot</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.2" /><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content="PCP-pcp-programmers-guide-3-en-US-4.0-4" /><link rel="home" href="index.html" title="Performance Co-Pilot™ Programmer's Guide" /><link rel="up" href="index.html" title="Performance Co-Pilot™ Programmer's Guide" /><link rel="prev" href="z825546061melby.html" title="7. Reader Comments" /><link rel="next" href="LE13618-PARENT.html" title="1.2. Overview of Component Software" />
<meta xmlns="" charset="utf-8" />
<meta xmlns="" content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
<meta xmlns="" content="initial-scale=1" name="viewport" />
<title xmlns="">Performance Co-Pilot</title>
<link xmlns="" href="/assets/css/screen.css" media="all" rel="stylesheet" type="text/css" />
<link xmlns="" href="/assets/css/master.css" media="all" rel="stylesheet" type="text/css" />
<link xmlns="" href="/images/pcp.ico" rel="shortcut icon" type="image/ico" />
</head><body>
    <header xmlns="" class="global-header">
      <div class="row">
        <h1 class="global-logo colspan12-6 colspan8-4 colspan6-3 colspan2-1 as-grid">
          <a href="/index.html">Performance Co-Pilot</a>
        </h1>
        <nav class="global-header__navigation colspan12-6 colspan8-6 colspan6-4 colspan2-1 as-grid">
          <ul>
            <li>
              <a href="/features.html">Features</a>
            </li>
            <li>
              <a href="/documentation.html">Documentation</a>
            </li>
            <li>
              <a href="/download.html">Download</a>
            </li>
            <li>
              <a href="/community.html">Get Involved</a>
            </li>
          </ul>
        </nav>
      </div>
    </header>
<div class="site-content"><div class="how-to is-typeset"><div class="row-parent"><div class="row"><p xmlns="http://www.w3.org/1999/xhtml" id="title"><a class="left" href="https://pcp.io"><img alt="Product Site" src="Common_Content/images//image_left.png" /></a><a class="right" href="https://pcp.io/documentation.html"><img alt="Documentation Site" src="Common_Content/images//image_right.png" /></a></p><ul xmlns="http://www.w3.org/1999/xhtml" class="docnav top"><li class="previous"><a accesskey="p" href="z825546061melby.html"><strong>Prev</strong></a></li><li class="home">pcp-programmers-guide</li><li class="next"><a accesskey="n" href="LE13618-PARENT.html"><strong>Next</strong></a></li></ul><div xmlns="http://www.w3.org/1999/xhtml" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="LE21795-PARENT">
      ⁠</a>Chapter 1. Programming Performance Co-Pilot</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="LE21795-PARENT.html#id5177140">1.1. PCP Architecture</a></span></dt><dd><dl><dt><span class="section"><a href="LE21795-PARENT.html#id5177343">1.1.1. Distributed Collection</a></span></dt><dt><span class="section"><a href="LE21795-PARENT.html#id5177529">1.1.2. Name Space</a></span></dt><dt><span class="section"><a href="LE21795-PARENT.html#id5177616">1.1.3. Distributed PMNS</a></span></dt><dt><span class="section"><a href="LE21795-PARENT.html#id5177692">1.1.4. Retrospective Sources of Performance Metrics</a></span></dt></dl></dd><dt><span class="section"><a href="LE13618-PARENT.html">1.2. Overview of Component Software</a></span></dt><dd><dl><dt><span class="section"><a href="LE13618-PARENT.html#id5177879">1.2.1. Application and Agent Development</a></span></dt></dl></dd><dt><span class="section"><a href="LE16056-PARENT.html">1.3. PMDA Development</a></span></dt><dd><dl><dt><span class="section"><a href="LE16056-PARENT.html#id5178205">1.3.1. Overview</a></span></dt><dt><span class="section"><a href="id5178242.html">1.3.2. Building a PMDA</a></span></dt></dl></dd><dt><span class="section"><a href="id5178467.html">1.4. Client Development and PMAPI</a></span></dt><dt><span class="section"><a href="id5187605.html">1.5. Library Reentrancy and Threaded Applications</a></span></dt></dl></div><div class="para">
			<a id="IG313401770" class="indexterm"></a>Performance Co-Pilot (PCP) provides a systems-level suite of tools that cooperate to deliver distributed, integrated performance management services. PCP is designed for the in-depth analysis and sophisticated control that are needed to understand and manage the hardest performance problems in the most complex systems.
		</div><div class="para">
			PCP provides unparalleled power to quickly isolate and understand performance behavior, resource utilization, activity levels and performance bottlenecks.
		</div><div class="para">
			Performance data may be collected and exported from multiple sources, most notably the hardware platform, the operating system kernel, layered services, and end-user applications.
		</div><div class="para">
			<a id="IG313401771" class="indexterm"></a> <a id="IG313401772" class="indexterm"></a>There are several ways to extend PCP by programming certain of its components:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					<a id="Z963349317sdc" class="indexterm"></a> <a id="IG313401773" class="indexterm"></a>By writing a Performance Metrics Domain Agent (PMDA) to collect performance metrics from an uncharted performance domain (<a class="xref" href="LE98072-PARENT.html">Chapter 2, <em>Writing a PMDA</em></a>)
				</div></li><li class="listitem"><div class="para">
					<a id="Z963349400sdc" class="indexterm"></a> <a id="IG313401774" class="indexterm"></a>By creating new analysis or visualization tools using documented functions from the Performance Metrics Application Programming Interface (PMAPI) (<a class="xref" href="LE97135-PARENT.html">Chapter 3, <em>PMAPI--The Performance Metrics API</em></a>)
				</div></li><li class="listitem"><div class="para">
					<a id="IG313401775" class="indexterm"></a> <a id="IG313401776" class="indexterm"></a>By adding performance instrumentation to an application using facilities from PCP libraries, which offer both sampling and event tracing models.
				</div></li></ul></div><div class="para">
			<a id="IG313401777" class="indexterm"></a>Finally, the topic of customizing an installation is covered in the chapter on customizing and extending PCP service in the <em class="citetitle">Performance Co-Pilot User's and Administrator's Guide</em>.
		</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="id5177140">
      ⁠</a>1.1. PCP Architecture</h2></div></div></div><div class="para">
				<a id="IG313401778" class="indexterm"></a>This section gives a brief overview of PCP architecture. For an explanation of terms and acronyms, refer to <a class="xref" href="LE54271-PARENT.html">Appendix A, <em>Acronyms</em></a>.
			</div><div class="para">
				<a id="IG313401779" class="indexterm"></a> <a id="IG3134017711" class="indexterm"></a> <a id="IG3134017712" class="indexterm"></a>PCP consists of numerous monitoring and collecting tools. <code class="literal">Monitoring tools</code> such as <code class="command">pmval</code> and <code class="command">pminfo</code> report on metrics, but have minimal interaction with target systems. <code class="literal">Collection tools</code>, called PMDAs, extract performance values from target systems, but do not provide user interfaces.
			</div><div class="para">
				Systems supporting PCP services are broadly classified into two categories:
			</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Collector</span></dt><dd><div class="para">
							Hosts that have the PMCD and one or more PMDAs running to collect and export performance metrics
						</div></dd><dt><span class="term">Monitor</span></dt><dd><div class="para">
							Hosts that import performance metrics from one or more collector hosts to be consumed by tools to monitor, manage, or record the performance of the collector hosts
						</div></dd></dl></div><div class="para">
				Each PCP enabled host can operate as a collector, or a monitor, or both.
			</div><div class="para">
				<a class="xref" href="LE21795-PARENT.html#id5177328">Figure 1.1, “PCP Global Process Architecture”</a> shows the architecture of PCP. The monitoring tools consume and process performance data using a public interface, the Performance Metrics Application Programming Interface (PMAPI).
			</div><div class="para">
				<a id="IG3134017713" class="indexterm"></a> <a id="IG3134017714" class="indexterm"></a>Below the PMAPI level is the PMCD process, which acts in a coordinating role, accepting requests from clients, routing requests to one or more PMDAs, aggregating responses from the PMDAs, and responding to the requesting client.
			</div><div class="para">
				Each performance metric domain (such as the operating system kernel or a database management system) has a well-defined name space for referring to the specific performance metrics it knows how to collect.
			</div><div class="para">
				<div class="figure"><a id="id5177328">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/local-collector.svg" type="image/svg+xml"><img src="images/local-collector.png" alt="PCP Global Process Architecture" /></object></div></div><p class="title"><strong>Figure 1.1. PCP Global Process Architecture</strong></p></div>

			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5177343">
      ⁠</a>1.1.1. Distributed Collection</h3></div></div></div><div class="para">
					<a id="IG3134017715" class="indexterm"></a> <a id="IG3134017716" class="indexterm"></a> <a id="IG3134017717" class="indexterm"></a>The performance metrics collection architecture is distributed, in the sense that any monitoring tool may be executing remotely. However, a PMDA is expected to be running on the operating system for which it is collecting performance measurements; there are some notable PMDAs such as Cisco and Cluster that are exceptions, and collect performance data from remote systems.
				</div><div class="para">
					<a id="IG3134017718" class="indexterm"></a> <a id="IG3134017719" class="indexterm"></a>As shown in <a class="xref" href="LE21795-PARENT.html#id5177408">Figure 1.2, “Process Structure for Distributed Operation”</a>, monitoring tools communicate only with PMCD. The PMDAs are controlled by PMCD and respond to requests from the monitoring tools that are forwarded by PMCD to the relevant PMDAs on the collector host.
				</div><div class="para">
					<div class="figure"><a id="id5177408">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/remote-collector.svg" type="image/svg+xml"><img src="images/remote-collector.png" alt="Process Structure for Distributed Operation" /></object></div></div><p class="title"><strong>Figure 1.2. Process Structure for Distributed Operation</strong></p></div>

				</div><div class="para">
					The host running the monitoring tools does not require any collection tools, including PMCD, since all requests for metrics are sent to the PMCD process on the collector host.
				</div><div class="para">
					<a id="IG3134017720" class="indexterm"></a> <a id="IG3134017721" class="indexterm"></a>The connections between monitoring tools and PMCD processes are managed in <code class="filename">libpcp</code>, below the PMAPI level; see the <code class="command">PMAPI(3)</code> man page. Connections between PMDAs and PMCD are managed by the PMDA functions; see the <code class="command">PMDA(3)</code> and <code class="command">pmcd(1)</code> man pages. There can be multiple monitor clients and multiple PMDAs on the one host, but there may be only one PMCD process.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5177529">
      ⁠</a>1.1.2. Name Space</h3></div></div></div><div class="para">
					<a id="IG3134017722" class="indexterm"></a> <a id="IG3134017723" class="indexterm"></a> <a id="IG3134017724" class="indexterm"></a>Each PMDA provides a domain of metrics, whether they be for the operating system, a database manager, a layered service, or an application module. These metrics are referred to by name inside the user interface, and with a numeric Performance Metric Identifier (PMID) within the underlying PMAPI.
				</div><div class="para">
					<a id="IG3134017725" class="indexterm"></a> <a id="IG3134017726" class="indexterm"></a> <a id="IG3134017727" class="indexterm"></a>The PMID consists of three fields: the domain, the cluster, and the item number of the metric. The domain is a unique number assigned to each PMDA. For example, two metrics with the same domain number must be from the same PMDA. The cluster and item numbers allow metrics to be easily organized into groups within the PMDA, and provide a hierarchical taxonomy to guarantee uniqueness within each PMDA.
				</div><div class="para">
					<a id="IG3134017728" class="indexterm"></a>The Performance Metrics Name Space (PMNS) describes the exported performance metrics, in particular the mapping from PMID to external name, and vice-versa.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5177616">
      ⁠</a>1.1.3. Distributed PMNS</h3></div></div></div><div class="para">
					<a id="IG3134017729" class="indexterm"></a> Performance metric namespace (PMNS) operations are directed by default to the host or set of archives that is the source of the desired performance metrics.
				</div><div class="para">
					In <a class="xref" href="LE21795-PARENT.html#id5177408">Figure 1.2, “Process Structure for Distributed Operation”</a>, both Performance Metrics Collection Daemon (PMCD) processes would respond to PMNS queries from monitoring tools by referring to their local PMNS. If different PMDAs were installed on the two hosts, then the PMNS used by each PMCD would be different, to reflect variations in available metrics on the two hosts.
				</div><div class="para">
					Although extremely rarely used, the <code class="command">-n</code> <em class="replaceable">pmnsfile</em> command line option may be used with many PCP monitoring tools to force use of a local PMNS file in preference to the PMNS at the source of the metrics.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5177692">
      ⁠</a>1.1.4. Retrospective Sources of Performance Metrics</h3></div></div></div><div class="para">
					<a id="IG3134017730" class="indexterm"></a>The distributed collection architecture described in the previous section is used when PMAPI clients are requesting performance metrics from a real-time or live source.
				</div><div class="para">
					<a id="IG3134017731" class="indexterm"></a>The PMAPI also supports delivery of performance metrics from a historical source in the form of a PCP archive log. Archive logs are created using the <code class="command">pmlogger</code> utility, and are replayed in an architecture as shown in <a class="xref" href="LE21795-PARENT.html#id5177742">Figure 1.3, “Architecture for Retrospective Analysis”</a>.
				</div><div class="para">
					<div class="figure"><a id="id5177742">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/retrospective-architecture.svg" type="image/svg+xml"><img src="images/retrospective-architecture.png" alt="Architecture for Retrospective Analysis" /></object></div></div><p class="title"><strong>Figure 1.3. Architecture for Retrospective Analysis</strong></p></div>

				</div></div></div></div><ul xmlns="http://www.w3.org/1999/xhtml" class="docnav"><li class="previous"><a accesskey="p" href="z825546061melby.html"><strong>Prev</strong>7. Reader Comments</a></li><li class="up"><a accesskey="u" href="#"><strong>Up</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Home</strong></a></li><li class="next"><a accesskey="n" href="LE13618-PARENT.html"><strong>Next</strong>1.2. Overview of Component Software</a></li></ul></div></div></div></div>
<footer xmlns="" class="global-footer is-typeset">
  <div class="row-parent">
    <div class="row">
      <section class="row__colspaced"><div class="colspan12-3 colspan8-2 colspan6-2 colspan2-2 as-grid with-gutter">
          <div class="col__module">
            <h4>Main Menu</h4>
            <ul>
              <li>
                <a href="/features.html">Features</a>
              </li>
              <li>
                <a href="/documentation.html">Documentation</a>
              </li>
              <li>
                <a class="download" href="/download.html">Download</a>
              </li>
            </ul>
          </div>
        </div><div class="colspan12-3 colspan8-2 colspan6-2 colspan2-2 as-grid with-gutter">
          <div class="col__module">
            <h4>Developers</h4>
            <ul>
              <li>
                <a href="http://git.pcp.io/bugzilla">Report a bug</a>
              </li>
              <li>
                <a href="/community.html">Contributing</a>
              </li>
              <li>
                <a href="/team.html">Team</a>
              </li>
            </ul>
          </div>
        </div><div class="colspan12-3 colspan8-2 colspan6-2 colspan2-2 as-grid with-gutter">
          <div class="col__module">
            <h4>About</h4>
            <ul>
              <li>
                <a href="/news.html">News</a>
              </li>
              <li>
                <a href="/testimonials.html">Testimonials</a>
              </li>
              <li>
                <a href="/faq.html">FAQ</a>
              </li>
              <li>
                <a href="/website.html">Website</a>
              </li>
            </ul>
          </div>
        </div><div class="colspan12-3 colspan8-2 colspan6-2 colspan2-2 as-grid with-gutter">
          <div class="col__module">
            <h4>Get Social</h4>
            <ul>
              <li>
                <a class="twitter" href="https://twitter.com/performancepcp" rel="external">Twitter</a>
              </li>
              <li>
                <a class="github" href="https://github.com/performancecopilot" rel="external">Github</a>
              </li>
            </ul>
          </div>
        </div></section>
    </div>
    <div class="row">
      <div class="colspan2-2">
        <p class="legal">
          Copyright 2000-2004 Silicon Graphics Inc, 2007-2010 Aconex, 2012-2015 Red Hat
        </p>
      </div>
    </div>
  </div>
</footer>
</body></html>