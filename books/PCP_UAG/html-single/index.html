<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/TR/xhtml1/transitional"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="http://www.w3.org/1999/xhtml" xmlns:d="http://docbook.org/ns/docbook">Performance Co-Pilot™ User's and Administrator's Guide</title><link xmlns="http://www.w3.org/1999/xhtml" rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link xmlns="http://www.w3.org/1999/xhtml" rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta xmlns="http://www.w3.org/1999/xhtml" xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.2" /><meta xmlns="http://www.w3.org/1999/xhtml" xmlns:d="http://docbook.org/ns/docbook" name="package" content="PCP-pcp-users-and-administrators-guide-3-en-US-2.0-2" />
<meta xmlns="" charset="utf-8" />
<meta xmlns="" content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
<meta xmlns="" content="initial-scale=1" name="viewport" />
<title xmlns="">Performance Co-Pilot</title>
<link xmlns="" href="/assets/css/screen.css" media="all" rel="stylesheet" type="text/css" />
<link xmlns="" href="/assets/css/master.css" media="all" rel="stylesheet" type="text/css" />
<link xmlns="" href="/images/pcp.ico" rel="shortcut icon" type="image/ico" />
</head><body>
    <header xmlns="" class="global-header">
      <div class="row">
        <h1 class="global-logo colspan12-6 colspan8-4 colspan6-3 colspan2-1 as-grid">
          <a href="/index.html">Performance Co-Pilot</a>
        </h1>
        <nav class="global-header__navigation colspan12-6 colspan8-6 colspan6-4 colspan2-1 as-grid">
          <ul>
            <li>
              <a href="/features.html">Features</a>
            </li>
            <li>
              <a href="/documentation.html">Documentation</a>
            </li>
            <li>
              <a href="/download.html">Download</a>
            </li>
            <li>
              <a href="/community.html">Get Involved</a>
            </li>
          </ul>
        </nav>
      </div>
    </header>
<div class="site-content"><div class="how-to is-typeset"><div class="row-parent"><div class="row"><p xmlns="http://www.w3.org/1999/xhtml" id="title"><a class="left" href="http://www.pcp.io"><img alt="Product Site" src="Common_Content/images//image_left.png" /></a><a class="right" href="http://www.pcp.io/documentation.html"><img alt="Documentation Site" src="Common_Content/images//image_right.png" /></a></p><div xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" class="book" lang="en-US"><div class="titlepage"><div><div font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" font-size="12pt" text-align="center"><h1 class="title"><a id="idm45217304432224"></a>Performance Co-Pilot™ User's and Administrator's Guide</h1></div><p xmlns:d="http://docbook.org/ns/docbook" class="edition">Edition 3</p><div font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" font-size="12pt" text-align="center"><div class="othercredit"><h3 class="othercredit"></h3><span class="contrib">Maintained by</span> <div class="affiliation"><span xmlns:d="http://docbook.org/ns/docbook" class="orgname">The Performance Co-Pilot Development Team</span><div class="address"><div class="para"><br />
<code class="email"><a class="email" href="mailto:pcp@groups.io">pcp@groups.io</a></code><br />
				<br />
<span class="otheraddr"><a href="http://pcp.io">http://pcp.io</a><br />
				<span class="inlinemediaobject"><object data="images/pcp.svg" type="image/svg+xml"><img src="images/pcp.png" alt="" /></object></span><br />
				</span></div></div></div></div></div><div font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" font-size="12pt" text-align="center"><p class="copyright">Copyright © 2000, 2013 Silicon Graphics, Inc.</p></div><div font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" font-size="12pt" text-align="center"><p class="copyright">Copyright © 2013, 2015, 2016 Red Hat, Inc.</p></div><div font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" font-size="12pt" text-align="center"><div class="legalnotice"><a id="idm45217411307072"></a><h1 class="legalnotice">Legal Notice</h1><p class="legalnotice-title"><strong>LICENSE</strong></p><div class="para">
				Permission is granted to copy, distribute, and/or modify this document under the terms of the Creative Commons Attribution-Share Alike, Version 3.0 or any later version published by the Creative Commons Corp. A copy of the license is available at <a href="http://creativecommons.org/licenses/by-sa/3.0/us/">http://creativecommons.org/licenses/by-sa/3.0/us/</a>
			</div></div></div><div font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" font-size="12pt" text-align="center"><div class="legalnotice"><a id="idm45217411305072"></a><h1 class="legalnotice">Legal Notice</h1><p class="legalnotice-title"><strong>TRADEMARKS AND ATTRIBUTIONS</strong></p><div class="para">
				Silicon Graphics, SGI and the SGI logo are registered trademarks and Performance Co-Pilot is a trademark of Silicon Graphics, Inc.
			</div><div class="para">
				Red Hat and the Shadowman logo are trademarks of Red Hat, Inc., registered in the United States and other countries.
			</div><div class="para">
				Cisco is a trademark of Cisco Systems, Inc. Linux is a registered trademark of Linus Torvalds, used with permission. UNIX is a registered trademark of The Open Group.
			</div></div></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="preface"><a href="#id5178699">About This Guide</a></span></dt><dd><dl><dt><span class="section"><a href="#id5178738">1. What This Guide Contains</a></span></dt><dt><span class="section"><a href="#id5178921">2. Audience for This Guide</a></span></dt><dt><span class="section"><a href="#id5178935">3. Related Resources</a></span></dt><dt><span class="section"><a href="#id5178967">4. Man Pages</a></span></dt><dt><span class="section"><a href="#id5178968">5. Web Site</a></span></dt><dt><span class="section"><a href="#id5179060">6. Conventions</a></span></dt><dt><span class="section"><a href="#z825546061melby">7. Reader Comments</a></span></dt></dl></dd><dt><span class="chapter"><a href="#LE91944-PARENT">1. Introduction to PCP</a></span></dt><dd><dl><dt><span class="section"><a href="#LE92676-PARENT">1.1. Objectives</a></span></dt><dd><dl><dt><span class="section"><a href="#LE67354-PARENT">1.1.1. PCP Target Usage</a></span></dt><dt><span class="section"><a href="#LE79006-PARENT">1.1.2. Empowering the PCP User</a></span></dt><dt><span class="section"><a href="#LE35382-PARENT">1.1.3. Unification of Performance Metric Domains</a></span></dt><dt><span class="section"><a href="#LE83994-PARENT">1.1.4. Uniform Naming and Access to Performance Metrics </a></span></dt><dt><span class="section"><a href="#LE85063-PARENT">1.1.5. PCP Distributed Operation</a></span></dt><dt><span class="section"><a href="#LE87326-PARENT">1.1.6. Dynamic Adaptation to Change</a></span></dt><dt><span class="section"><a href="#LE13859-PARENT">1.1.7. Logging and Retrospective Analysis</a></span></dt><dt><span class="section"><a href="#LE36677-PARENT">1.1.8. Automated Operational Support</a></span></dt><dt><span class="section"><a href="#LE38522-PARENT">1.1.9. PCP Extensibility</a></span></dt><dt><span class="section"><a href="#LE40772-PARENT">1.1.10. Metric Coverage</a></span></dt></dl></dd><dt><span class="section"><a href="#LE79836-PARENT">1.2. Conceptual Foundations</a></span></dt><dd><dl><dt><span class="section"><a href="#id5188366">1.2.1. Performance Metrics</a></span></dt><dt><span class="section"><a href="#id5188440">1.2.2. Performance Metric Instances</a></span></dt><dt><span class="section"><a href="#id5188469">1.2.3. Current Metric Context</a></span></dt><dt><span class="section"><a href="#id5188562">1.2.4. Sources of Performance Metrics and Their Domains</a></span></dt><dt><span class="section"><a href="#id5188837">1.2.5. Distributed Collection</a></span></dt><dt><span class="section"><a href="#LE94677-PARENT">1.2.6. Performance Metrics Name Space</a></span></dt><dt><span class="section"><a href="#id5189172">1.2.7. Descriptions for Performance Metrics</a></span></dt><dt><span class="section"><a href="#id5189302">1.2.8. Values for Performance Metrics</a></span></dt><dt><span class="section"><a href="#id5189653">1.2.9. Collector and Monitor Roles</a></span></dt><dt><span class="section"><a href="#id5189901">1.2.10. Retrospective Sources of Performance Metrics</a></span></dt><dt><span class="section"><a href="#id5189964">1.2.11. Product Extensibility</a></span></dt></dl></dd><dt><span class="section"><a href="#LE13618-PARENT">1.3. Overview of Component Software</a></span></dt><dd><dl><dt><span class="section"><a href="#id5177430">1.3.1. Performance Monitoring and Visualization</a></span></dt><dt><span class="section"><a href="#id5177776">1.3.2. Collecting, Transporting, and Archiving Performance Information </a></span></dt><dt><span class="section"><a href="#id5187554">1.3.3. Operational and Infrastructure Support</a></span></dt><dt><span class="section"><a href="#id5188066">1.3.4. Application and Agent Development</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#LE17127-PARENT">2. Installing and Configuring Performance Co-Pilot</a></span></dt><dd><dl><dt><span class="section"><a href="#LE18649-PARENT">2.1. Product Structure</a></span></dt><dt><span class="section"><a href="#LE26146-PARENT">2.2. Performance Metrics Collection Daemon (PMCD)</a></span></dt><dd><dl><dt><span class="section"><a href="#id5190406">2.2.1. Starting and Stopping the PMCD</a></span></dt><dt><span class="section"><a href="#LE58493-PARENT">2.2.2. Restarting an Unresponsive PMCD</a></span></dt><dt><span class="section"><a href="#id5190621">2.2.3. PMCD Diagnostics and Error Messages</a></span></dt><dt><span class="section"><a href="#id5190661">2.2.4. PMCD Options and Configuration Files</a></span></dt></dl></dd><dt><span class="section"><a href="#LE43202-PARENT">2.3. Managing Optional PMDAs</a></span></dt><dd><dl><dt><span class="section"><a href="#LE31599-PARENT">2.3.1. PMDA Installation on a PCP Collector Host</a></span></dt><dt><span class="section"><a href="#id5192380">2.3.2. PMDA Removal on a PCP Collector Host</a></span></dt></dl></dd><dt><span class="section"><a href="#LE70712-PARENT">2.4. Troubleshooting</a></span></dt><dd><dl><dt><span class="section"><a href="#LE97133-PARENT">2.4.1. Performance Metrics Name Space</a></span></dt><dt><span class="section"><a href="#LE90170-PARENT">2.4.2. Missing and Incomplete Values for Performance Metrics </a></span></dt><dt><span class="section"><a href="#LE76751-PARENT">2.4.3. Kernel Metrics and the PMCD</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#LE94335-PARENT">3. Common Conventions and Arguments</a></span></dt><dd><dl><dt><span class="section"><a href="#LE85600-PARENT">3.1. Alternate Metrics Source Options</a></span></dt><dd><dl><dt><span class="section"><a href="#id5193612">3.1.1. Fetching Metrics from Another Host</a></span></dt><dt><span class="section"><a href="#id5193712">3.1.2. Fetching Metrics from an Archive Log</a></span></dt></dl></dd><dt><span class="section"><a href="#LE68596-PARENT">3.2. General PCP Tool Options</a></span></dt><dd><dl><dt><span class="section"><a href="#id5194103">3.2.1. Common Directories and File Locations</a></span></dt><dt><span class="section"><a href="#id5194616">3.2.2. Alternate Performance Metric Name Spaces</a></span></dt></dl></dd><dt><span class="section"><a href="#LE76997-PARENT">3.3. Time Duration and Control</a></span></dt><dd><dl><dt><span class="section"><a href="#LE96583-PARENT">3.3.1. Performance Monitor Reporting Frequency and Duration</a></span></dt><dt><span class="section"><a href="#LE14729-PARENT">3.3.2. Time Window Options</a></span></dt><dt><span class="section"><a href="#id5195323">3.3.3. Timezone Options</a></span></dt></dl></dd><dt><span class="section"><a href="#LE61303-PARENT">3.4. PCP Environment Variables</a></span></dt><dt><span class="section"><a href="#LE12082-PARENT">3.5. Running PCP Tools through a Firewall</a></span></dt><dd><dl><dt><span class="section"><a href="#id5196469">3.5.1. The <code class="command">pmproxy</code> service</a></span></dt></dl></dd><dt><span class="section"><a href="#LE17322-PARENT">3.6. Transient Problems with Performance Metric Values </a></span></dt><dd><dl><dt><span class="section"><a href="#id5196702">3.6.1. Performance Metric Wraparound</a></span></dt><dt><span class="section"><a href="#id5196749">3.6.2. Time Dilation and Time Skew</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#LE38515-PARENT">4. Monitoring System Performance</a></span></dt><dd><dl><dt><span class="section"><a href="#LE91266-PARENT">4.1. The <code class="command">pmstat</code> Command</a></span></dt><dt><span class="section"><a href="#Z926977852sdc">4.2. The <code class="command">pmdumptext</code> Command</a></span></dt><dt><span class="section"><a href="#LE35315-PARENT">4.3. The <code class="command">pmval</code> Command</a></span></dt><dt><span class="section"><a href="#LE60452-PARENT">4.4. The <code class="command">pminfo</code> Command</a></span></dt><dt><span class="section"><a href="#LE10170-PARENT">4.5. The <code class="command">pmstore</code> Command</a></span></dt></dl></dd><dt><span class="chapter"><a href="#LE21414-PARENT">5. Performance Metrics Inference Engine</a></span></dt><dd><dl><dt><span class="section"><a href="#LE41170-PARENT">5.1. Introduction to <code class="command">pmie</code></a></span></dt><dt><span class="section"><a href="#LE15993-PARENT">5.2. Basic <code class="command">pmie</code> Usage</a></span></dt><dd><dl><dt><span class="section"><a href="#LE23271-PARENT">5.2.1. <code class="command">pmie</code> use of PCP services</a></span></dt><dt><span class="section"><a href="#id5199666">5.2.2. Simple <code class="command">pmie</code> Usage</a></span></dt><dt><span class="section"><a href="#id5199841">5.2.3. Complex <code class="command">pmie</code> Examples</a></span></dt></dl></dd><dt><span class="section"><a href="#LE90227-PARENT">5.3. Specification Language for <code class="command">pmie</code></a></span></dt><dd><dl><dt><span class="section"><a href="#LE51927-PARENT">5.3.1. Basic <code class="command">pmie</code> Syntax</a></span></dt><dt><span class="section"><a href="#LE88708-PARENT">5.3.2. Setting Evaluation Frequency</a></span></dt><dt><span class="section"><a href="#LE73508-PARENT">5.3.3. <code class="command">pmie</code> Metric Expressions</a></span></dt><dt><span class="section"><a href="#LE59099-PARENT">5.3.4. <code class="command">pmie</code> Rate Conversion</a></span></dt><dt><span class="section"><a href="#id5201567">5.3.5. <code class="command">pmie</code> Arithmetic Expressions</a></span></dt><dt><span class="section"><a href="#id5201630">5.3.6. <code class="command">pmie</code> Logical Expressions</a></span></dt><dt><span class="section"><a href="#id5202519">5.3.7. <code class="command">pmie</code> Rule Expressions</a></span></dt><dt><span class="section"><a href="#LE87294-PARENT">5.3.8. <code class="command">pmie</code> Intrinsic Operators</a></span></dt></dl></dd><dt><span class="section"><a href="#LE60280-PARENT">5.4. <code class="command">pmie</code> Examples</a></span></dt><dt><span class="section"><a href="#LE31514-PARENT">5.5. Developing and Debugging <code class="command">pmie</code> Rules</a></span></dt><dt><span class="section"><a href="#LE91221-PARENT">5.6. Caveats and Notes on <code class="command">pmie</code></a></span></dt><dd><dl><dt><span class="section"><a href="#id5204255">5.6.1. Performance Metrics Wraparound</a></span></dt><dt><span class="section"><a href="#id5204304">5.6.2. <code class="command">pmie</code> Sample Intervals</a></span></dt><dt><span class="section"><a href="#id5204396">5.6.3. <code class="command">pmie</code> Instance Names</a></span></dt><dt><span class="section"><a href="#id5204468">5.6.4. <code class="command">pmie</code> Error Detection</a></span></dt></dl></dd><dt><span class="section"><a href="#Z927039566sdc">5.7. Creating <code class="command">pmie</code> Rules with <code class="command">pmieconf</code></a></span></dt><dt><span class="section"><a href="#Z927039824sdc">5.8. Management of <code class="command">pmie</code> Processes</a></span></dt><dd><dl><dt><span class="section"><a href="#id5208584">5.8.1. Add a <code class="command">pmie</code> <code class="command">crontab</code> Entry</a></span></dt><dt><span class="section"><a href="#id5205585">5.8.2. Global Files and Directories</a></span></dt><dt><span class="section"><a href="#id5205812">5.8.3. <code class="command">pmie</code> Instances and Their Progress</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#LE93354-PARENT">6. Archive Logging</a></span></dt><dd><dl><dt><span class="section"><a href="#LE43411-PARENT">6.1. Introduction to Archive Logging</a></span></dt><dd><dl><dt><span class="section"><a href="#id5206288">6.1.1. Archive Logs and the PMAPI</a></span></dt><dt><span class="section"><a href="#id5206362">6.1.2. Retrospective Analysis Using Archive Logs</a></span></dt><dt><span class="section"><a href="#id5206454">6.1.3. Using Archive Logs for Capacity Planning</a></span></dt></dl></dd><dt><span class="section"><a href="#LE46764-PARENT">6.2. Using Archive Logs with Performance Tools</a></span></dt><dd><dl><dt><span class="section"><a href="#id5206523">6.2.1. Coordination between <code class="command">pmlogger</code> and PCP tools</a></span></dt><dt><span class="section"><a href="#id5206675">6.2.2. Administering PCP Archive Logs Using <code class="command">cron</code> Scripts </a></span></dt><dt><span class="section"><a href="#LE92914-PARENT">6.2.3. Archive Log File Management</a></span></dt></dl></dd><dt><span class="section"><a href="#LE57424-PARENT">6.3. Cookbook for Archive Logging</a></span></dt><dd><dl><dt><span class="section"><a href="#id5207850">6.3.1. Primary Logger</a></span></dt><dt><span class="section"><a href="#id5208266">6.3.2. Other Logger Configurations</a></span></dt><dt><span class="section"><a href="#id5208588">6.3.3. Archive Log Administration</a></span></dt></dl></dd><dt><span class="section"><a href="#Z930642977sdc">6.4. Other Archive Logging Features and Services</a></span></dt><dd><dl><dt><span class="section"><a href="#LE73509-PARENT">6.4.1. PCP Archive Folios</a></span></dt><dt><span class="section"><a href="#id5208950">6.4.2. Manipulating Archive Logs with <code class="command">pmlogextract</code></a></span></dt><dt><span class="section"><a href="#id5208951">6.4.3. Summarizing Archive Logs with <code class="command">pmlogsummary</code></a></span></dt><dt><span class="section"><a href="#id5209027">6.4.4. Primary Logger</a></span></dt><dt><span class="section"><a href="#id5209191">6.4.5. Using <code class="command">pmlc</code></a></span></dt></dl></dd><dt><span class="section"><a href="#LE80113-PARENT">6.5. Archive Logging Troubleshooting</a></span></dt><dd><dl><dt><span class="section"><a href="#id5209540">6.5.1. <code class="command">pmlogger</code> Cannot Write Log</a></span></dt><dt><span class="section"><a href="#id5209654">6.5.2. Cannot Find Log</a></span></dt><dt><span class="section"><a href="#id5209840">6.5.3. Primary <code class="command">pmlogger</code> Cannot Start</a></span></dt><dt><span class="section"><a href="#id5210097">6.5.4. Identifying an Active <code class="command">pmlogger</code> Process</a></span></dt><dt><span class="section"><a href="#id5210268">6.5.5. Illegal Label Record</a></span></dt><dt><span class="section"><a href="#id5210389">6.5.6. Empty Archive Log Files or <code class="command">pmlogger</code> Exits Immediately </a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#LE83321-PARENT">7. Performance Co-Pilot Deployment Strategies</a></span></dt><dd><dl><dt><span class="section"><a href="#LE85282-PARENT">7.1. Basic Deployment</a></span></dt><dt><span class="section"><a href="#LE69500-PARENT">7.2. PCP Collector Deployment</a></span></dt><dd><dl><dt><span class="section"><a href="#id5210938">7.2.1. Principal Server Deployment</a></span></dt><dt><span class="section"><a href="#id5211030">7.2.2. Quality of Service Measurement</a></span></dt></dl></dd><dt><span class="section"><a href="#LE56598-PARENT">7.3. PCP Archive Logger Deployment</a></span></dt><dd><dl><dt><span class="section"><a href="#id5211332">7.3.1. Deployment Options</a></span></dt><dt><span class="section"><a href="#id5211434">7.3.2. Resource Demands for the Deployment Options</a></span></dt><dt><span class="section"><a href="#id5211489">7.3.3. Operational Management</a></span></dt><dt><span class="section"><a href="#id5211573">7.3.4. Exporting PCP Archive Logs</a></span></dt></dl></dd><dt><span class="section"><a href="#LE62310-PARENT">7.4. PCP Inference Engine Deployment</a></span></dt><dd><dl><dt><span class="section"><a href="#id5211669">7.4.1. Deployment Options</a></span></dt><dt><span class="section"><a href="#id5211825">7.4.2. Resource Demands for the Deployment Options</a></span></dt><dt><span class="section"><a href="#id5211850">7.4.3. Operational Management</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#LE62564-PARENT">8. Customizing and Extending PCP Services</a></span></dt><dd><dl><dt><span class="section"><a href="#LE61335-PARENT">8.1. PMDA Customization</a></span></dt><dd><dl><dt><span class="section"><a href="#LE43074-PARENT">8.1.1. Customizing the Summary PMDA</a></span></dt></dl></dd><dt><span class="section"><a href="#LE80685-PARENT">8.2. PCP Tool Customization</a></span></dt><dd><dl><dt><span class="section"><a href="#id5212794">8.2.1. Archive Logging Customization</a></span></dt><dt><span class="section"><a href="#id5213167">8.2.2. Inference Engine Customization</a></span></dt></dl></dd><dt><span class="section"><a href="#LE50224-PARENT">8.3. PMNS Management</a></span></dt><dd><dl><dt><span class="section"><a href="#id5213650">8.3.1. PMNS Processing Framework</a></span></dt><dt><span class="section"><a href="#id5213751">8.3.2. PMNS Syntax</a></span></dt></dl></dd><dt><span class="section"><a href="#LE10270-PARENT">8.4. PMDA Development</a></span></dt><dt><span class="section"><a href="#LE31248-PARENT">8.5. PCP Tool Development</a></span></dt></dl></dd><dt><span class="appendix"><a href="#LE65325-PARENT">A. Acronyms</a></span></dt><dt><span class="index"><a href="#sgi-index">Index</a></span></dt></dl></div><div class="list-of-figures"><p><strong>List of Figures</strong></p><dl><dt>1.1. <a href="#id5188602">Performance Metric Domains as Autonomous Collections of Data</a></dt><dt>1.2. <a href="#id5188883">Process Structure for Distributed Operation</a></dt><dt>1.3. <a href="#id5189137">Small Performance Metrics Name Space (PMNS) </a></dt><dt>1.4. <a href="#id5189940">Architecture for Retrospective Analysis</a></dt><dt>5.1. <a href="#id5201070">Sampling Time Line</a></dt><dt>5.2. <a href="#id5201194">Three-Dimensional Parameter Space</a></dt><dt>6.1. <a href="#id5207462">Archive Log Directory Structure</a></dt><dt>7.1. <a href="#id5210776">PCP Deployment for a Single System</a></dt><dt>7.2. <a href="#id5210808">Basic PCP Deployment for Two Systems</a></dt><dt>7.3. <a href="#id5210866">General PCP Deployment for Multiple Systems </a></dt><dt>7.4. <a href="#id5211102">PCP Deployment to Measure Client-Server Quality of Service</a></dt><dt>7.5. <a href="#id5211413">Designated PCP Archive Site</a></dt><dt>7.6. <a href="#id5211805">PCP Management Site Deployment</a></dt><dt>8.1. <a href="#id5213846">Small Performance Metrics Name Space (PMNS)</a></dt></dl></div><div class="list-of-tables"><p><strong>List of Tables</strong></p><dl><dt>1.1. <a href="#id5189432">Sample Instance Identifiers for Disk Statistics </a></dt><dt>3.1. <a href="#id5193871">Physical Filenames for Components of a PCP Archive Log</a></dt><dt>6.1. <a href="#id5206972">Filenames for PCP Archive Log Components (<code class="literal">archive</code>.<em class="replaceable">*</em>)</a></dt><dt>A.1. <a href="#id5214266">Performance Co-Pilot Acronyms and Their Meanings </a></dt></dl></div><div class="list-of-examples"><p><strong>List of Examples</strong></p><dl><dt>2.1. <a href="#Z929138022sdc">PMNS Installation Output </a></dt><dt>5.1. <a href="#Z983825969sdc"><code class="command">pmie</code> with the <code class="literal">-f</code> Option</a></dt><dt>5.2. <a href="#Z983826092sdc"><code class="command">pmie</code> with the <code class="literal">-d</code> and <code class="literal">-h</code> Options</a></dt><dt>5.3. <a href="#Z983823607sdc"><code class="command">pmie</code> with the <code class="literal">-v</code> Option</a></dt><dt>5.4. <a href="#Z983824038sdc">Printed <code class="command">pmie</code> Output</a></dt><dt>5.5. <a href="#Z983824037sdc">Labelled <code class="command">pmie</code> Output</a></dt><dt>5.6. <a href="#Z983832287sdc">Relational Expressions </a></dt><dt>5.7. <a href="#Z983833504sdc">Rule Expression Options </a></dt><dt>5.8. <a href="#Z983833442sdc">System Log Text</a></dt><dt>5.9. <a href="#Z983833364sdc">Standard Output</a></dt><dt>5.10. <a href="#Z928441343sdc">Monitoring CPU Utilization</a></dt><dt>5.11. <a href="#Z928441176sdc">Monitoring Disk Activity </a></dt><dt>6.1. <a href="#Z984165598sdc">Using <code class="literal">pminfo</code> to Obtain Archive Information</a></dt><dt>6.2. <a href="#Z984165598nat">Using <code class="literal">pmlogsummary</code> to Summarize Archive Information</a></dt><dt>6.3. <a href="#Z984165791sdc">Listing Available Commands </a></dt><dt>8.1. <a href="#Z928447759sdc">PMNS Specification</a></dt></dl></div><div class="preface"><div class="titlepage"><div><div><h1 class="title"><a id="id5178699">
      ⁠</a>About This Guide</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#id5178738">1. What This Guide Contains</a></span></dt><dt><span class="section"><a href="#id5178921">2. Audience for This Guide</a></span></dt><dt><span class="section"><a href="#id5178935">3. Related Resources</a></span></dt><dt><span class="section"><a href="#id5178967">4. Man Pages</a></span></dt><dt><span class="section"><a href="#id5178968">5. Web Site</a></span></dt><dt><span class="section"><a href="#id5179060">6. Conventions</a></span></dt><dt><span class="section"><a href="#z825546061melby">7. Reader Comments</a></span></dt></dl></div><div class="para">
			This guide describes the Performance Co-Pilot (PCP) performance analysis toolkit. PCP provides a systems-level suite of tools that cooperate to deliver distributed performance monitoring and performance management services spanning hardware platforms, operating systems, service layers, database internals, user applications and distributed architectures.
		</div><div class="para">
			PCP is a cross-platform, open source software package - customizations, extensions, source code inspection, and tinkering in general is actively encouraged.
		</div><div class="para">
			“About This Guide” includes short descriptions of the chapters in this book, directs you to additional sources of information, and explains typographical conventions.
		</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="id5178738">
      ⁠</a>1. What This Guide Contains</h2></div></div></div><div class="para">
				This guide contains the following chapters:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a class="xref" href="#LE91944-PARENT">Chapter 1, <em>Introduction to PCP</em></a>, provides an introduction, a brief overview of the software components, and conceptual foundations of the PCP software.
					</div></li><li class="listitem"><div class="para">
						<a class="xref" href="#LE17127-PARENT">Chapter 2, <em>Installing and Configuring Performance Co-Pilot</em></a>, describes the basic installation and configuration steps necessary to get PCP running on your systems.
					</div></li><li class="listitem"><div class="para">
						<a class="xref" href="#LE94335-PARENT">Chapter 3, <em>Common Conventions and Arguments</em></a>, describes the user interface components that are common to most of the text-based utilities that make up the monitor portion of PCP.
					</div></li><li class="listitem"><div class="para">
						<a class="xref" href="#LE38515-PARENT">Chapter 4, <em>Monitoring System Performance</em></a>, describes the performance monitoring tools available in Performance Co-Pilot (PCP).
					</div></li><li class="listitem"><div class="para">
						<a class="xref" href="#LE21414-PARENT">Chapter 5, <em>Performance Metrics Inference Engine</em></a>, describes the Performance Metrics Inference Engine (<code class="command">pmie</code>) tool that provides automated monitoring of, and reasoning about, system performance within the PCP framework.
					</div></li><li class="listitem"><div class="para">
						<a class="xref" href="#LE93354-PARENT">Chapter 6, <em>Archive Logging</em></a>, covers the PCP services and utilities that support archive logging for capturing accurate historical performance records.
					</div></li><li class="listitem"><div class="para">
						<a class="xref" href="#LE83321-PARENT">Chapter 7, <em>Performance Co-Pilot Deployment Strategies</em></a>, presents the various options for deploying PCP functionality across cooperating systems.
					</div></li><li class="listitem"><div class="para">
						<a class="xref" href="#LE62564-PARENT">Chapter 8, <em>Customizing and Extending PCP Services</em></a>, describes the procedures necessary to ensure that the PCP configuration is customized in ways that maximize the coverage and quality of performance monitoring and management services.
					</div></li><li class="listitem"><div class="para">
						<a class="xref" href="#LE65325-PARENT">Appendix A, <em>Acronyms</em></a>, provides a comprehensive list of the acronyms used in this guide and in the man pages for Performance Co-Pilot.
					</div></li></ul></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="id5178921">
      ⁠</a>2. Audience for This Guide</h2></div></div></div><div class="para">
				This guide is written for the system administrator or performance analyst who is directly using and administering PCP applications.
			</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="id5178935">
      ⁠</a>3. Related Resources</h2></div></div></div><div class="para">
				The <em class="citetitle">Performance Co-Pilot Programmer's Guide</em>, a companion document to the <em class="citetitle">Performance Co-Pilot User's and Administrator's Guide</em>, is intended for developers who want to use the PCP framework and services for exporting additional collections of performance metrics, or for delivering new or customized applications to enhance performance management.
			</div><div class="para">
				The <em class="citetitle">Performance Co-Pilot Tutorials and Case Studies</em> provides a series of real-world examples of using various PCP tools, and lessons learned from deploying the toolkit in production environments. It serves to provide reinforcement of the general concepts discussed in the other two books with additional case studies, and in some cases very detailed discussion of specifics of individual tools.
			</div><div class="para">
				Additional resources include man pages and the project web site.
			</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="id5178967">
      ⁠</a>4. Man Pages</h2></div></div></div><div class="para">
				The operating system man pages provide concise reference information on the use of commands, subroutines, and system resources. There is usually a man page for each PCP command or subroutine. To see a list of all the PCP man pages, start from the following command:
			</div><pre class="literallayout"><strong class="userinput"><code>man PCPIntro</code></strong></pre><div class="para">
				Each man page usually has a "SEE ALSO" section, linking to other, related entries.
			</div><div class="para">
				To see a particular man page, supply its name to the <code class="literal">man</code> command, for example:
			</div><pre class="literallayout"><strong class="userinput"><code>man pcp</code></strong></pre><div class="para">
				The man pages are arranged in different sections - user commands, programming interfaces, and so on. For a complete list of manual sections on a platform enter the command:
			</div><pre class="literallayout"><strong class="userinput"><code>man man</code></strong></pre><div class="para">
				When referring to man pages, this guide follows a standard convention: the section number in parentheses follows the item. For example, <code class="command">pminfo(1)</code> refers to the man page in section 1 for the <code class="command">pminfo</code> command.
			</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="id5178968">
      ⁠</a>5. Web Site</h2></div></div></div><div class="para">
				The following web site is accessible to everyone:
			</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="bold bold"><strong>URL</strong></span></span></dt><dd><div class="para">
							<span class="bold bold"><strong>Description</strong></span>
						</div></dd><dt><span class="term"><a href="http://pcp.io">http://pcp.io</a></span></dt><dd><div class="para">
							PCP is open source software released under the GNU General Public License (GPL) and GNU Lesser General Public License (LGPL)
						</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="id5179060">
      ⁠</a>6. Conventions</h2></div></div></div><div class="para">
				The following conventions are used throughout this document:
				<div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="bold bold"><strong>Convention</strong></span></span></dt><dd><div class="para">
								<span class="bold bold"><strong>Meaning</strong></span>
							</div></dd><dt><span class="term"><code class="literal">${PCP_VARIABLE}</code></span></dt><dd><div class="para">
								A brace-enclosed all-capital-letters syntax indicates a variable that has been sourced from the global <code class="filename">${PCP_DIR}/etc/pcp.conf</code> file. These special variables indicate parameters that affect all PCP commands, and are likely to be different between platforms.
							</div></dd><dt><span class="term"><code class="literal">command</code></span></dt><dd><div class="para">
								This fixed-space font denotes literal items such as commands, files, routines, path names, signals, messages, and programming language structures.
							</div></dd><dt><span class="term"><em class="replaceable">variable</em></span></dt><dd><div class="para">
								Italic typeface denotes variable entries and words or concepts being defined.
							</div></dd><dt><span class="term"><strong class="userinput"><code>user input</code></strong></span></dt><dd><div class="para">
								This bold, fixed-space font denotes literal items that the user enters in interactive sessions. (Output is shown in nonbold, fixed-space font.)
							</div></dd><dt><span class="term">[ ]</span></dt><dd><div class="para">
								Brackets enclose optional portions of a command or directive line.
							</div></dd><dt><span class="term">...</span></dt><dd><div class="para">
								Ellipses indicate that a preceding element can be repeated.
							</div></dd><dt><span class="term">ALL CAPS</span></dt><dd><div class="para">
								All capital letters denote environment variables, operator names, directives, defined constants, and macros in C programs.
							</div></dd><dt><span class="term">()</span></dt><dd><div class="para">
								Parentheses that follow function names surround function arguments or are empty if the function has no arguments; parentheses that follow commands surround man page section numbers.
							</div></dd></dl></div>
			</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="z825546061melby">
      ⁠</a>7. Reader Comments</h2></div></div></div><div class="para">
				If you have comments about the technical accuracy, content, or organization of this document, contact the PCP maintainers using either the email address or the web site listed earlier.
			</div><div class="para">
				We value your comments and will respond to them promptly.
			</div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="LE91944-PARENT">
      ⁠</a>Chapter 1. Introduction to PCP</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#LE92676-PARENT">1.1. Objectives</a></span></dt><dd><dl><dt><span class="section"><a href="#LE67354-PARENT">1.1.1. PCP Target Usage</a></span></dt><dt><span class="section"><a href="#LE79006-PARENT">1.1.2. Empowering the PCP User</a></span></dt><dt><span class="section"><a href="#LE35382-PARENT">1.1.3. Unification of Performance Metric Domains</a></span></dt><dt><span class="section"><a href="#LE83994-PARENT">1.1.4. Uniform Naming and Access to Performance Metrics </a></span></dt><dt><span class="section"><a href="#LE85063-PARENT">1.1.5. PCP Distributed Operation</a></span></dt><dt><span class="section"><a href="#LE87326-PARENT">1.1.6. Dynamic Adaptation to Change</a></span></dt><dt><span class="section"><a href="#LE13859-PARENT">1.1.7. Logging and Retrospective Analysis</a></span></dt><dt><span class="section"><a href="#LE36677-PARENT">1.1.8. Automated Operational Support</a></span></dt><dt><span class="section"><a href="#LE38522-PARENT">1.1.9. PCP Extensibility</a></span></dt><dt><span class="section"><a href="#LE40772-PARENT">1.1.10. Metric Coverage</a></span></dt></dl></dd><dt><span class="section"><a href="#LE79836-PARENT">1.2. Conceptual Foundations</a></span></dt><dd><dl><dt><span class="section"><a href="#id5188366">1.2.1. Performance Metrics</a></span></dt><dt><span class="section"><a href="#id5188440">1.2.2. Performance Metric Instances</a></span></dt><dt><span class="section"><a href="#id5188469">1.2.3. Current Metric Context</a></span></dt><dt><span class="section"><a href="#id5188562">1.2.4. Sources of Performance Metrics and Their Domains</a></span></dt><dt><span class="section"><a href="#id5188837">1.2.5. Distributed Collection</a></span></dt><dt><span class="section"><a href="#LE94677-PARENT">1.2.6. Performance Metrics Name Space</a></span></dt><dt><span class="section"><a href="#id5189172">1.2.7. Descriptions for Performance Metrics</a></span></dt><dt><span class="section"><a href="#id5189302">1.2.8. Values for Performance Metrics</a></span></dt><dt><span class="section"><a href="#id5189653">1.2.9. Collector and Monitor Roles</a></span></dt><dt><span class="section"><a href="#id5189901">1.2.10. Retrospective Sources of Performance Metrics</a></span></dt><dt><span class="section"><a href="#id5189964">1.2.11. Product Extensibility</a></span></dt></dl></dd><dt><span class="section"><a href="#LE13618-PARENT">1.3. Overview of Component Software</a></span></dt><dd><dl><dt><span class="section"><a href="#id5177430">1.3.1. Performance Monitoring and Visualization</a></span></dt><dt><span class="section"><a href="#id5177776">1.3.2. Collecting, Transporting, and Archiving Performance Information </a></span></dt><dt><span class="section"><a href="#id5187554">1.3.3. Operational and Infrastructure Support</a></span></dt><dt><span class="section"><a href="#id5188066">1.3.4. Application and Agent Development</a></span></dt></dl></dd></dl></div><div class="para">
			<a id="ITch01-0" class="indexterm"></a><a id="IG313718880" class="indexterm"></a><a id="IG313718881" class="indexterm"></a>This chapter provides an introduction to Performance Co-Pilot (PCP), an overview of its individual components, and conceptual information to help you use this software.
		</div><div class="para">
			The following sections are included:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					<a class="xref" href="#LE92676-PARENT">Section 1.1, “Objectives”</a> covers the intended purposes of PCP.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE13618-PARENT">Section 1.3, “Overview of Component Software”</a>, describes PCP tools and agents.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE79836-PARENT">Section 1.2, “Conceptual Foundations”</a>, discusses the design theories behind PCP.
				</div></li></ul></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE92676-PARENT">
      ⁠</a>1.1. Objectives</h2></div></div></div><div class="para">
				<a id="IG313718882" class="indexterm"></a>
			</div><div class="para">
				Performance Co-Pilot (PCP) provides a range of services that may be used to monitor and manage system performance. These services are distributed and scalable to accommodate the most complex system configurations and performance problems.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE67354-PARENT">
      ⁠</a>1.1.1. PCP Target Usage</h3></div></div></div><div class="para">
					<a id="IG313718883" class="indexterm"></a>PCP is targeted at the performance analyst, benchmarker, capacity planner, developer, database administrator, or system administrator with an interest in overall system performance and a need to quickly isolate and understand performance behavior, resource utilization, activity levels, and bottlenecks in complex systems. Platforms that can benefit from this level of performance analysis include large servers, server clusters, or multiserver sites delivering Database Management Systems (DBMS), compute, Web, file, or video services.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE79006-PARENT">
      ⁠</a>1.1.2. Empowering the PCP User</h3></div></div></div><div class="para">
					<a id="IG313718884" class="indexterm"></a>To deal efficiently with the dynamic behavior of complex systems, performance analysts need to filter out noise from the overwhelming stream of performance data, and focus on exceptional scenarios. Visualization of current and historical performance data, and automated reasoning about performance data, effectively provide this filtering.
				</div><div class="para">
					From the PCP end user's perspective, PCP presents an integrated suite of tools, user interfaces, and services that support real-time and retrospective performance analysis, with a bias towards eliminating mundane information and focusing attention on the exceptional and extraordinary performance behaviors. When this is done, the user can concentrate on in-depth analysis or target management procedures for those critical system performance problems.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE35382-PARENT">
      ⁠</a>1.1.3. Unification of Performance Metric Domains</h3></div></div></div><div class="para">
					<a id="IG313718885" class="indexterm"></a><a id="IG313718886" class="indexterm"></a>At the lowest level, performance metrics are collected and managed in autonomous performance domains such as the operating system kernel, a DBMS, a layered service, or an end-user application. These domains feature a multitude of access control policies, access methods, data semantics, and multiversion support. All this detail is irrelevant to the developer or user of a performance monitoring tool, and is hidden by the PCP infrastructure.
				</div><div class="para">
					<a id="IG313718887" class="indexterm"></a><a id="IG313718888" class="indexterm"></a>Performance Metrics Domain Agents (PMDAs) within PCP encapsulate the knowledge about, and export performance information from, autonomous performance domains.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE83994-PARENT">
      ⁠</a>1.1.4. Uniform Naming and Access to Performance Metrics </h3></div></div></div><div class="para">
					<a id="IG313718889" class="indexterm"></a><a id="IG3137188810" class="indexterm"></a><a id="IG3137188811" class="indexterm"></a><a id="IG3137188812" class="indexterm"></a>Usability and extensibility of performance management tools mandate a single scheme for naming performance metrics. The set of defined names constitutes a Performance Metrics Name Space (PMNS). Within PCP, the PMNS is adaptive so it can be extended, reshaped, and pruned to meet the needs of particular applications and users.
				</div><div class="para">
					PCP provides a single interface to name and retrieve values for all performance metrics, independently of their source or location.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE85063-PARENT">
      ⁠</a>1.1.5. PCP Distributed Operation</h3></div></div></div><div class="para">
					<a id="ITch01-2" class="indexterm"></a>From a purely pragmatic viewpoint, a single workstation must be able to monitor the concurrent performance of multiple remote hosts. At the same time, a single host may be subject to monitoring from multiple remote workstations.
				</div><div class="para">
					<a id="IG3137188813" class="indexterm"></a>These requirements suggest a classic client-server architecture, which is exactly what PCP uses to provide concurrent and multiconnected access to performance metrics, independent of their host location.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE87326-PARENT">
      ⁠</a>1.1.6. Dynamic Adaptation to Change</h3></div></div></div><div class="para">
					<a id="IG3137188814" class="indexterm"></a><a id="IG3137188815" class="indexterm"></a>Complex systems are subject to continual changes as network connections fail and are reestablished; nodes are taken out of service and rebooted; hardware is added and removed; and software is upgraded, installed, or removed. Often these changes are asynchronous and remote (perhaps in another geographic region or domain of administrative control).
				</div><div class="para">
					The distributed nature of the PCP (and the modular fashion in which performance metrics domains can be installed, upgraded, and configured on different hosts) enables PCP to adapt concurrently to changes in the monitored system(s). Variations in the available performance metrics as a consequence of configuration changes are handled automatically and become visible to all clients as soon as the reconfigured host is rebooted or the responsible agent is restarted.
				</div><div class="para">
					PCP also detects loss of client-server connections, and most clients support subsequent automated reconnection.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE13859-PARENT">
      ⁠</a>1.1.7. Logging and Retrospective Analysis</h3></div></div></div><div class="para">
					<a id="IG3137188816" class="indexterm"></a><a id="ITch01-3" class="indexterm"></a>A range of tools is provided to support flexible, adaptive logging of performance metrics for archive, playback, remote diagnosis, and capacity planning. PCP archive logs may be accumulated either at the host being monitored, at a monitoring workstation, or both.
				</div><div class="para">
					A universal replay mechanism, modeled on <a href="http://en.wikipedia.org/wiki/Media_controls">media controls</a>, supports play, step, rewind, fast forward and variable speed processing of archived performance data. Replay for multiple archives, from multiple hosts, is facilitated by an archive aggregation concept.
				</div><div class="para">
					Most PCP applications are able to process archive logs and real-time performance data with equal facility. Unification of real-time access and access to the archive logs, in conjunction with the media controls, provides powerful mechanisms for building performance tools and to review both current and historical performance data.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE36677-PARENT">
      ⁠</a>1.1.8. Automated Operational Support</h3></div></div></div><div class="para">
					<a id="IG3137188817" class="indexterm"></a>For operational and production environments, PCP provides a framework with scripts to customize in order to automate the execution of ongoing tasks such as these:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							<a id="IG3137188818" class="indexterm"></a>Centralized archive logging for multiple remote hosts
						</div></li><li class="listitem"><div class="para">
							<a id="IG3137188819" class="indexterm"></a>Archive log rotation, consolidation, and culling
						</div></li><li class="listitem"><div class="para">
							Web-based publishing of charts showing snapshots of performance activity levels in the recent past
						</div></li><li class="listitem"><div class="para">
							Flexible alarm monitoring: parameterized rules to address common critical performance scenarios and facilities to customize and refine this monitoring
						</div></li><li class="listitem"><div class="para">
							<a id="IG3137188820" class="indexterm"></a>Retrospective performance audits covering the recent past; for example, daily or weekly checks for performance regressions or quality of service problems
						</div></li></ul></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE38522-PARENT">
      ⁠</a>1.1.9. PCP Extensibility</h3></div></div></div><div class="para">
					<a id="IG3137188821" class="indexterm"></a><a id="IG3137188822" class="indexterm"></a>PCP permits the integration of new performance metrics into the PMNS, the collection infrastructure, and the logging framework. The guiding principle is, “if it is important for monitoring system performance, and you can measure it, you can easily integrate it into the PCP framework.”
				</div><div class="para">
					For many PCP users, the most important performance metrics are not those already supported, but new performance metrics that characterize the essence of good or bad performance at their site, or within their particular application environment.
				</div><div class="para">
					One example is an application that measures the round-trip time for a benign “probe” transaction against some mission-critical application.
				</div><div class="para">
					<a id="IG3137188823" class="indexterm"></a>For application developers, a library is provided to support easy-to-use insertion of trace and monitoring points within an application, and the automatic export of resultant performance data into the PCP framework. Other libraries and tools aid the development of customized and fully featured Performance Metrics Domain Agents (PMDAs).
				</div><div class="para">
					Extensive source code examples are provided in the distribution, and by using the PCP toolkit and interfaces, these customized measures of performance or quality of service can be easily and seamlessly integrated into the PCP framework.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE40772-PARENT">
      ⁠</a>1.1.10. Metric Coverage</h3></div></div></div><div class="para">
					<a id="IG3137188824" class="indexterm"></a>The core PCP modules support export of performance metrics that include kernel instrumentation, hardware instrumentation, process-level resource utilization, database and other system services instrumentation, and activity in the PCP collection infrastructure.
				</div><div class="para">
					The supplied agents support thousands of distinct performance metrics, many of which can have multiple values, for example, per disk, per CPU, or per process.
				</div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE79836-PARENT">
      ⁠</a>1.2. Conceptual Foundations</h2></div></div></div><div class="para">
				<a id="ITch01-129" class="indexterm"></a>The following sections provide a detailed overview of concepts that underpin Performance Co-Pilot (PCP).
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5188366">
      ⁠</a>1.2.1. Performance Metrics</h3></div></div></div><div class="para">
					<a id="ITch01-130" class="indexterm"></a><a id="IG3137188863" class="indexterm"></a> Across all of the supported performance metric domains, there are a large number of performance metrics. Each metric has its own structure and semantics. PCP presents a uniform interface to these metrics, independent of the underlying metric data source.
				</div><div class="para">
					<a id="IG3137188864" class="indexterm"></a>The Performance Metrics Name Space (PMNS) provides a hierarchical classification of human-readable metric names, and a mapping from these external names to internal metric identifiers. See <a class="xref" href="#LE94677-PARENT">Section 1.2.6, “Performance Metrics Name Space”</a>, for a description of the PMNS.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5188440">
      ⁠</a>1.2.2. Performance Metric Instances</h3></div></div></div><div class="para">
					When performance metric values are returned to a requesting application, there may be more than one value instance for a particular metric; for example, independent counts for each CPU, process, disk, or local filesystem. Internal instance identifiers correspond one to one with external (human-readable) descriptions of the members of an instance domain.
				</div><div class="para">
					Transient performance metrics (such as per-process information) cause repeated requests for the same metric to return different numbers of values, or changes in the particular instance identifiers returned. These changes are expected and fully supported by the PCP infrastructure; however, metric instantiation is guaranteed to be valid only at the time of collection.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5188469">
      ⁠</a>1.2.3. Current Metric Context</h3></div></div></div><div class="para">
					When performance metrics are retrieved, they are delivered in the context of a particular source of metrics, a point in time, and a profile of desired instances. This means that the application making the request has already negotiated to establish the context in which the request should be executed.
				</div><div class="para">
					<a id="IG3137188865" class="indexterm"></a>A metric source may be the current performance data from a particular host (a live or real-time source), or a set of archive logs of performance data collected by <code class="command">pmlogger</code> at some distant host or at an earlier time (a retrospective or archive source).
				</div><div class="para">
					<a id="ITch01-134" class="indexterm"></a>By default, the collection time for a performance metric is the current time of day for real-time sources, or current point within an archive source. For archives, the collection time may be reset to an arbitrary time within the bounds of the set of archive logs.<a id="ITch01-135" class="indexterm"></a>
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5188562">
      ⁠</a>1.2.4. Sources of Performance Metrics and Their Domains</h3></div></div></div><div class="para">
					<a id="ITch01-137" class="indexterm"></a><a id="ITch01-138" class="indexterm"></a> Instrumentation for the purpose of performance monitoring typically consists of counts of activity or events, attribution of resource consumption, and service-time or response-time measures. This instrumentation may exist in one or more of the functional domains as shown in <a class="xref" href="#id5188602">Figure 1.1, “Performance Metric Domains as Autonomous Collections of Data”</a>.
				</div><div class="figure"><a id="id5188602">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/metric-domains.svg" type="image/svg+xml"><img src="images/metric-domains.png" alt="Performance Metric Domains as Autonomous Collections of Data" /></object></div></div><p class="title"><strong>Figure 1.1. Performance Metric Domains as Autonomous Collections of Data</strong></p></div><div class="para">
					Each domain has an associated access method:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							<a id="IG3137188866" class="indexterm"></a>The operating system kernel, including sub-system data structures - per-process resource consumption, network statistics, disk activity, or memory management instrumentation.
						</div></li><li class="listitem"><div class="para">
							<a id="IG3137188867" class="indexterm"></a><a id="IG3137188868" class="indexterm"></a>A layered software service such as activity logs for a World Wide Web server or an email delivery server.<a id="IG3137188869" class="indexterm"></a>
						</div></li><li class="listitem"><div class="para">
							An application program such as measured response time for a production application running a periodic and benign probe transaction (as often required in service level agreements), or rate of computation and throughput in jobs per minute for a batch stream.
						</div></li><li class="listitem"><div class="para">
							<a id="IG3137188870" class="indexterm"></a><a id="IG3137188871" class="indexterm"></a>External equipment such as network routers and bridges.
						</div></li></ul></div><div class="para">
					<a id="ITch01-139" class="indexterm"></a>For each domain, the set of performance metrics may be viewed as an abstract data type, with an associated set of methods that may be used to perform the following tasks:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							Interrogate the metadata that describes the syntax and semantics of the performance metrics
						</div></li><li class="listitem"><div class="para">
							Control (enable or disable) the collection of some or all of the metrics
						</div></li><li class="listitem"><div class="para">
							Extract instantiations (current values) for some or all of the metrics
						</div></li></ul></div><div class="para">
					We refer to each functional domain as a performance metrics domain and assume that domains are functionally, architecturally, and administratively independent and autonomous. Obviously the set of performance metrics domains available on any host is variable, and changes with time as software and hardware are installed and removed.
				</div><div class="para">
					The number of performance metrics domains may be further enlarged in cluster-based or network-based configurations, where there is potentially an instance of each performance metrics domain on each node. Hence, the management of performance metrics domains must be both extensible at a particular host and distributed across a number of hosts.
				</div><div class="para">
					<a id="IG3137188872" class="indexterm"></a><a id="IG3137188873" class="indexterm"></a>Each performance metrics domain on a particular host must be assigned a unique Performance Metric Identifier (PMID). In practice, this means unique identifiers are assigned globally for each performance metrics domain type. For example, the same identifier would be used for the Apache Web Server performance metrics domain on all hosts.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5188837">
      ⁠</a>1.2.5. Distributed Collection</h3></div></div></div><div class="para">
					<a id="ITch01-142" class="indexterm"></a><a id="ITch01-143" class="indexterm"></a><a id="IG3137188874" class="indexterm"></a>The performance metrics collection architecture is distributed, in the sense that any performance tool may be executing remotely. However, a PMDA usually runs on the system for which it is collecting performance measurements. In most cases, connecting these tools together on the collector host is the responsibility of the PMCD process, as shown in <a class="xref" href="#id5188883">Figure 1.2, “Process Structure for Distributed Operation”</a>.
				</div><div class="figure"><a id="id5188883">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/remote-collector.svg" type="image/svg+xml"><img src="images/remote-collector.png" alt="Process Structure for Distributed Operation" /></object></div></div><p class="title"><strong>Figure 1.2. Process Structure for Distributed Operation</strong></p></div><div class="para">
					The host running the monitoring tools does not require any collection tools, including <code class="command">pmcd</code>, because all requests for metrics are sent to the <code class="command">pmcd</code> process on the collector host. These requests are then forwarded to the appropriate PMDAs, which respond with metric descriptions, help text, and most importantly, metric values.
				</div><div class="para">
					<a id="IG3137188875" class="indexterm"></a>The connections between monitor clients and <code class="literal">pmcd</code> processes are managed in <code class="filename">libpcp</code>, below the PMAPI level; see the <code class="command">pmapi(3)</code> man page. Connections between PMDAs and <code class="command">pmcd</code> are managed by the PMDA routines; see the <code class="command">pmda(3)</code> man page. There can be multiple monitor clients and multiple PMDAs on the one host, but normally there would be only one <code class="literal">pmcd</code> process.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE94677-PARENT">
      ⁠</a>1.2.6. Performance Metrics Name Space</h3></div></div></div><div class="para">
					<a id="ITch01-144" class="indexterm"></a> <a id="ITch01-146" class="indexterm"></a>Internally, each unique performance metric is identified by a Performance Metric Identifier (PMID) drawn from a universal set of identifiers, including some that are reserved for site-specific, application-specific, and customer-specific use.
				</div><div class="para">
					<a id="ITch01-148" class="indexterm"></a>An external name space - the Performance Metrics Name Space (PMNS) - maps from a hierarchy (or tree) of human-readable names to PMIDs.
				</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5189100">
      ⁠</a>1.2.6.1. Performance Metrics Name Space Diagram</h4></div></div></div><div class="para">
						Each node in the PMNS tree is assigned a label that must begin with an alphabet character, and be followed by zero or more alphanumeric characters or the underscore (_) character. The root node of the tree has the special label of <code class="literal">root</code>.
					</div><div class="para">
						A metric name is formed by traversing the tree from the root to a leaf node with each node label on the path separated by a period. The common prefix <code class="literal">root</code><span class="bold bold"><strong>.</strong></span> is omitted from all names. For example, <a class="xref" href="#id5189137">Figure 1.3, “Small Performance Metrics Name Space (PMNS) ”</a> shows the nodes in a small subsection of a PMNS.
					</div><div class="figure"><a id="id5189137">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/pmns-small.svg" type="image/svg+xml"><img src="images/pmns-small.png" alt="Small Performance Metrics Name Space (PMNS) " /></object></div></div><p class="title"><strong>Figure 1.3. Small Performance Metrics Name Space (PMNS) </strong></p></div><div class="para">
						In this subsection, the following are valid names for performance metrics:
					</div><pre class="literallayout">kernel.percpu.syscall
network.tcp.rcvpack
hw.router.recv.total_util
</pre></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5189172">
      ⁠</a>1.2.7. Descriptions for Performance Metrics</h3></div></div></div><div class="para">
					<a id="ITch01-149" class="indexterm"></a><a id="ITch01-150" class="indexterm"></a> Through the various performance metric domains, the PCP must support a wide range of formats and semantics for performance metrics. This <em class="firstterm">metadata</em> describing the performance metrics includes the following:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							The internal identifier, Performance Metric Identifier (PMID), for the metric
						</div></li><li class="listitem"><div class="para">
							<a id="IG3137188876" class="indexterm"></a>The format and encoding for the values of the metric, for example, an unsigned 32-bit integer or a string or a 64-bit IEEE format floating point number
						</div></li><li class="listitem"><div class="para">
							The semantics of the metric, particularly the interpretation of the values as free-running counters or instantaneous values
						</div></li><li class="listitem"><div class="para">
							The dimensionality of the values, in the dimensions of events, space, and time
						</div></li><li class="listitem"><div class="para">
							The scale of values; for example, bytes, kilobytes (KB), or megabytes (MB) for the space dimension
						</div></li><li class="listitem"><div class="para">
							An indication if the metric may have one or many associated values
						</div></li><li class="listitem"><div class="para">
							Short (and extended) help text describing the metric
						</div></li></ul></div><div class="para">
					For each metric, this metadata is defined within the associated PMDA, and PCP arranges for the information to be exported to performance tools that use the metadata when interpreting the values for each metric.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5189302">
      ⁠</a>1.2.8. Values for Performance Metrics</h3></div></div></div><div class="para">
					The following sections describe two types of performance metrics, single-valued and set-valued.
				</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5189314">
      ⁠</a>1.2.8.1. Single-Valued Performance Metrics</h4></div></div></div><div class="para">
						<a id="IG3137188877" class="indexterm"></a>Some performance metrics have a singular value within their performance metric domains. For example, available memory (or the total number of context switches) has only one value per performance metric domain, that is, one value per host. The metadata describing the metric makes this fact known to applications that process values for these metrics.
					</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5189346">
      ⁠</a>1.2.8.2. Set-Valued Performance Metrics</h4></div></div></div><div class="para">
						<a id="IG3137188878" class="indexterm"></a>Some performance metrics have a set of values or instances in each implementing performance metric domain. For example, one value for each disk, one value for each process, one value for each CPU, or one value for each activation of a given application.
					</div><div class="para">
						When a metric has multiple instances, the PCP framework does not pollute the Name Space with additional metric names; rather, a single metric may have an associated set of values. These multiple values are associated with the members of an <em class="firstterm">instance domain</em>, such that each instance has a unique instance identifier within the associated instance domain. For example, the “per CPU” instance domain may use the instance identifiers 0, 1, 2, 3, and so on to identify the configured processors in the system.
					</div><div class="para">
						Internally, instance identifiers are encoded as binary values, but each performance metric domain also supports corresponding strings as external names for the instance identifiers, and these names are used at the user interface to the PCP utilities.
					</div><div class="para">
						For example, the performance metric <code class="literal">disk.dev.total</code> counts I/O operations for each disk spindle, and the associated instance domain contains one member for each disk spindle. On a system with five specific disks, one value would be associated with each of the external and internal instance identifier pairs shown in <a class="xref" href="#id5189432">Table 1.1, “Sample Instance Identifiers for Disk Statistics ”</a>.
					</div><div class="table"><a id="id5189432">
      ⁠</a><p class="title"><strong>Table 1.1. Sample Instance Identifiers for Disk Statistics </strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols lt-7-rows" summary="Sample Instance Identifiers for Disk Statistics "><colgroup><col width="50%" /><col width="50%" /></colgroup><thead><tr valign="top"><th align="left" valign="bottom">
									<div class="para">
										External Instance Identifier
									</div>
									</th><th align="left" valign="bottom">
									<div class="para">
										Internal Instance Identifier
									</div>
									</th></tr></thead><tbody><tr valign="top"><td align="left" valign="top">
									<div class="para">
										disk0
									</div>
									</td><td align="left" valign="top">
									<div class="para">
										131329
									</div>
									</td></tr><tr class="even" valign="top"><td align="left" valign="top">
									<div class="para">
										disk1
									</div>
									</td><td align="left" valign="top">
									<div class="para">
										131330
									</div>
									</td></tr><tr valign="top"><td align="left" valign="top">
									<div class="para">
										disk2
									</div>
									</td><td align="left" valign="top">
									<div class="para">
										131331
									</div>
									</td></tr><tr class="even" valign="top"><td align="left" valign="top">
									<div class="para">
										disk3
									</div>
									</td><td align="left" valign="top">
									<div class="para">
										131841
									</div>
									</td></tr><tr valign="top"><td align="left" valign="top">
									<div class="para">
										disk4
									</div>
									</td><td align="left" valign="top">
									<div class="para">
										131842
									</div>
									</td></tr></tbody></table></div></div><div class="para">
						Multiple performance metrics may be associated with a single instance domain.
					</div><div class="para">
						Each performance metric domain may dynamically establish the instances within an instance domain. For example, there may be one instance for the metric <code class="literal">kernel.percpu.idle</code> on a workstation, but multiple instances on a multiprocessor server. Even more dynamic is <code class="literal">filesys.free</code>, where the values report the amount of free space per file system, and the number of values tracks the mounting and unmounting of local filesystems.
					</div><div class="para">
						PCP arranges for information describing instance domains to be exported from the performance metric domains to the applications that require this information. Applications may also choose to retrieve values for all instances of a performance metric, or some arbitrary subset of the available instances.
					</div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5189653">
      ⁠</a>1.2.9. Collector and Monitor Roles</h3></div></div></div><div class="para">
					<a id="ITch01-155" class="indexterm"></a><a id="IG3137188879" class="indexterm"></a>Hosts supporting PCP services are broadly classified into two categories:
				</div><div class="variablelist"><a id="Z926617459sdc">
      ⁠</a><dl class="variablelist"><dt><span class="term">Collector</span></dt><dd><div class="para">
								<a id="ITch01-156" class="indexterm"></a><a id="IG3137188880" class="indexterm"></a>Hosts that have <code class="literal">pmcd</code> and one or more performance metric domain agents (PMDAs) running to collect and export performance metrics
							</div></dd><dt><span class="term">Monitor</span></dt><dd><div class="para">
								<a id="IG3137188881" class="indexterm"></a>Hosts that import performance metrics from one or more collector hosts to be consumed by tools to monitor, manage, or record the performance of the collector hosts
							</div></dd></dl></div><div class="para">
					Each PCP enabled host can operate as a collector, a monitor, or both.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5189901">
      ⁠</a>1.2.10. Retrospective Sources of Performance Metrics</h3></div></div></div><div class="para">
					<a id="ITch01-159" class="indexterm"></a>The PMAPI also supports delivery of performance metrics from a historical source in the form of a PCP archive log. Archive logs are created using the <code class="literal">pmlogger</code> utility, and are replayed in an architecture as shown in <a class="xref" href="#id5189940">Figure 1.4, “Architecture for Retrospective Analysis”</a>.
				</div><div class="figure"><a id="id5189940">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/retrospective-architecture.svg" type="image/svg+xml"><img src="images/retrospective-architecture.png" alt="Architecture for Retrospective Analysis" /></object></div></div><p class="title"><strong>Figure 1.4. Architecture for Retrospective Analysis</strong></p></div><div class="para">
					The PMAPI has been designed to minimize the differences required for an application to process performance data from an archive or from a real-time source. As a result, most PCP tools support live and retrospective monitoring with equal facility.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5189964">
      ⁠</a>1.2.11. Product Extensibility</h3></div></div></div><div class="para">
					<a id="ITch01-160" class="indexterm"></a>Much of the PCP software's potential for attacking difficult performance problems in production environments comes from the design philosophy that considers extensibility to be critically important.
				</div><div class="para">
					The performance analyst can take advantage of the PCP infrastructure to deploy value-added performance monitoring tools and services. Here are some examples:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							Easy extension of the PCP collector to accommodate new performance metrics and new sources of performance metrics, in particular using the interfaces of a special-purpose library to develop new PMDAs (see the <code class="command">pmda(3)</code> man page)
						</div></li><li class="listitem"><div class="para">
							<a id="IG3137188885" class="indexterm"></a><a id="IG3137188886" class="indexterm"></a>Use of libraries (<code class="filename">libpcp_pmda</code> and <code class="filename">libpcp_mmv</code>) to aid in the development of new capabilities to export performance metrics from local applications
						</div></li><li class="listitem"><div class="para">
							Operation on any performance metric using generalized toolkits
						</div></li><li class="listitem"><div class="para">
							Distribution of PCP components such as collectors across the network, placing the service where it can do the most good
						</div></li><li class="listitem"><div class="para">
							Dynamic adjustment to changes in system configuration
						</div></li><li class="listitem"><div class="para">
							Flexible customization built into the design of all PCP tools
						</div></li><li class="listitem"><div class="para">
							Creation of new monitor applications, using the routines described in the <code class="command">pmapi(3)</code> man page
						</div></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE13618-PARENT">
      ⁠</a>1.3. Overview of Component Software</h2></div></div></div><div class="para">
				<a id="IG3137188825" class="indexterm"></a><a id="IG3137188826" class="indexterm"></a>Performance Co-Pilot (PCP) is composed of both text-based and graphical tools. Each tool is fully documented by a man page. These man pages are named after the tools or commands they describe, and are accessible through the <code class="command">man</code> command. For example, to see the <code class="command">pminfo(1)</code> man page for the <code class="command">pminfo</code> command, enter this command:
			</div><pre class="literallayout"><strong class="userinput"><code>man pminfo</code></strong></pre><div class="para">
				A representative list of PCP tools and commands, grouped by functionality, is provided in the following four sections.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5177430">
      ⁠</a>1.3.1. Performance Monitoring and Visualization</h3></div></div></div><div class="para">
					<a id="IG3137188827" class="indexterm"></a><a id="IG3137188828" class="indexterm"></a>The following tools provide the principal services for the PCP end-user with an interest in monitoring, visualizing, or processing performance information collected either in real time or from PCP archive logs:
				</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="command">pmatop</code></span></dt><dd><div class="para">
								<a id="IG3137188800" class="indexterm"></a>Full-screen monitor of the load on a system from a kernel, hardware and processes point of view. It is modeled on the Linux <code class="command">atop(1)</code> tool (<a href="http://www.atoptool.nl/">home page</a>) and provides a showcase for the variety of data available using PCP services and the Python scripting interfaces.
							</div></dd><dt><span class="term"><code class="command">pmchart</code></span></dt><dd><div class="para">
								<a id="IG3137188800nat" class="indexterm"></a>Strip chart tool for arbitrary performance metrics. Interactive graphical utility that can display multiple charts simultaneously, from multiple hosts or set of archives, aligned on a unified time axis (X-axis), or on multiple tabs.
							</div></dd><dt><span class="term"><code class="command">pmcollectl</code></span></dt><dd><div class="para">
								<a id="IG3137188801" class="indexterm"></a>Statistics collection tool with good coverage of a number of Linux kernel subsystems, with the everything-in-one-tool approach pioneered by <code class="command">sar(1)</code>. It is modeled on the Linux <code class="command">collectl(1)</code> utility (<a href="http://collectl.sourceforge.net/">home page</a>) and provides another example of use of the Python scripting interfaces to build more complex functionality with relative ease, with PCP as a foundation.
							</div></dd><dt><span class="term"><code class="command">pmdumptext</code></span></dt><dd><div class="para">
								<a id="ITch01-22" class="indexterm"></a>Outputs the values of arbitrary performance metrics collected live or from a single PCP archive, in textual format.
							</div></dd><dt><span class="term"><code class="command">pmevent</code></span></dt><dd><div class="para">
								<a id="IG3137188713" class="indexterm"></a>Reports on event metrics, decoding the timestamp and event parameters for text-based reporting.
							</div></dd><dt><span class="term"><code class="command">pmie</code></span></dt><dd><div class="para">
								<a id="ITch01-32" class="indexterm"></a>Evaluates predicate-action rules over performance metrics for alarms, automated system management tasks, dynamic configuration tuning, and so on. It is an inference engine.
							</div></dd><dt><span class="term"><code class="command">pmieconf</code></span></dt><dd><div class="para">
								<a id="IG3137188829" class="indexterm"></a><a id="IG3137188830" class="indexterm"></a>Creates parameterized rules to be used with the PCP inference engine (<code class="command">pmie</code>). It can be run either interactively or from scripts for automating the setup of inference (the PCP start scripts do this, for example, to generate a default configuration).
							</div></dd><dt><span class="term"><code class="command">pminfo</code></span></dt><dd><div class="para">
								<a id="ITch01-34" class="indexterm"></a>Displays information about arbitrary performance metrics available from PCP, including help text with <code class="literal">-T</code>.
							</div></dd><dt><span class="term"><code class="command">pmlogsummary</code></span></dt><dd><div class="para">
								<a id="IG3137188831" class="indexterm"></a>Calculates and reports various statistical summaries of the performance metric values from a set of PCP archives.
							</div></dd><dt><span class="term"><code class="command">pmprobe</code></span></dt><dd><div class="para">
								<a id="IG3137188832" class="indexterm"></a>Probes for performance metric availability, values, and instances.
							</div></dd><dt><span class="term"><code class="command">pmstat</code></span></dt><dd><div class="para">
								<a id="ITch01-37" class="indexterm"></a>Provides a text-based display of metrics that summarize the performance of one or more systems at a high level.
							</div></dd><dt><span class="term"><code class="command">pmval</code></span></dt><dd><div class="para">
								<a id="ITch01-42" class="indexterm"></a>Provides a text-based display of the values for arbitrary instances of a selected performance metric, suitable for ASCII logs or inquiry over a slow link.
							</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5177776">
      ⁠</a>1.3.2. Collecting, Transporting, and Archiving Performance Information </h3></div></div></div><div class="para">
					<a id="IG3137188833" class="indexterm"></a><a id="IG3137188834" class="indexterm"></a><a id="IG3137188835" class="indexterm"></a><a id="IG3137188836" class="indexterm"></a>PCP provides the following tools to support real-time data collection, network transport, and archive log creation services for performance data:
				</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="command">mkaf</code></span></dt><dd><div class="para">
								<a id="ITch01-48" class="indexterm"></a>Aggregates an arbitrary collection of PCP archive logs into a <em class="firstterm">folio</em> to be used with <code class="command">pmafm</code>.
							</div></dd><dt><span class="term"><code class="command">pmafm</code></span></dt><dd><div class="para">
								<a id="ITch01-50" class="indexterm"></a>Interrogates, manages, and replays an archive folio as created by <code class="command">mkaf</code>, or the periodic archive log management scripts, or the record mode of other PCP tools.
							</div></dd><dt><span class="term"><code class="command">pmcd</code></span></dt><dd><div class="para">
								<a id="ITch01-52" class="indexterm"></a><a id="IG3137188837" class="indexterm"></a><a id="IG3137188838" class="indexterm"></a>Is the Performance Metrics Collection Daemon (PMCD). This daemon must run on each system being monitored, to collect and export the performance information necessary to monitor the system.
							</div></dd><dt><span class="term"><code class="command">pmcd_wait</code></span></dt><dd><div class="para">
								<a id="IG3137188839" class="indexterm"></a>Waits for <code class="command">pmcd</code> to be ready to accept client connections.
							</div></dd><dt><span class="term"><code class="command">pmdaapache</code></span></dt><dd><div class="para">
								<a id="IG3137188803" class="indexterm"></a>Exports performance metrics from the Apache Web Server. It is a Performance Metrics Domain Agent (PMDA).
							</div></dd><dt><span class="term"><code class="command">pmdacisco</code></span></dt><dd><div class="para">
								<a id="ITch01-54" class="indexterm"></a>Extracts performance metrics from one or more Cisco routers.
							</div></dd><dt><span class="term"><code class="command">pmdaelasticseach</code></span></dt><dd><div class="para">
								<a id="IG3137188714" class="indexterm"></a>Extracts performance metrics from an elasticsearch cluster.
							</div></dd><dt><span class="term"><code class="command">pmdagfs2</code></span></dt><dd><div class="para">
								<a id="IG3137188804" class="indexterm"></a>Exports performance metrics from the GFS2 clustered filesystem.
							</div></dd><dt><span class="term"><code class="command">pmdagluster</code></span></dt><dd><div class="para">
								<a id="IG3137188712" class="indexterm"></a>Extracts performance metrics from the Gluster filesystem.
							</div></dd><dt><span class="term"><code class="command">pmdainfiniband</code></span></dt><dd><div class="para">
								<a id="IG3137188805" class="indexterm"></a>Exports performance metrics from the Infiniband kernel driver.
							</div></dd><dt><span class="term"><code class="command">pmdakvm</code></span></dt><dd><div class="para">
								<a id="IG3137188806" class="indexterm"></a>Extracts performance metrics from the Linux Kernel Virtual Machine (KVM) infrastructure.
							</div></dd><dt><span class="term"><code class="command">pmdalustrecomm</code></span></dt><dd><div class="para">
								<a id="IG3137188807" class="indexterm"></a>Exports performance metrics from the Lustre clustered filesystem.
							</div></dd><dt><span class="term"><code class="command">pmdamailq</code></span></dt><dd><div class="para">
								<a id="ITch01-58" class="indexterm"></a>Exports performance metrics describing the current state of items in the <code class="literal">sendmail</code> queue.
							</div></dd><dt><span class="term"><code class="command">pmdamemcache</code></span></dt><dd><div class="para">
								<a id="IG3137188808" class="indexterm"></a>Extracts performance metrics from memcached, a distributed memory caching daemon commonly used to improve web serving performance.
							</div></dd><dt><span class="term"><code class="command">pmdammv</code></span></dt><dd><a id="IG3137188841" class="indexterm"></a><div class="para">
								Exports metrics from instrumented applications linked with the <code class="filename">pcp_mmv</code> shared library or the <a href="http://code.google.com/p/parfait/">Parfait</a> framework for Java instrumentation. These metrics are custom developed per application, and in the case of Parfait, automatically include numerous JVM, Tomcat and other server or container statistics.
							</div></dd><dt><span class="term"><code class="command">pmdamysql</code></span></dt><dd><div class="para">
								<a id="IG3137188809" class="indexterm"></a>Extracts performance metrics from the MySQL relational database.
							</div></dd><dt><span class="term"><code class="command">pmdanamed</code></span></dt><dd><div class="para">
								<a id="IG3137188701" class="indexterm"></a>Exports performance metrics from the Internet domain name server, named.
							</div></dd><dt><span class="term"><code class="command">pmdanginx</code></span></dt><dd><div class="para">
								<a id="IG3137188702" class="indexterm"></a>Extracts performance metrics from the nginx HTTP and reverse proxy server.
							</div></dd><dt><span class="term"><code class="command">pmdapostfix</code></span></dt><dd><div class="para">
								<a id="IG3137188703" class="indexterm"></a>Export performance metrics from the Postfix mail transfer agent.
							</div></dd><dt><span class="term"><code class="command">pmdapostgres</code></span></dt><dd><div class="para">
								<a id="IG3137188704" class="indexterm"></a>Extracts performance metrics from the PostgreSQL relational database.
							</div></dd><dt><span class="term"><code class="command">pmdaproc</code></span></dt><dd><div class="para">
								<a id="IG3137188705" class="indexterm"></a>Exports performance metrics for running processes.
							</div></dd><dt><span class="term"><code class="command">pmdarsyslog</code></span></dt><dd><div class="para">
								<a id="IG3137188706" class="indexterm"></a>Extracts performance metrics from the Reliable System Log daemon.
							</div></dd><dt><span class="term"><code class="command">pmdasamba</code></span></dt><dd><div class="para">
								<a id="IG3137188707" class="indexterm"></a>Extracts performance metrics from Samba, a Windows SMB/CIFS server.
							</div></dd><dt><span class="term"><code class="command">pmdasendmail</code></span></dt><dd><div class="para">
								<a id="IG3137188842" class="indexterm"></a>Exports mail activity statistics from <code class="command">sendmail</code>.
							</div></dd><dt><span class="term"><code class="literal">pmdashping</code></span></dt><dd><div class="para">
								<a id="ITch01-60" class="indexterm"></a>Exports performance metrics for the availability and quality of service (response-time) for arbitrary shell commands.
							</div></dd><dt><span class="term"><code class="command">pmdasnmp</code></span></dt><dd><div class="para">
								<a id="IG3137188708" class="indexterm"></a>Extracts SNMP performance metrics from local or remote SNMP-enabled devices.
							</div></dd><dt><span class="term"><code class="command">pmdasummary</code></span></dt><dd><div class="para">
								<a id="ITch01-62" class="indexterm"></a>Derives performance metrics values from values made available by other PMDAs. It is a PMDA itself.
							</div></dd><dt><span class="term"><code class="command">pmdasystemd</code></span></dt><dd><div class="para">
								<a id="IG3137188709" class="indexterm"></a>Extracts performance metrics from the systemd and journald services.
							</div></dd><dt><span class="term"><code class="literal">pmdatrace</code></span></dt><dd><div class="para">
								<a id="ITch01-64" class="indexterm"></a>Exports transaction performance metrics from application processes that use the <code class="filename">pcp_trace</code> library.
							</div></dd><dt><span class="term"><code class="command">pmdavmware</code></span></dt><dd><div class="para">
								<a id="IG3137188710" class="indexterm"></a>Extracts performance metrics from a VMWare virtualization host.
							</div></dd><dt><span class="term"><code class="command">pmdaweblog</code></span></dt><dd><a id="IG3137188843" class="indexterm"></a><div class="para">
								Scans Web-server logs to extract metrics characterizing.
							</div></dd><dt><span class="term"><code class="command">pmdaxfs</code></span></dt><dd><div class="para">
								<a id="IG3137188711" class="indexterm"></a>Extracts performance metrics from the Linux kernel XFS filesystem implementation.
							</div></dd><dt><span class="term"><code class="command">pmdumplog</code></span></dt><dd><div class="para">
								<a id="ITch01-66" class="indexterm"></a>Displays selected state information, control data, and metric values from a set of PCP archive logs created by <code class="command">pmlogger</code>.
							</div></dd><dt><span class="term"><code class="command">pmlc</code></span></dt><dd><div class="para">
								<a id="ITch01-68" class="indexterm"></a>Exercises control over an instance of the PCP archive logger <code class="command">pmlogger</code>, to modify the profile of which metrics are logged and/or how frequently their values are logged.
							</div></dd><dt><span class="term"><code class="command">pmlogcheck</code></span></dt><dd><div class="para">
								<a id="IG3137188844" class="indexterm"></a>Performs integrity check for individual PCP archives.
							</div></dd><dt><span class="term"><code class="command">pmlogconf</code></span></dt><dd><div class="para">
								<a id="IG3137188845" class="indexterm"></a>Creates or modifies <code class="command">pmlogger</code> configuration files for many common logging scenarios, optionally probing for available metrics and enabled functionality. It can be run either interactively or from scripts for automating the setup of data logging (the PCP start scripts do this, for example, to generate a default configuration).
							</div></dd><dt><span class="term"><code class="command">pmlogextract</code></span></dt><dd><div class="para">
								<a id="ITch01-72" class="indexterm"></a>Reads one or more PCP archive logs and creates a temporally merged and reduced PCP archive log as output.
							</div></dd><dt><span class="term"><code class="command">pmlogger</code></span></dt><dd><div class="para">
								<a id="IG3137188846" class="indexterm"></a>Creates PCP archive logs of performance metrics over time. Many tools accept these PCP archive logs as alternative sources of metrics for retrospective analysis.
							</div></dd><dt><span class="term"><code class="command">pmproxy</code></span></dt><dd><div class="para">
								<a id="ITch01-38" class="indexterm"></a>Allows the execution of PCP tools through a network firewall system.
							</div></dd><dt><span class="term"><code class="command">pmtrace</code></span></dt><dd><div class="para">
								<a id="ITch01-74" class="indexterm"></a>Provides a simple command line interface to the trace PMDA and its associated <code class="filename">pcp_trace</code> library.
							</div></dd><dt><span class="term"><code class="command">pmwebd</code></span></dt><dd><div class="para">
								<a id="IG3137188802" class="indexterm"></a>Is the Performance Metrics Web Daemon, a front-end to both <code class="command">pmcd</code> and PCP archives, providing a JSON interface suitable for use by web-based tools wishing to access performance data over HTTP.
							</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5187554">
      ⁠</a>1.3.3. Operational and Infrastructure Support</h3></div></div></div><div class="para">
					<a id="IG3137188847" class="indexterm"></a><a id="IG3137188848" class="indexterm"></a><a id="ITch01-76" class="indexterm"></a>PCP provides the following tools to support the PCP infrastructure and assist operational procedures for PCP deployment in a production environment:
				</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="command">pcp</code></span></dt><dd><div class="para">
								<a id="IG3137188850" class="indexterm"></a>Summarizes that state of a PCP installation.
							</div></dd><dt><span class="term"><code class="command">pmdbg</code></span></dt><dd><div class="para">
								<a id="ITch01-89" class="indexterm"></a><a id="IG3137188851" class="indexterm"></a><a id="ITch01-90" class="indexterm"></a>Describes the available facilities and associated control flags. PCP tools include internal diagnostic and debugging facilities that may be activated by run-time flags.
							</div></dd><dt><span class="term"><code class="command">pmerr</code></span></dt><dd><div class="para">
								<a id="ITch01-91" class="indexterm"></a>Translates PCP error codes into human-readable error messages.
							</div></dd><dt><span class="term"><code class="command">pmhostname</code></span></dt><dd><div class="para">
								<a id="IG3137188852" class="indexterm"></a>Reports hostname as returned by <code class="command">gethostbyname</code>. Used in assorted PCP management scripts.
							</div></dd><dt><span class="term"><code class="command">pmie_check</code></span></dt><dd><div class="para">
								<a id="IG3137188853" class="indexterm"></a>Administration of the Performance Co-Pilot inference engine (<code class="command">pmie</code>).
							</div></dd><dt><span class="term"><code class="command">pmlock</code></span></dt><dd><div class="para">
								<a id="ITch01-95" class="indexterm"></a>Attempts to acquire an exclusive lock by creating a file with a mode of 0.
							</div></dd><dt><span class="term"><code class="command">pmlogger_*</code></span></dt><dd><div class="para">
								<a id="IG3137188854" class="indexterm"></a><a id="IG3137188855" class="indexterm"></a><a id="IG3137188856" class="indexterm"></a><a id="IG3137188857" class="indexterm"></a><a id="IG3137188858" class="indexterm"></a>Allows you to create a customized regime of administration and management for PCP archive log files. The <code class="literal">pmlogger_check</code>, <code class="literal">pmlogger_daily</code>, and <code class="literal">pmlogger_merge</code> scripts are intended for periodic execution via the <code class="command">cron</code> command.
							</div></dd><dt><span class="term"><code class="command">pmnewlog</code></span></dt><dd><div class="para">
								<a id="ITch01-100" class="indexterm"></a>Performs archive log rotation by stopping and restarting an instance of <code class="command">pmlogger</code>.
							</div></dd><dt><span class="term"><code class="command">pmnsadd</code></span></dt><dd><div class="para">
								<a id="ITch01-102" class="indexterm"></a>Adds a subtree of new names into a PMNS, as used by the components of PCP.
							</div></dd><dt><span class="term"><code class="command">pmnsdel</code></span></dt><dd><div class="para">
								<a id="ITch01-106" class="indexterm"></a>Removes a subtree of names from a PMNS, as used by the components of the PCP.
							</div></dd><dt><span class="term"><code class="command">pmnsmerge</code></span></dt><dd><div class="para">
								<a id="IG3137188859" class="indexterm"></a>Merges multiple PMNS files together, as used by the components of PCP.
							</div></dd><dt><span class="term"><code class="command">pmstore</code></span></dt><dd><div class="para">
								<a id="ITch01-112" class="indexterm"></a>Reinitializes counters or assigns new values to metrics that act as control variables. The command changes the current values for the specified instances of a single performance metric.
							</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5188066">
      ⁠</a>1.3.4. Application and Agent Development</h3></div></div></div><div class="para">
					<a id="ITch01-114" class="indexterm"></a><a id="IG3137188860" class="indexterm"></a>The following PCP tools aid the development of new programs to consume performance data, and new agents to export performance data within the PCP framework:
				</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="command">chkhelp</code></span></dt><dd><div class="para">
								<a id="ITch01-115" class="indexterm"></a>Checks the consistency of performance metrics help database files.
							</div></dd><dt><span class="term"><code class="command">dbpmda</code></span></dt><dd><div class="para">
								<a id="ITch01-117" class="indexterm"></a>Allows PMDA behavior to be exercised and tested. It is an interactive debugger for PMDAs.
							</div></dd><dt><span class="term"><code class="command">newhelp</code></span></dt><dd><div class="para">
								<a id="ITch01-119" class="indexterm"></a>Generates the database files for one or more source files of PCP help text.
							</div></dd><dt><span class="term"><code class="command">pmapi</code></span></dt><dd><div class="para">
								<a id="ITch01-121" class="indexterm"></a><a id="IG3137188861" class="indexterm"></a><a id="IG3137188862" class="indexterm"></a>Defines a procedural interface for developing PCP client applications. It is the Performance Metrics Application Programming Interface (PMAPI).
							</div></dd><dt><span class="term"><code class="literal">pmclient</code></span></dt><dd><div class="para">
								<a id="ITch01-123" class="indexterm"></a>Is a simple client that uses the PMAPI to report some high-level system performance metrics.
							</div></dd><dt><span class="term"><code class="command">pmda</code></span></dt><dd><div class="para">
								<a id="ITch01-127" class="indexterm"></a>Is a library used by many shipped PMDAs to communicate with a <code class="command">pmcd</code> process. It can expedite the development of new and custom PMDAs.
							</div></dd><dt><span class="term"><code class="command">pmgenmap</code></span></dt><dd><div class="para">
								<a id="ITch01-125" class="indexterm"></a>Generates C declarations and <code class="command">cpp(1)</code> macros to aid the development of customized programs that use the facilities of PCP. It is a PMDA development tool.
							</div></dd></dl></div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="LE17127-PARENT">
      ⁠</a>Chapter 2. Installing and Configuring Performance Co-Pilot</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#LE18649-PARENT">2.1. Product Structure</a></span></dt><dt><span class="section"><a href="#LE26146-PARENT">2.2. Performance Metrics Collection Daemon (PMCD)</a></span></dt><dd><dl><dt><span class="section"><a href="#id5190406">2.2.1. Starting and Stopping the PMCD</a></span></dt><dt><span class="section"><a href="#LE58493-PARENT">2.2.2. Restarting an Unresponsive PMCD</a></span></dt><dt><span class="section"><a href="#id5190621">2.2.3. PMCD Diagnostics and Error Messages</a></span></dt><dt><span class="section"><a href="#id5190661">2.2.4. PMCD Options and Configuration Files</a></span></dt></dl></dd><dt><span class="section"><a href="#LE43202-PARENT">2.3. Managing Optional PMDAs</a></span></dt><dd><dl><dt><span class="section"><a href="#LE31599-PARENT">2.3.1. PMDA Installation on a PCP Collector Host</a></span></dt><dt><span class="section"><a href="#id5192380">2.3.2. PMDA Removal on a PCP Collector Host</a></span></dt></dl></dd><dt><span class="section"><a href="#LE70712-PARENT">2.4. Troubleshooting</a></span></dt><dd><dl><dt><span class="section"><a href="#LE97133-PARENT">2.4.1. Performance Metrics Name Space</a></span></dt><dt><span class="section"><a href="#LE90170-PARENT">2.4.2. Missing and Incomplete Values for Performance Metrics </a></span></dt><dt><span class="section"><a href="#LE76751-PARENT">2.4.3. Kernel Metrics and the PMCD</a></span></dt></dl></dd></dl></div><div class="para">
			<a id="ITch02-0" class="indexterm"></a><a id="ITch02-1" class="indexterm"></a><a id="ITch02-3" class="indexterm"></a>The sections in this chapter describe the basic installation and configuration steps necessary to run Performance Co-Pilot (PCP) on your systems. The following major sections are included:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					<a class="xref" href="#LE18649-PARENT">Section 2.1, “Product Structure”</a> describes the main packages of PCP software and how they must be installed on each system.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE26146-PARENT">Section 2.2, “Performance Metrics Collection Daemon (PMCD)”</a>, describes the fundamentals of maintaining the performance data collector.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE43202-PARENT">Section 2.3, “Managing Optional PMDAs”</a>, describes the basics of installing a new Performance Metrics Domain Agent (PMDA) to collect metric data and pass it to the PMCD.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE70712-PARENT">Section 2.4, “Troubleshooting”</a>, offers advice on problems involving the PMCD.
				</div></li></ul></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE18649-PARENT">
      ⁠</a>2.1. Product Structure</h2></div></div></div><div class="para">
				<a id="IG3137188887" class="indexterm"></a><a id="ITch02-5" class="indexterm"></a><a id="IG3137188888" class="indexterm"></a><a id="IG3137188889" class="indexterm"></a>In a typical deployment, Performance Co-Pilot (PCP) would be installed in a collector configuration on one or more hosts, from which the performance information could then be collected, and in a monitor configuration on one or more workstations, from which the performance of the server systems could then be monitored.
			</div><div class="para">
				On some platforms Performance Co-Pilot is presented as multiple packages; typically separating the server components from graphical user interfaces and documentation.
			</div><div class="variablelist"><a id="Z926620168sdc">
      ⁠</a><dl class="variablelist"><dt><span class="term">pcp-X.Y.Z-<em class="replaceable">rev</em></span></dt><dd><div class="para">
							package for core PCP
						</div></dd><dt><span class="term">pcp-gui-X.Y.Z-<em class="replaceable">rev</em></span></dt><dd><div class="para">
							package for graphical PCP client tools
						</div></dd><dt><span class="term">pcp-doc-X.Y.Z-<em class="replaceable">rev</em></span></dt><dd><div class="para">
							package for online PCP documentation
						</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE26146-PARENT">
      ⁠</a>2.2. Performance Metrics Collection Daemon (PMCD)</h2></div></div></div><div class="para">
				<a id="ITch02-20" class="indexterm"></a><a id="IG3137188890" class="indexterm"></a> On each Performance Co-Pilot (PCP) collection system, you must be certain that the <code class="command">pmcd</code> daemon is running. This daemon coordinates the gathering and exporting of performance statistics in response to requests from the PCP monitoring tools.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5190406">
      ⁠</a>2.2.1. Starting and Stopping the PMCD</h3></div></div></div><div class="para">
					<a id="IG3137188891" class="indexterm"></a>To start the daemon, enter the following commands as <code class="literal">root</code> on each PCP collection system:
				</div><pre class="literallayout"><strong class="userinput"><code>chkconfig pmcd on</code></strong> 
<strong class="userinput"><code>${PCP_RC_DIR}/pmcd start</code></strong> </pre><div class="para">
					These commands instruct the system to start the daemon immediately, and again whenever the system is booted. It is not necessary to start the daemon on the monitoring system unless you wish to collect performance information from it as well.
				</div><div class="para">
					To stop <code class="command">pmcd</code> immediately on a PCP collection system, enter the following command:
				</div><pre class="literallayout"><strong class="userinput"><code>${PCP_RC_DIR}/pmcd stop</code></strong></pre></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE58493-PARENT">
      ⁠</a>2.2.2. Restarting an Unresponsive PMCD</h3></div></div></div><div class="para">
					Sometimes, if a daemon is not responding on a PCP collection system, the problem can be resolved by stopping and then immediately restarting a fresh instance of the daemon. If you need to stop and then immediately restart PMCD on a PCP collection system, use the <code class="literal">start</code> argument provided with the script in <code class="filename">${PCP_RC_DIR}</code>. The command syntax is, as follows:
				</div><pre class="literallayout"><strong class="userinput"><code>${PCP_RC_DIR}/pmcd start</code></strong> </pre><div class="para">
					On startup, <code class="command">pmcd</code> looks for a configuration file at <code class="filename">${PCP_PMCDCONF_PATH}</code>. This file specifies which agents cover which performance metrics domains and how PMCD should make contact with the agents. A comprehensive description of the configuration file syntax and semantics can be found in the <code class="command">pmcd(1)</code> man page.
				</div><div class="para">
					If the configuration is changed, <code class="command">pmcd</code> reconfigures itself when it receives the <code class="literal">SIGHUP</code> signal. Use the following command to send the <code class="literal">SIGHUP</code> signal to the daemon:
				</div><pre class="literallayout"><strong class="userinput"><code>${PCP_BINADM_DIR}/pmsignal -a -s HUP pmcd</code></strong></pre><div class="para">
					This is also useful when one of the PMDAs managed by <code class="command">pmcd</code> has failed or has been terminated by <code class="command">pmcd</code>. Upon receipt of the <code class="literal">SIGHUP</code> signal, <code class="command">pmcd</code> restarts any PMDA that is configured but inactive. The exception to this rule is the case of a PMDA which must run with superuser privileges (where possible, this is avoided) - for these PMDAs, a full <code class="command">pmcd</code> restart must be performed, using the process described earlier (not SIGHUP).
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5190621">
      ⁠</a>2.2.3. PMCD Diagnostics and Error Messages</h3></div></div></div><div class="para">
					<a id="ITch02-23" class="indexterm"></a>If there is a problem with <code class="command"> pmcd</code>, the first place to investigate should be the <code class="filename">pmcd.log</code> file. By default, this file is in the <code class="filename">${PCP_LOG_DIR}/pmcd</code> directory.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5190661">
      ⁠</a>2.2.4. PMCD Options and Configuration Files</h3></div></div></div><div class="para">
					<a id="ITch02-26" class="indexterm"></a>There are two files that control PMCD operation. These are the <code class="filename">${PCP_PMCDCONF_PATH}</code> and <code class="filename">${PCP_PMCDOPTIONS_PATH}</code> files. The <code class="filename">pmcd.options</code> file contains the command line options used with PMCD; it is read when the daemon is invoked by <code class="literal">${PCP_RC_DIR}/pmcd</code>. The <code class="filename">pmcd.conf</code> file contains configuration information regarding domain agents and the metrics that they monitor. These configuration files are described in the following sections.
				</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5190706">
      ⁠</a>2.2.4.1. The <code class="filename">pmcd.options</code> File</h4></div></div></div><div class="para">
						<a id="ITch02-27" class="indexterm"></a>Command line options for the PMCD are stored in the <code class="filename">${PCP_PMCDOPTIONS_PATH}</code> file. The PMCD can be invoked directly from a shell prompt, or it can be invoked by<code class="literal"> ${PCP_RC_DIR}/pmcd</code> as part of the boot process. It is usual and normal to invoke it using <code class="literal">${PCP_RC_DIR}/pmcd</code>, reserving shell invocation for debugging purposes.
					</div><div class="para">
						The PMCD accepts certain command line options to control its execution, and these options are placed in the <code class="filename">pmcd.options</code> file when <code class="filename">${PCP_RC_DIR}/pmcd</code> is being used to start the daemon. The following options (amongst others) are available:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">-i </code> <em class="replaceable">address</em></span></dt><dd><div class="para">
									For hosts with more than one network interface, this option specifies the interface on which this instance of the PMCD accepts connections. Multiple <code class="literal">-i</code> options may be specified. The default in the absence of any <code class="literal">-i</code> option is for PMCD to accept connections on all interfaces.
								</div></dd><dt><span class="term"><code class="command">-l </code> <em class="replaceable">file</em></span></dt><dd><div class="para">
									Specifies a log file. If no <code class="literal">-l</code> option is specified, the log file name is <code class="filename">pmcd.log</code> and it is created in the directory <code class="filename">${PCP_LOG_DIR}/pmcd/</code>.
								</div></dd><dt><span class="term"><code class="command">-s </code> <em class="replaceable">file</em></span></dt><dd><div class="para">
									Specifies the path to a local unix domain socket (for platforms supporting this socket family only). The default value is <code class="filename">${PCP_RUN_DIR}/pmcd.socket</code>.
								</div></dd><dt><span class="term"><code class="command">-t </code> <em class="replaceable">seconds</em></span></dt><dd><div class="para">
									<a id="ITch02-28" class="indexterm"></a><a id="IG3137188892" class="indexterm"></a>Specifies the amount of time, in seconds, before PMCD times out on protocol data unit (PDU) exchanges with PMDAs. If no time out is specified, the default is five seconds. Setting time out to zero disables time outs (not recommended, PMDAs should always respond quickly).
								</div><div class="para">
									The time out may be dynamically modified by storing the number of seconds into the metric <code class="literal">pmcd.control.timeout</code> using <code class="command">pmstore</code>.
								</div></dd><dt><span class="term"><code class="literal">-T </code> <em class="replaceable">mask</em></span></dt><dd><div class="para">
									Specifies whether connection and PDU tracing are turned on for debugging purposes.
								</div></dd></dl></div><div class="para">
						See the <code class="command">pmcd(1)</code> man page for complete information on these options.
					</div><div class="para">
						The default <code class="filename">pmcd.options</code> file shipped with PCP is similar to the following:
					</div><pre class="literallayout"># command-line options to pmcd, uncomment/edit lines as required

# longer timeout delay for slow agents
# -t 10

# suppress timeouts
# -t 0

# make log go someplace else
# -l /some/place/else

# debugging knobs, see pmdbg(1)
# -D N
# -f

# Restricting (further) incoming PDU size to prevent DOS attacks
# -L 16384 

# enable event tracing bit fields
#   1   trace connections
#   2   trace PDUs
# 256   unbuffered tracing
# -T 3

# setting of environment variables for pmcd and
# the PCP rc scripts. See pmcd(1) and PMAPI(3).
# PMCD_WAIT_TIMEOUT=120</pre><div class="para">
						The most commonly used options have been placed in this file for your convenience. To uncomment and use an option, simply remove the pound sign (#) at the beginning of the line with the option you wish to use. Restart <code class="command">pmcd</code> for the change to take effect; that is, as superuser, enter the command:
					</div><pre class="literallayout"><strong class="userinput"><code>${PCP_RC_DIR}/pmcd start</code></strong></pre></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="LE63226-PARENT">
      ⁠</a>2.2.4.2. The <code class="filename">pmcd.conf</code> File</h4></div></div></div><div class="para">
						<a id="ITch02-29" class="indexterm"></a>When the PMCD is invoked, it reads its configuration file, which is <code class="filename">${PCP_PMCDCONF_PATH}</code>. This file contains entries that specify the PMDAs used by this instance of the PMCD and which metrics are covered by these PMDAs. Also, you may specify access control rules in this file for the various hosts, users and groups on your network. This file is described completely in the <code class="command">pmcd(1)</code> man page.
					</div><div class="para">
						With standard PCP operation (even if you have not created and added your own PMDAs), you might need to edit this file in order to add any additional access control you wish to impose. If you do not add access control rules, all access for all operations is granted to the local host, and read-only access is granted to remote hosts. The <code class="filename">pmcd.conf</code> file is automatically generated during the software build process and on Linux, for example, is similar to the following:
					</div><pre class="literallayout"> Performance Metrics Domain Specifications
# 
# This file is automatically generated during the build
# Name  Id      IPC     IPC Params      File/Cmd
pmcd    2       dso     pmcd_init       ${PCP_PMDAS_DIR}/pmcd/pmda_pmcd.so
linux   60      dso     linux_init      ${PCP_PMDAS_DIR}/linux/pmda_linux.so
proc    3       pipe    binary          ${PCP_PMDAS_DIR}/proc/pmdaproc -d 3
xfs     11      pipe    binary          ${PCP_PMDAS_DIR}/xfs/pmdaxfs -d 11

[access]
disallow * : store;
allow localhost : all;</pre><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							Even though PMCD does not run with <code class="literal">root</code> privileges, you must be very careful not to configure PMDAs in this file if you are not sure of their action. This is because all PMDAs are initially started as <code class="literal">root</code> (allowing them to assume alternate identities, such as <code class="literal">postgres</code> for example), after which <code class="command">pmcd</code> drops its privileges. Pay close attention that permissions on this file are not inadvertently downgraded to allow public write access.
						</div></div></div><div class="para">
						Each entry in this configuration file contains rules that specify how to connect the PMCD to a particular PMDA and which metrics the PMDA monitors. A PMDA may be attached as a Dynamic Shared Object (DSO) or by using a socket or a pair of pipes. The distinction between these attachment methods is described below.
					</div><div class="para">
						An entry in the <code class="filename">pmcd.conf</code> file looks like this:
					</div><pre class="literallayout"><em class="replaceable">label_name</em>   <em class="replaceable">domain_number</em>   <em class="replaceable">type</em>   <em class="replaceable">path</em></pre><div class="para">
						The <em class="replaceable">label_name</em> field specifies a name for the PMDA. The <em class="replaceable">domain_number</em> is an integer value that specifies a domain of metrics for the PMDA. The <em class="replaceable">type</em> field indicates the type of entry (DSO, socket, or pipe). The <em class="replaceable"> path</em> field is for additional information, and varies according to the type of entry.
					</div><div class="para">
						The following rules are common to DSO, socket, and pipe syntax:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="replaceable">label_name</em></span></dt><dd><div class="para">
									An alphanumeric string identifying the agent.
								</div></dd><dt><span class="term"><em class="replaceable">domain_number</em></span></dt><dd><div class="para">
									An unsigned integer specifying the agent's domain.
								</div></dd></dl></div><div class="para">
						DSO entries follow this syntax:
					</div><pre class="synopsis"><em class="replaceable">label_name</em> <em class="replaceable">domain_number</em> dso <em class="replaceable">entry-point</em> <em class="replaceable">path</em></pre><div class="para">
						The following rules apply to the DSO syntax:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">dso</code></span></dt><dd><div class="para">
									The entry type.
								</div></dd><dt><span class="term"><em class="replaceable">entry-point</em></span></dt><dd><div class="para">
									The name of an initialization function called when the DSO is loaded.
								</div></dd><dt><span class="term"><em class="replaceable">path</em></span></dt><dd><div class="para">
									Designates the location of the DSO. An absolute path must be used. On most platforms this will be a <code class="literal">so</code> suffixed file, on Windows it is a <code class="literal">dll</code>, and on Mac OS X it is a <code class="literal">dylib</code> file.
								</div></dd></dl></div><div class="para">
						Socket entries in the <code class="filename">pmcd.conf</code> file follow this syntax:
					</div><pre class="synopsis"><em class="replaceable">label_name</em> <em class="replaceable">domain_number</em> socket <em class="replaceable">addr_family</em> <em class="replaceable">address</em> <em class="replaceable">command</em> [<span class="optional"><em class="replaceable">args</em></span>] </pre><div class="para">
						The following rules apply to the socket syntax:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">socket</code></span></dt><dd><div class="para">
									The entry type.
								</div></dd><dt><span class="term"><em class="replaceable">addr_family</em></span></dt><dd><div class="para">
									Specifies if the socket is <code class="literal">AF_INET</code>, <code class="literal">AF_IPV6</code> or <code class="literal">AF_UNIX</code>. If the socket is <code class="literal">INET</code>, the word <code class="literal">inet</code> appears in this place. If the socket is <code class="literal">IPV6</code>, the word <code class="literal">ipv6</code> appears in this place. If the socket is <code class="literal">UNIX</code>, the word <code class="literal">unix</code> appears in this place.
								</div></dd><dt><span class="term"><em class="replaceable">address</em></span></dt><dd><div class="para">
									Specifies the address of the socket. For INET or IPv6 sockets, this is a port number or port name. For UNIX sockets, this is the name of the PMDA's socket on the local host.
								</div></dd><dt><span class="term"><em class="replaceable">command</em></span></dt><dd><div class="para">
									Specifies a command to start the PMDA when the PMCD is invoked and reads the configuration file.
								</div></dd><dt><span class="term"><em class="replaceable">args</em></span></dt><dd><div class="para">
									Optional arguments for <em class="replaceable">command</em>.
								</div></dd></dl></div><div class="para">
						Pipe entries in the <code class="filename">pmcd.conf</code> file follow this syntax:
					</div><pre class="synopsis"><em class="replaceable">label_name</em> <em class="replaceable">domain_number</em> pipe <em class="replaceable">protocol</em> <em class="replaceable">command</em> [<span class="optional"><em class="replaceable">args</em></span>]</pre><div class="para">
						The following rules apply to the pipe syntax:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">pipe</code></span></dt><dd><div class="para">
									The entry type.
								</div></dd><dt><span class="term"><em class="replaceable">protocol</em></span></dt><dd><div class="para">
									Specifies whether a text-based or a binary PCP protocol should be used over the pipes. Historically, this parameter was able to be “text” or “binary.” The text-based protocol has long since been deprecated and removed, however, so nowadays “binary” is the only valid value here.
								</div></dd><dt><span class="term"><em class="replaceable">command</em></span></dt><dd><div class="para">
									Specifies a command to start the PMDA when the PMCD is invoked and reads the configuration file.
								</div></dd><dt><span class="term"><em class="replaceable">args</em></span></dt><dd><div class="para">
									Optional arguments for <em class="replaceable">command</em>.
								</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5191707">
      ⁠</a>2.2.4.3. Controlling Access to PMCD with <code class="filename">pmcd.conf</code></h4></div></div></div><div class="para">
						<a id="ITch02-30" class="indexterm"></a>You can place this option extension in the <code class="filename">pmcd.conf</code> file to control access to performance metric data based on hosts, users and groups. To add an access control section, begin by placing the following line at the end of your <code class="filename">pmcd.conf</code> file:
					</div><pre class="literallayout">[access]</pre><div class="para">
						Below this line, you can add entries of the following forms:
					</div><pre class="literallayout">allow hosts <em class="replaceable">hostlist</em> : <em class="replaceable">operations</em> ;   disallow hosts <em class="replaceable">hostlist</em> : <em class="replaceable">operations</em> ;
allow users <em class="replaceable">userlist</em> : <em class="replaceable">operations</em> ;   disallow users <em class="replaceable">userlist</em> : <em class="replaceable">operations</em> ;
allow groups <em class="replaceable">grouplist</em> : <em class="replaceable">operations</em> ;   disallow groups <em class="replaceable">grouplist</em> : <em class="replaceable">operations</em> ;
</pre><div class="para">
						The keywords <em class="replaceable">users</em>, <em class="replaceable">groups</em> and <em class="replaceable">hosts</em> can be used in either plural or singular form.
					</div><div class="para">
						The <em class="replaceable">userlist</em> and <em class="replaceable">grouplist</em> fields are comma-separated lists of authenticated users and groups from the local <code class="filename">/etc/passwd</code> and <code class="filename">/etc/groups</code> files, NIS (network information service) or LDAP (lightweight directory access protocol) service.
					</div><div class="para">
						The <em class="replaceable">hostlist</em> is a comma-separated list of host identifiers; the following rules apply:
					</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
								Host names must be in the local system's <code class="filename">/etc/hosts</code> file or known to the local DNS (domain name service).
							</div></li><li class="listitem"><div class="para">
								IP and IPv6 addresses may be given in the usual numeric notations.
							</div></li><li class="listitem"><div class="para">
								A wildcarded IP or IPv6 address may be used to specify groups of hosts, with the single wildcard character * as the last-given component of the address. The wildcard .* refers to all IP (IPv4) addresses. The wildcard :* refers to all IPv6 addresses. If an IPv6 wildcard contains a :: component, then the final * refers to the final 16 bits of the address only, otherwise it refers to the remaining unspecified bits of the address.
							</div></li></ul></div><div class="para">
						The wildcard ``*'' refers to all users, groups or host addresses. Names of users, groups or hosts may not be wildcarded.
					</div><div class="para">
						For example, the following <em class="replaceable">hostlist</em> entries are all valid:
					</div><pre class="literallayout">babylon
babylon.acme.com
123.101.27.44
localhost
155.116.24.*
192.*
.*
fe80::223:14ff:feaf:b62c
fe80::223:14ff:feaf:*
fe80:*
:*
*</pre><div class="para">
						The <em class="replaceable">operations</em> field can be any of the following:
					</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
								A comma-separated list of the operation types described below.
							</div></li><li class="listitem"><div class="para">
								The word <em class="firstterm">all</em> to allow or disallow all operations as specified in the first field.
							</div></li><li class="listitem"><div class="para">
								The words <em class="firstterm">all except</em> and a list of operations. This entry allows or disallows all operations as specified in the first field except those listed.
							</div></li><li class="listitem"><div class="para">
								The phrase <em class="firstterm">maximum</em> N <em class="firstterm">connections</em> to set an upper bound (N) on the number of connections an individual host, user or group of users may make. This can only be added to the <em class="replaceable">operations</em> list of an allow statement.
							</div></li></ul></div><div class="para">
						The operations that can be allowed or disallowed are as follows:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">fetch</code></span></dt><dd><div class="para">
									Allows retrieval of information from the PMCD. This may be information about a metric (such as a description, instance domain, or help text) or an actual value for a metric.
								</div></dd><dt><span class="term"><code class="literal">store</code></span></dt><dd><div class="para">
									Allows the PMCD to store metric values in PMDAs that permit store operations. Be cautious in allowing this operation, because it may be a security opening in large networks, although the PMDAs shipped with the PCP package typically reject store operations, except for selected performance metrics where the effect is benign.
								</div></dd></dl></div><div class="para">
						For example, here is a sample access control portion of a <code class="filename">${PCP_PMCDCONF_PATH}</code> file:
					</div><pre class="literallayout">allow hosts babylon, moomba : all ; 
disallow user sam : all ;
allow group dev : fetch ; 
allow hosts 192.127.4.* : fetch ; 
disallow host gate-inet : store ;</pre><div class="para">
						Complete information on access control syntax rules in the <code class="filename">pmcd.conf</code> file can be found in the <code class="command">pmcd(1)</code> man page.
					</div></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE43202-PARENT">
      ⁠</a>2.3. Managing Optional PMDAs</h2></div></div></div><div class="para">
				<a id="ITch02-31" class="indexterm"></a>Some Performance Metrics Domain Agents (PMDAs) shipped with Performance Co-Pilot (PCP) are designed to be installed and activated on every collector host, for example, <code class="literal">linux</code>, <code class="literal">windows</code>, <code class="literal">darwin</code>, <code class="literal">pmcd</code>, and <code class="literal">process</code> PMDAs.
			</div><div class="para">
				Other PMDAs are designed for optional activation and require some user action to make them operational. In some cases these PMDAs expect local site customization to reflect the operational environment, the system configuration, or the production workload. This customization is typically supported by interactive installation scripts for each PMDA.
			</div><div class="para">
				Each PMDA has its own directory located below <code class="filename">${PCP_PMDAS_DIR}</code>. Each directory contains a <code class="filename">Remove</code> script to unconfigure the PMDA, remove the associated metrics from the PMNS, and restart the <code class="command"> pmcd</code> daemon; and an <code class="filename">Install</code> script to install the PMDA, update the PMNS, and restart the PMCD daemon.
			</div><div class="para">
				As a shortcut mechanism to support automated PMDA installation, a file named <code class="filename">.NeedInstall</code> can be created in a PMDA directory below <code class="filename">${PCP_PMDAS_DIR}</code>. The next restart of PCP services will invoke that PMDAs installation automatically, with default options taken.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE31599-PARENT">
      ⁠</a>2.3.1. PMDA Installation on a PCP Collector Host</h3></div></div></div><div class="para">
					<a id="ITch02-32" class="indexterm"></a>To install a PMDA you must perform a collector installation for each host on which the PMDA is required to export performance metrics. PCP provides a distributed metric namespace (PMNS) and metadata, so it is not necessary to install PMDAs (with their associated PMNS) on PCP monitor hosts.
				</div><div class="para">
					<a id="ITch02-33" class="indexterm"></a> You need to update the PMNS, configure the PMDA, and notify PMCD. The <code class="literal">Install</code> script for each PMDA automates these operations, as follows:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
							Log in as <code class="literal">root</code> (the superuser).
						</div></li><li class="listitem"><div class="para">
							Change to the PMDA's directory as shown in the following example:
						</div><pre class="literallayout"><strong class="userinput"><code>cd ${PCP_PMDAS_DIR}/cisco</code></strong></pre></li><li class="listitem"><div class="para">
							<a id="IG3137188893" class="indexterm"></a><a id="IG3137188894" class="indexterm"></a>In the unlikely event that you wish to use a non-default Performance Metrics Domain (PMD) assignment, determine the current PMD assignment:
						</div><pre class="literallayout"><strong class="userinput"><code>cat domain.h</code></strong></pre><div class="para">
							<a id="IG3137188895" class="indexterm"></a><a id="IG3137188896" class="indexterm"></a>Check that there is no conflict in the PMDs as defined in <code class="filename">${PCP_VAR_DIR}/pmns/stdpmid</code> and the other PMDAs currently in use (listed in <code class="filename">${PCP_PMCDCONF_PATH}</code>). Edit <code class="filename">domain.h</code> to assign the new domain number if there is a conflict (this is highly unlikely to occur in a regular PCP installation).
						</div></li><li class="listitem"><div class="para">
							Enter the following command:
						</div><pre class="literallayout"><strong class="userinput"><code>./Install</code></strong></pre><div class="para">
							You may be prompted to enter some local parameters or configuration options. The script applies all required changes to the control files and to the PMNS, and then notifies PMCD. <a class="xref" href="#Z929138022sdc">Example 2.1, “PMNS Installation Output ”</a> is illustrative of the interactions:
						</div><div class="example"><a id="Z929138022sdc">
      ⁠</a><p class="title"><strong>Example 2.1. PMNS Installation Output </strong></p><div class="example-contents"><pre class="literallayout">Cisco hostname or IP address? [return to quit] <strong class="userinput"><code>wanmelb</code></strong>

A user-level password may be required for Cisco “show int” command.
    If you are unsure, try the command
        $ telnet wanmelb
    and if the prompt “Password:” appears, a user-level password is
    required; otherwise answer the next question with an empty line.

User-level Cisco password? <strong class="userinput"><code>********</code></strong>
Probing Cisco for list of interfaces ...

Enter interfaces to monitor, one per line in the format
tX where “t” is a type and one of “e” (Ethernet), or “f” (Fddi), or
“s” (Serial), or “a” (ATM), and “X” is an interface identifier
which is either an integer (e.g.  4000 Series routers) or two
integers separated by a slash (e.g. 7000 Series routers).

The currently unselected interfaces for the Cisco “wanmelb” are:
    e0 s0 s1
Enter “quit” to terminate the interface selection process.
Interface? [e0] <strong class="userinput"><code>s0</code></strong>

The currently unselected interfaces for the Cisco “wanmelb” are:
       e0 s1
Enter “quit” to terminate the interface selection process.
Interface? [e0] <strong class="userinput"><code>s1</code></strong>

The currently unselected interfaces for the Cisco “wanmelb” are:
    e0
Enter “quit” to terminate the interface selection process.
Interface? [e0] <strong class="userinput"><code>quit</code></strong>

Cisco hostname or IP address? [return to quit]
Updating the Performance Metrics Name Space (PMNS) ...
Installing pmchart view(s) ...
Terminate PMDA if already installed ...
Installing files ...
Updating the PMCD control file, and notifying PMCD ...
Check cisco metrics have appeared ... 5 metrics and 10 values</pre></div></div></li></ol></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5192380">
      ⁠</a>2.3.2. PMDA Removal on a PCP Collector Host</h3></div></div></div><div class="para">
					<a id="ITch02-35" class="indexterm"></a>To remove a PMDA, you must perform a collector removal for each host on which the PMDA is currently installed.
				</div><div class="para">
					The PMNS needs to be updated, the PMDA unconfigured, and PMCD notified. The <code class="literal">Remove</code> script for each PMDA automates these operations, as follows:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
							Log in as <code class="literal">root</code> (the superuser).
						</div></li><li class="listitem"><div class="para">
							Change to the PMDA's directory as shown in the following example:
						</div><pre class="literallayout"><strong class="userinput"><code>cd ${PCP_PMDAS_DIR}/elasticsearch</code></strong></pre></li><li class="listitem"><div class="para">
							Enter the following command:
						</div><pre class="literallayout"><strong class="userinput"><code>./Remove</code></strong></pre><div class="para">
							The following output illustrates the result:
						</div><pre class="literallayout">Culling the Performance Metrics Name Space ...
elasticsearch ... done
Updating the PMCD control file, and notifying PMCD ...
Removing files ...
Check elasticsearch metrics have gone away ... OK</pre></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE70712-PARENT">
      ⁠</a>2.4. Troubleshooting</h2></div></div></div><div class="para">
				<a id="ITch02-38" class="indexterm"></a>The following sections offer troubleshooting advice on the Performance Metrics Name Space (PMNS), missing and incomplete values for performance metrics, kernel metrics and the PMCD.
			</div><div class="para">
				Advice for troubleshooting the archive logging system is provided in <a class="xref" href="#LE93354-PARENT">Chapter 6, <em>Archive Logging</em></a>.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE97133-PARENT">
      ⁠</a>2.4.1. Performance Metrics Name Space</h3></div></div></div><div class="para">
					<a id="IG3137188897" class="indexterm"></a><a id="IG3137188898" class="indexterm"></a>To display the active PMNS, use the <code class="literal">pminfo</code> command; see the <code class="command">pminfo(1)</code> man page.
				</div><div class="para">
					The PMNS at the collector host is updated whenever a PMDA is installed or removed, and may also be updated when new versions of PCP are installed. During these operations, the PMNS is typically updated by merging the (plaintext) namespace components from each installed PMDA. These separate PMNS components reside in the <code class="filename">${PCP_VAR_DIR}/pmns</code> directory and are merged into the <code class="filename">root</code> file there.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE90170-PARENT">
      ⁠</a>2.4.2. Missing and Incomplete Values for Performance Metrics </h3></div></div></div><div class="para">
					<a id="ITch02-39" class="indexterm"></a>Missing or incomplete performance metric values are the result of their unavailability.
				</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="LE89271-PARENT">
      ⁠</a>2.4.2.1. Metric Values Not Available</h4></div></div></div><div class="para">
						The following symptom has a known cause and resolution:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Symptom:</span></dt><dd><div class="para">
									Values for some or all of the instances of a performance metric are not available.
								</div></dd><dt><span class="term">Cause:</span></dt><dd><div class="para">
									This can occur as a consequence of changes in the installation of modules (for example, a DBMS or an application package) that provide the performance instrumentation underpinning the PMDAs. Changes in the selection of modules that are installed or operational, along with changes in the version of these modules, may make metrics appear and disappear over time.
								</div><div class="para">
									In simple terms, the PMNS contains a metric name, but when that metric is requested, no PMDA at the collector host supports the metric.
								</div><div class="para">
									For archive logs, the collection of metrics to be logged is a subset of the metrics available, so utilities replaying from a PCP archive log may not have access to all of the metrics available from a live (PMCD) source.
								</div></dd><dt><span class="term">Resolution:</span></dt><dd><div class="para">
									Make sure the underlying instrumentation is available and the module is active. Ensure that the PMDA is running on the host to be monitored. If necessary, create a new archive log with a wider range of metrics to be logged.
								</div></dd></dl></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE76751-PARENT">
      ⁠</a>2.4.3. Kernel Metrics and the PMCD</h3></div></div></div><div class="para">
					<a id="IG3137188899" class="indexterm"></a><a id="IG31371888100" class="indexterm"></a>The following issues involve the kernel metrics and the PMCD:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							Cannot connect to remote PMCD
						</div></li><li class="listitem"><div class="para">
							PMCD not reconfiguring after hang-up
						</div></li><li class="listitem"><div class="para">
							PMCD does not start
						</div></li></ul></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5192807">
      ⁠</a>2.4.3.1. Cannot Connect to Remote PMCD</h4></div></div></div><div class="para">
						<a id="IG31371888101" class="indexterm"></a><a id="ITch02-42" class="indexterm"></a>The following symptom has a known cause and resolution:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Symptom:</span></dt><dd><div class="para">
									<a id="IG31371888102" class="indexterm"></a><a id="IG31371888103" class="indexterm"></a><a id="IG31371888104" class="indexterm"></a>A PCP client tool (such as <code class="literal">pmchart</code>, <code class="literal">pmie</code>, or <code class="literal">pmlogger</code>) complains that it is unable to connect to a remote PMCD (or establish a PMAPI context), but you are sure that PMCD is active on the remote host.
								</div></dd><dt><span class="term">Cause:</span></dt><dd><div class="para">
									<a id="IG31371888105" class="indexterm"></a>To avoid hanging applications for the duration of TCP/IP time outs, the PMAPI library implements its own time out when trying to establish a connection to a PMCD. If the connection to the host is over a slow network, then successful establishment of the connection may not be possible before the time out, and the attempt is abandoned.
								</div><div class="para">
									Alternatively, there may be a firewall in-between the client tool and PMCD which is blocking the connection attempt.
								</div><div class="para">
									Finally, PMCD may be running in a mode where it does not acept remote connections, or only listening on certain interface.
								</div></dd><dt><span class="term">Resolution:</span></dt><dd><div class="para">
									Establish that the PMCD on <em class="replaceable">far-away-host</em> is really alive, by connecting to its control port (TCP port number 44321 by default):
<pre class="literallayout"><strong class="userinput"><code>telnet far-away-host 44321</code></strong></pre>
								</div><div class="para">
									This response indicates the PMCD is not running and needs restarting:
								</div><pre class="literallayout">Unable to connect to remote host: Connection refused</pre><div class="para">
									To restart the PMCD on that host, enter the following command:
<pre class="literallayout"><strong class="userinput"><code>${PCP_RC_DIR}/pmcd start</code></strong></pre>
								</div><div class="para">
									This response indicates the PMCD is running:
<pre class="literallayout">Connected to far-away-host</pre>
								</div><div class="para">
									<a id="IG31371888106" class="indexterm"></a>Interrupt the <code class="literal">telnet</code> session, increase the PMAPI time out by setting the <code class="literal">PMCD_CONNECT_TIMEOUT</code> environment variable to some number of seconds (60 for instance), and try the PCP client tool again.
								</div><div class="para">
									Verify that PMCD is not running in local-only mode, by looking for an enabled value (one) from: 
<pre class="literallayout"><strong class="userinput"><code>pminfo -f pmcd.feature.local</code></strong></pre>
								</div><div class="para">
									This setting is controlled from the <code class="literal">PMCD_LOCAL</code> environment variable usually set via <code class="filename">${PCP_SYSCONFIG_PATH}/pmcd</code>.
								</div><div class="para">
									If these techniques are ineffective, it is likely an intermediary firewall is blocking the client from accessing the PMCD port - resolving such issues is firewall-host platform-specific and cannot practically be covered here.
								</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5193049">
      ⁠</a>2.4.3.2. PMCD Not Reconfiguring after <code class="literal">SIGHUP</code></h4></div></div></div><div class="para">
						<a id="IG31371888107" class="indexterm"></a>The following symptom has a known cause and resolution:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Symptom</span></dt><dd><div class="para">
									PMCD does not reconfigure itself after receiving the <code class="literal">SIGHUP</code> signal.
								</div></dd><dt><span class="term">Cause:</span></dt><dd><div class="para">
									<a id="IG31371888108" class="indexterm"></a>If there is a syntax error in <code class="filename">${PCP_PMCDCONF_PATH}</code>, PMCD does not use the contents of the file. This can lead to situations in which the configuration file and PMCD's internal state do not agree.
								</div></dd><dt><span class="term">Resolution:</span></dt><dd><div class="para">
									Always monitor PMCD's log. For example, use the following command in another window when reconfiguring PMCD, to watch errors occur:
<pre class="literallayout"><strong class="userinput"><code>tail -f ${PCP_LOG_DIR}/pmcd/pmcd.log</code></strong></pre>
								</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5193138">
      ⁠</a>2.4.3.3. PMCD Does Not Start</h4></div></div></div><div class="para">
						<a id="IG31371888109" class="indexterm"></a>The following symptom has a known cause and resolution:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Symptom:</span></dt><dd><a id="IG31371888110" class="indexterm"></a><div class="para">
									If the following messages appear in the PMCD log (<code class="filename">${PCP_LOG_DIR}/pmcd/pmcd.log</code>), consider the cause and resolution:
								</div><pre class="literallayout">pcp[27020] Error: OpenRequestSocket(44321) bind: Address already in
use
pcp[27020] Error: pmcd is already running
pcp[27020] Error: pmcd not started due to errors!</pre></dd><dt><span class="term">Cause:</span></dt><dd><div class="para">
									PMCD is already running or was terminated before it could clean up properly. The error occurs because the socket it advertises for client connections is already being used or has not been cleared by the kernel.
								</div></dd><dt><span class="term">Resolution:</span></dt><dd><div class="para">
									Start PMCD as <code class="literal">root</code> (superuser) by typing:
<pre class="literallayout"><strong class="userinput"><code>${PCP_RC_DIR}/pmcd start</code></strong></pre>
								</div><div class="para">
									Any existing PMCD is shut down, and a new one is started in such a way that the symptomatic message should not appear.
								</div><div class="para">
									If you are starting PMCD this way and the symptomatic message appears, a problem has occurred with the connection to one of the deceased PMCD's clients.
								</div><div class="para">
									This could happen when the network connection to a remote client is lost and PMCD is subsequently terminated. The system may attempt to keep the socket open for a time to allow the remote client a chance to reestablish the connection and read any outstanding data.
								</div><div class="para">
									<a id="IG31371888111" class="indexterm"></a>The only solution in these circumstances is to wait until the socket times out and the kernel deletes it. This <code class="command">netstat</code> command displays the status of the socket and any connections:
<pre class="literallayout"><strong class="userinput"><code>netstat -ant | grep 44321</code></strong></pre>
								</div><div class="para">
									If the socket is in the <code class="literal">FIN_WAIT</code> or <code class="literal">TIME_WAIT</code> state, then you must wait for it to be deleted. Once the command above produces no output, PMCD may be restarted. Less commonly, you may have another program running on your system that uses the same Internet port number (44321) that PMCD uses.
								</div><div class="para">
									<a id="IG31371888112" class="indexterm"></a><a id="IG31371888113" class="indexterm"></a>Refer to the <code class="command">PCPIntro(1)</code> man page for a description of how to override the default PMCD port assignment using the <code class="literal">PMCD_PORT</code> environment variable.
								</div></dd></dl></div></div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="LE94335-PARENT">
      ⁠</a>Chapter 3. Common Conventions and Arguments</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#LE85600-PARENT">3.1. Alternate Metrics Source Options</a></span></dt><dd><dl><dt><span class="section"><a href="#id5193612">3.1.1. Fetching Metrics from Another Host</a></span></dt><dt><span class="section"><a href="#id5193712">3.1.2. Fetching Metrics from an Archive Log</a></span></dt></dl></dd><dt><span class="section"><a href="#LE68596-PARENT">3.2. General PCP Tool Options</a></span></dt><dd><dl><dt><span class="section"><a href="#id5194103">3.2.1. Common Directories and File Locations</a></span></dt><dt><span class="section"><a href="#id5194616">3.2.2. Alternate Performance Metric Name Spaces</a></span></dt></dl></dd><dt><span class="section"><a href="#LE76997-PARENT">3.3. Time Duration and Control</a></span></dt><dd><dl><dt><span class="section"><a href="#LE96583-PARENT">3.3.1. Performance Monitor Reporting Frequency and Duration</a></span></dt><dt><span class="section"><a href="#LE14729-PARENT">3.3.2. Time Window Options</a></span></dt><dt><span class="section"><a href="#id5195323">3.3.3. Timezone Options</a></span></dt></dl></dd><dt><span class="section"><a href="#LE61303-PARENT">3.4. PCP Environment Variables</a></span></dt><dt><span class="section"><a href="#LE12082-PARENT">3.5. Running PCP Tools through a Firewall</a></span></dt><dd><dl><dt><span class="section"><a href="#id5196469">3.5.1. The <code class="command">pmproxy</code> service</a></span></dt></dl></dd><dt><span class="section"><a href="#LE17322-PARENT">3.6. Transient Problems with Performance Metric Values </a></span></dt><dd><dl><dt><span class="section"><a href="#id5196702">3.6.1. Performance Metric Wraparound</a></span></dt><dt><span class="section"><a href="#id5196749">3.6.2. Time Dilation and Time Skew</a></span></dt></dl></dd></dl></div><div class="para">
			<a id="ITch03-0" class="indexterm"></a> <a id="ITch03-1" class="indexterm"></a><a id="Z1033415461tls" class="indexterm"></a> This chapter deals with the user interface components that are common to most text-based utilities that make up the monitor portion of Performance Co-Pilot (PCP). These are the major sections in this chapter:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					<a class="xref" href="#LE85600-PARENT">Section 3.1, “Alternate Metrics Source Options”</a>, details some basic standards used in the development of PCP tools.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE68596-PARENT">Section 3.2, “General PCP Tool Options”</a>, details other options to use with PCP tools.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE76997-PARENT">Section 3.3, “Time Duration and Control”</a>, describes the time control dialog and time-related command line options available for use with PCP tools.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE61303-PARENT">Section 3.4, “PCP Environment Variables”</a>, describes the environment variables supported by PCP tools.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE12082-PARENT">Section 3.5, “Running PCP Tools through a Firewall”</a>, describes how to execute PCP tools that must retrieve performance data from the Performance Metrics Collection Daemon (PMCD) on the other side of a TCP/IP security firewall.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE17322-PARENT">Section 3.6, “Transient Problems with Performance Metric Values ”</a>, covers some uncommon scenarios that may compromise performance metric integrity over the short term.
				</div></li></ul></div><div class="para">
			<a id="ITch03-2" class="indexterm"></a>Many of the utilities provided with PCP conform to a common set of naming and syntactic conventions for command line arguments and options. This section outlines these conventions and their meaning. The options may be generally assumed to be honored for all utilities supporting the corresponding functionality.
		</div><div class="para">
			In all cases, the man pages for each utility fully describe the supported command arguments and options.
		</div><div class="para">
			<a id="IG31371888114" class="indexterm"></a>Command line options are also relevant when starting PCP applications from the desktop using the <span class="keycap"><strong>Alt</strong></span> double-click method. This technique launches the <code class="command">pmrun</code> program to collect additional arguments to pass along when starting a PCP application.
		</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE85600-PARENT">
      ⁠</a>3.1. Alternate Metrics Source Options</h2></div></div></div><div class="para">
				The default source of performance metrics is from PMCD on the local host. This default <code class="command">pmcd</code> connection will be made using the Unix domain socket, if the platform supports that, else a localhost Inet socket connection is made. This section describes how to obtain metrics from sources other than this default.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5193612">
      ⁠</a>3.1.1. Fetching Metrics from Another Host</h3></div></div></div><div class="para">
					<a id="ITch03-3" class="indexterm"></a><a id="IG31371888115" class="indexterm"></a><a id="IG31371888116" class="indexterm"></a>The option <code class="literal">-h</code> <em class="replaceable">host</em> directs any PCP utility (such as <code class="literal">pmchart</code> or <code class="literal">pmie</code>) to make a connection with the PMCD instance running on <em class="replaceable">host</em>. Once established, this connection serves as the principal real-time source of performance metrics and metadata. The <em class="replaceable">host</em> specification may be more than a simple host name or address - it can also contain decorations specifying protocol type (secure or not), authentication information, and other connection attributes. Refer to the <code class="command">PCPIntro(1)</code> man page for full details of these, and examples of use of these specifications can also be found in the <em class="citetitle">PCP Tutorials and Case Studies</em> companion document.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5193712">
      ⁠</a>3.1.2. Fetching Metrics from an Archive Log</h3></div></div></div><div class="para">
					<a id="ITch03-6" class="indexterm"></a><a id="ITch03-5" class="indexterm"></a><a id="ITch03-8" class="indexterm"></a>The option <code class="literal">-a</code><em class="replaceable">archive</em> directs the utility to treat the set of PCP archive logs designated by <em class="replaceable">archive</em> as the principal source of performance metrics and metadata. <em class="replaceable">archive</em> is a comma-sparated list of names, each of which may be the base name of an archive or the name of a directory containing archives.
				</div><div class="para">
					<a id="IG31371888117" class="indexterm"></a>PCP archive logs are created with <code class="command">pmlogger</code>. Most PCP utilities operate with equal facility for performance information coming from either a real-time feed via PMCD on some host, or for historical data from a set of PCP archive logs. For more information on archive logs and their use, see <a class="xref" href="#LE93354-PARENT">Chapter 6, <em>Archive Logging</em></a>.
				</div><div class="para">
					<a id="ITch03-9" class="indexterm"></a>The list of names (<code class="filename">archive</code>) used with the <code class="literal">-a</code> option implies the existence of the files created automatically by <code class="command">pmlogger</code>, as listed in <a class="xref" href="#id5193871">Table 3.1, “Physical Filenames for Components of a PCP Archive Log”</a>.
				</div><div class="table"><a id="id5193871">
      ⁠</a><p class="title"><strong>Table 3.1. Physical Filenames for Components of a PCP Archive Log</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols lt-7-rows" summary="Physical Filenames for Components of a PCP Archive Log"><colgroup><col width="25%" /><col width="75%" /></colgroup><thead><tr valign="top"><th align="left" valign="bottom">
								<div class="para">
									Filename
								</div>
								</th><th align="left" valign="bottom">
								<div class="para">
									Contents
								</div>
								</th></tr></thead><tbody><tr valign="top"><td align="left" valign="top">
								<div class="para">
									<code class="filename">archive.</code><em class="replaceable"> index</em><span class="bold bold"><strong></strong></span>
								</div>
								</td><td align="left" valign="top">
								<div class="para">
									Temporal index for rapid access to archive contents
								</div>
								</td></tr><tr class="even" valign="top"><td align="left" valign="top">
								<div class="para">
									<code class="filename">archive.</code><em class="replaceable"> meta</em>
								</div>
								</td><td align="left" valign="top">
								<div class="para">
									Metadata descriptions for performance metrics and instance domains appearing in the archive
								</div>
								</td></tr><tr valign="top"><td align="left" valign="top">
								<div class="para">
									<code class="filename">archive.N</code>
								</div>
								</td><td align="left" valign="top">
								<div class="para">
									Volumes of performance metrics values, for <code class="filename">N</code> = 0,1,2,...
								</div>
								</td></tr></tbody></table></div></div><div class="para">
					Most tools are able to concurrently process multiple PCP archive logs (for example, for retrospective analysis of performance across multiple hosts), and accept either multiple <code class="command">-a</code> options or a comma separated list of archive names following the <code class="command">-a</code> option.
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						The <code class="command">-h</code> and <code class="command">-a</code> options are almost always mutually exclusive. Currently, <code class="command">pmchart</code> is the exception to this rule but other tools may continue to blur this line in the future.
					</div></div></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE68596-PARENT">
      ⁠</a>3.2. General PCP Tool Options</h2></div></div></div><div class="para">
				<a id="IG31371888118" class="indexterm"></a>The following sections provide information relevant to most of the PCP tools. It is presented here in a single place for convenience.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5194103">
      ⁠</a>3.2.1. Common Directories and File Locations</h3></div></div></div><div class="para">
					<a id="IG31371888119" class="indexterm"></a><a id="IG31371888120" class="indexterm"></a>The following files and directories are used by the PCP tools as repositories for option and configuration files and for binaries:
				</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="filename">${PCP_DIR}/etc/pcp.env</code></span></dt><dd><div class="para">
								<a id="IG31371888121" class="indexterm"></a>Script to set PCP run-time environment variables.
							</div></dd><dt><span class="term"><code class="filename">${PCP_DIR}/etc/pcp.conf</code></span></dt><dd><div class="para">
								<a id="IG31371888122" class="indexterm"></a>PCP configuration and environment file.
							</div></dd><dt><span class="term"><code class="filename">${PCP_PMCDCONF_PATH}</code></span></dt><dd><div class="para">
								<a id="IG31371888123" class="indexterm"></a><a id="IG31371888124" class="indexterm"></a>Configuration file for Performance Metrics Collection Daemon (PMCD). Sets environment variables, including <code class="literal">PATH</code>.
							</div></dd><dt><span class="term"><code class="filename">${PCP_BINADM_DIR}/pmcd</code></span></dt><dd><div class="para">
								<a id="IG31371888125" class="indexterm"></a>The PMCD binary.
							</div></dd><dt><span class="term"><code class="filename">${PCP_PMCDOPTIONS_PATH}</code></span></dt><dd><div class="para">
								<a id="IG31371888126" class="indexterm"></a>Command line options for PMCD.
							</div></dd><dt><span class="term"><code class="filename">${PCP_RC_DIR}/pmcd</code></span></dt><dd><div class="para">
								<a id="IG31371888127" class="indexterm"></a>The PMCD startup script.
							</div></dd><dt><span class="term"><code class="filename">${PCP_BIN_DIR}/<em class="replaceable">pcptool</em></code></span></dt><dd><div class="para">
								Directory containing PCP tools such as <code class="command">pmstat </code>, <code class="command">pminfo</code>, <code class="command">pmlogger</code>, <code class="command">pmlogsummary</code>, <code class="command">pmchart</code>, <code class="command">pmie</code>, and so on.
							</div></dd><dt><span class="term"><code class="filename">${PCP_SHARE_DIR}</code></span></dt><dd><div class="para">
								Directory containing shareable PCP-specific files and repository directories such as <code class="command">bin</code>, <code class="command">demos</code>, <code class="command">examples</code> and <code class="command">lib</code>.
							</div></dd><dt><span class="term"><code class="filename">${PCP_VAR_DIR}</code></span></dt><dd><div class="para">
								Directory containing non-shareable (that is, per-host) PCP specific files and repository directories.
							</div></dd><dt><span class="term"><code class="filename">${PCP_BINADM_DIR}/<em class="replaceable">pcptool</em></code></span></dt><dd><div class="para">
								PCP tools that are typically not executed directly by the end user such as <code class="command">pmcd_wait</code>.
							</div></dd><dt><span class="term"><code class="filename">${PCP_SHARE_DIR}/lib/<em class="replaceable">pcplib</em></code></span></dt><dd><div class="para">
								Miscellaneous PCP libraries and executables.
							</div></dd><dt><span class="term"><code class="filename">${PCP_PMDAS_DIR}</code></span></dt><dd><div class="para">
								Performance Metric Domain Agents (PMDAs), one directory per PMDA.
							</div></dd><dt><span class="term"><code class="filename">${PCP_VAR_DIR}/config</code></span></dt><dd><div class="para">
								Configuration files for PCP tools, typically with one directory per tool.
							</div></dd><dt><span class="term"><code class="filename">${PCP_DEMOS_DIR}</code></span></dt><dd><div class="para">
								Demonstration data files and example programs.
							</div></dd><dt><span class="term"><code class="filename">${PCP_LOG_DIR}</code></span></dt><dd><div class="para">
								By default, diagnostic and trace log files generated by PMCD and PMDAs. Also, the PCP archive logs are managed in one directory per logged host below here.
							</div></dd><dt><span class="term"><code class="filename">${PCP_VAR_DIR}/pmns</code></span></dt><dd><div class="para">
								Files and scripts for the Performance Metrics Name Space (PMNS).
							</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5194616">
      ⁠</a>3.2.2. Alternate Performance Metric Name Spaces</h3></div></div></div><div class="para">
					<a id="ITch03-10" class="indexterm"></a>The Performance Metrics Name Space (PMNS) defines a mapping from a collection of human-readable names for performance metrics (convenient to the user) into corresponding internal identifiers (convenient for the underlying implementation).
				</div><div class="para">
					The distributed PMNS used in PCP avoids most requirements for an alternate PMNS, because clients' PMNS operations are supported at the Performance Metrics Collection Daemon (PMCD) or by means of PMNS data in a PCP archive log. The distributed PMNS is the default, but alternates may be specified using the <code class="command">-n</code> <em class="replaceable">namespace</em> argument to the PCP tools. When a PMNS is maintained on a host, it is likely to reside in the <code class="filename">${PCP_VAR_DIR}/pmns</code> directory.
				</div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE76997-PARENT">
      ⁠</a>3.3. Time Duration and Control</h2></div></div></div><div class="para">
				<a id="IG31371888129" class="indexterm"></a>The periodic nature of sampling performance metrics and refreshing the displays of the PCP tools makes specification and control of the temporal domain a common operation. In the following sections, the services and conventions for specifying time positions and intervals are described.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE96583-PARENT">
      ⁠</a>3.3.1. Performance Monitor Reporting Frequency and Duration</h3></div></div></div><div class="para">
					<a id="IG31371888130" class="indexterm"></a><a id="IG31371888131" class="indexterm"></a>Many of the performance monitoring utilities have periodic reporting patterns. The <code class="literal">-t </code> <em class="replaceable">interval</em> and <code class="literal">-s</code> <em class="replaceable">samples</em> options are used to control the sampling (reporting) interval, usually expressed as a real number of seconds (<em class="replaceable">interval</em>), and the number of <em class="replaceable">samples</em> to be reported, respectively. In the absence of the <code class="literal">-s</code> flag, the default behavior is for the performance monitoring utilities to run until they are explicitly stopped.
				</div><div class="para">
					<a id="IG31371888132" class="indexterm"></a>The <em class="replaceable"> interval</em> argument may also be expressed in terms of minutes, hours, or days, as described in the <code class="command">PCPIntro(1)</code> man page.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE14729-PARENT">
      ⁠</a>3.3.2. Time Window Options</h3></div></div></div><div class="para">
					<a id="IG31371888133" class="indexterm"></a><a id="IG31371888134" class="indexterm"></a>The following options may be used with most PCP tools (typically when the source of the performance metrics is a PCP archive log) to tailor the beginning and end points of a display, the sample origin, and the sample time alignment to your convenience.
				</div><div class="para">
					The <code class="literal">-S</code>, <code class="literal">-T</code>, <code class="literal">-O</code> and <code class="literal">-A</code> command line options are used by PCP applications to define a time window of interest.
				</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">-S </code> <em class="replaceable">duration</em></span></dt><dd><div class="para">
								The start option may be used to request that the display start at the nominated time. By default, the first sample of performance data is retrieved immediately in real-time mode, or coincides with the first sample of data of the first archive in a set of PCP archive logs in archive mode. For archive mode, the <code class="literal">-S</code> option may be used to specify a later time for the start of sampling. By default, if <em class="replaceable">duration</em> is an integer, the units are assumed to be seconds.
							</div><div class="para">
								To specify an offset from the beginning of a set of PCP archives (in archive mode) simply specify the offset as the <em class="replaceable">duration</em>. For example, the following entry retrieves the first sample of data at exactly 30 minutes from the beginning of a set of PCP archives.
							</div><div class="para">
								
<pre class="literallayout">-S 30min</pre>
							</div><div class="para">
								To specify an offset from the end of a set of PCP archives, prefix the <em class="replaceable">duration</em> with a minus sign. In this case, the first sample time precedes the end of archived data by the given <em class="replaceable">duration</em>. For example, the following entry retrieves the first sample exactly one hour preceding the last sample in a set of PCP archives.
							</div><div class="para">
								
<pre class="literallayout">-S -1hour</pre>
							</div><div class="para">
								To specify the calendar date and time (local time in the reporting timezone) for the first sample, use the <code class="literal">ctime(3)</code> syntax preceded by an “at” sign (@). For example, the following entry specifies the date and time to be used.
							</div><div class="para">
								
<pre class="literallayout">-S '@ Mon Mar 4 13:07:47 2013'</pre>
							</div><div class="para">
								Note that this format corresponds to the output format of the <code class="command">date</code> command for easy “cut and paste.” However, be sure to enclose the string in quotes so it is preserved as a single argument for the PCP tool.
							</div><div class="para">
								For more complete information on the date and time syntax, see the <code class="command">PCPIntro(1)</code> man page.
							</div></dd><dt><span class="term"><code class="literal">-T </code> <em class="replaceable">duration</em> </span></dt><dd><div class="para">
								The terminate option may be used to request that the display stop at the time designated by <em class="replaceable">duration</em>. By default, the PCP tools keep sampling performance data indefinitely (in real-time mode) or until the end of a set of PCP archives (in archive mode). The <code class="literal">-T</code> option may be used to specify an earlier time to terminate sampling.
							</div><div class="para">
								The interpretation for the <em class="replaceable">duration</em> argument in a <code class="literal">-T</code> option is the same as for the <code class="literal">-S</code> option, except for an unsigned time interval that is interpreted as being an offset from the start of the time window as defined by the default (now for real time, else start of archive set) or by a <code class="literal">-S</code> option. For example, these options define a time window that spans 45 minutes, after an initial offset (or delay) of 1 hour:
<pre class="literallayout">-S 1hour -T 45mins</pre>
							</div></dd><dt><span class="term"><code class="literal">-O </code> <em class="replaceable">duration</em></span></dt><dd><div class="para">
								By default, samples are fetched from the start time (see the description of the <code class="literal">-S</code> option) to the terminate time (see the description of the <code class="literal">-T</code> option). The offset <code class="literal">-O</code> option allows the specification of a time between the start time and the terminate time where the tool should position its initial sample time. This option is useful when initial attention is focused at some point within a larger time window of interest, or when one PCP tool wishes to launch another PCP tool with a common current point of time within a shared time window.
							</div><div class="para">
								The <em class="replaceable">duration</em> argument accepted by <code class="literal">-O</code> conforms to the same syntax and semantics as the <em class="replaceable"> duration</em> argument for <code class="literal">-T</code>. For example, these options specify that the initial position should be the end of the time window:
<pre class="literallayout">-O -0</pre>
							</div><div class="para">
								This is most useful with the <code class="command">pmchart</code> command to display the tail-end of the history up to the end of the time window.
							</div></dd><dt><span class="term"><code class="literal">-A </code> <em class="replaceable">alignment</em></span></dt><dd><div class="para">
								By default, performance data samples do not necessarily happen at any natural unit of measured time. The <code class="literal">-A</code> switch may be used to force the initial sample to be on the specified <em class="replaceable">alignment</em>. For example, these three options specify alignment on seconds, half hours, and whole hours:
<pre class="literallayout">-A 1sec 
-A 30min 
-A 1hour</pre>
							</div><div class="para">
								The <code class="literal">-A</code> option advances the time to achieve the desired alignment as soon as possible after the start of the time window, whether this is the default window, or one specified with some combination of <code class="literal">-A</code> and <code class="literal">-O</code> command line options.
							</div></dd></dl></div><div class="para">
					Obviously the time window may be overspecified by using multiple options from the set <code class="literal">-t</code>, <code class="literal">-s</code>, <code class="literal">-S</code>, <code class="literal">-T</code>, <code class="literal">-A</code>, and <code class="literal">-O</code>. Similarly, the time window may shrink to nothing by injudicious choice of options.
				</div><div class="para">
					In all cases, the parsing of these options applies heuristics guided by the principal of “least surprise”; the time window is always well-defined (with the end never earlier than the start), but may shrink to nothing in the extreme.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5195323">
      ⁠</a>3.3.3. Timezone Options</h3></div></div></div><div class="para">
					<a id="ITch03-12" class="indexterm"></a>All utilities that report time of day use the local timezone by default. The following timezone options are available:
				</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">-z</code></span></dt><dd><div class="para">
								Forces times to be reported in the timezone of the host that provided the metric values (the PCP collector host). When used in conjunction with <code class="literal">-a</code> and multiple archives, the convention is to use the timezone from the first named archive.
							</div></dd><dt><span class="term"><code class="literal">-Z </code> <em class="replaceable">timezone</em> </span></dt><dd><div class="para">
								<a id="IG31371888135" class="indexterm"></a>Sets the TZ variable to a timezone string, as defined in <code class="command">environ(7)</code>, for example, <code class="literal">-Z UTC</code> for universal time.
							</div></dd></dl></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE61303-PARENT">
      ⁠</a>3.4. PCP Environment Variables</h2></div></div></div><div class="para">
				<a id="ITch03-14" class="indexterm"></a><a id="IG31371888136" class="indexterm"></a><a id="IG31371888137" class="indexterm"></a><a id="IG31371888138" class="indexterm"></a><a id="IG31371888139" class="indexterm"></a>When you are using PCP tools and utilities and are calling PCP library functions, a standard set of defined environment variables are available in the <code class="filename">${PCP_DIR}/etc/pcp.conf</code> file. These variables are generally used to specify the location of various PCP pieces in the file system and may be loaded into shell scripts by sourcing the <code class="filename">${PCP_DIR}/etc/pcp.env</code> shell script. They may also be queried by C, C++, perl and python programs using the <code class="command">pmGetConfig</code> library function. If a variable is already defined in the environment, the values in the <code class="filename">pcp.conf</code> file do not override those values; that is, the values in <code class="filename">pcp.conf</code> serve only as installation defaults. For additional information, see the <code class="command">pcp.conf(5)</code>, <code class="command">pcp.env(5)</code>, and <code class="command">pmGetConfig(3)</code> man pages.
			</div><div class="para">
				The following environment variables are recognized by PCP (these definitions are also available on the <code class="command">PCPIntro(1)</code> man page):
			</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">PCP_COUNTER_WRAP</code></span></dt><dd><div class="para">
							<a id="ITch03-15" class="indexterm"></a>Many of the performance metrics exported from PCP agents expect that counters increase monotonically. Under some circumstances, one value of a metric may be smaller than the previously fetched value. This can happen when a counter of finite precision overflows, when the PCP agent has been reset or restarted, or when the PCP agent exports values from an underlying instrumentation that is subject to asynchronous discontinuity.
						</div><div class="para">
							If set, the <code class="literal">PCP_COUNTER_WRAP</code> environment variable indicates that all such cases of a decreasing counter should be treated as a counter overflow; and hence the values are assumed to have wrapped once in the interval between consecutive samples. Counter wrapping was the default in versions before the PCP release 1.3.
						</div></dd><dt><span class="term"><code class="literal">PCP_STDERR</code></span></dt><dd><div class="para">
							<a id="ITch03-18" class="indexterm"></a><a id="IG31371888140" class="indexterm"></a><a id="IG31371888141" class="indexterm"></a>Specifies whether <code class="command">pmprintf()</code> error messages are sent to standard error, an <code class="literal">pmconfirm</code> dialog box, or to a named file; see the <code class="command">pmprintf(3)</code> man page. Messages go to standard error if <code class="literal">PCP_STDERR</code> is unset or set without a value. If this variable is set to <code class="literal">DISPLAY</code>, then messages go to an <code class="literal">pmconfirm</code> dialog box; see the <code class="command">pmconfirm(1)</code> man page. Otherwise, the value of <code class="literal">PCP_STDERR</code> is assumed to be the name of an output file.
						</div></dd><dt><span class="term"><code class="literal">PMCD_CONNECT_TIMEOUT</code></span></dt><dd><div class="para">
							<a id="ITch03-22" class="indexterm"></a><a id="IG31371888143" class="indexterm"></a>When attempting to connect to a remote PMCD on a system that is booting or at the other end of a slow network link, some PMAPI routines could potentially block for a long time until the remote system responds. These routines abort and return an error if the connection has not been established after some specified interval has elapsed. The default interval is 5 seconds. This may be modified by setting this variable in the environment to a larger number of seconds for the desired time out. This is most useful in cases where the remote host is at the end of a slow network, requiring longer latencies to establish the connection correctly.
						</div></dd><dt><span class="term"><code class="literal">PMCD_PORT</code></span></dt><dd><div class="para">
							<a id="ITch03-23" class="indexterm"></a><a id="IG31371888144" class="indexterm"></a><a id="IG31371888145" class="indexterm"></a>This TCP/IP port is used by PMCD to create the socket for incoming connections and requests. The default is port number 44321, which you may override by setting this variable to a different port number. If a non-default port is in effect when PMCD is started, then every monitoring application connecting to that PMCD must also have this variable set in its environment before attempting a connection.
						</div></dd><dt><span class="term"><code class="literal">PMCD_LOCAL</code></span></dt><dd><div class="para">
							<a id="ITch03-21" class="indexterm"></a><a id="IG31371889144" class="indexterm"></a>This setting indicates that PMCD must only bind to the loopback interface for incoming connections and requests. In this mode, connections from remote hosts are not possible.
						</div></dd><dt><span class="term"><code class="literal">PMCD_RECONNECT_TIMEOUT</code></span></dt><dd><div class="para">
							<a id="ITch03-24" class="indexterm"></a><a id="IG31371888146" class="indexterm"></a>When a monitor or client application loses its connection to a PMCD, the connection may be reestablished by calling the <code class="command">pmReconnectContext(3)</code> PMAPI function. However, attempts to reconnect are controlled by a back-off strategy to avoid flooding the network with reconnection requests. By default, the back-off delays are 5, 10, 20, 40, and 80 seconds for consecutive reconnection requests from a client (the last delay is repeated for any further attempts after the last delay in the list). Setting this environment variable to a comma-separated list of positive integers redefines the back-off delays. For example, setting the delays to <strong class="userinput"><code>1,2</code></strong> will back off for 1 second, then back off every 2 seconds thereafter.
						</div></dd><dt><span class="term"><code class="literal">PMCD_REQUEST_TIMEOUT</code></span></dt><dd><div class="para">
							<a id="ITch03-25" class="indexterm"></a><a id="IG31371888147" class="indexterm"></a>For monitor or client applications connected to PMCD, there is a possibility of the application hanging on a request for performance metrics or metadata or help text. These delays may become severe if the system running PMCD crashes or the network connection is lost or the network link is very slow. By setting this environment variable to a real number of seconds, requests to PMCD timeout after the specified number of seconds. The default behavior is to wait 10 seconds for a response from every PMCD for all applications.
						</div></dd><dt><span class="term"><code class="literal">PMLOGGER_PORT</code></span></dt><dd><div class="para">
							<a id="IG31371888148" class="indexterm"></a><a id="IG31371888149" class="indexterm"></a><a id="IG31371888150" class="indexterm"></a>This environment variable may be used to change the base TCP/IP port number used by <code class="command">pmlogger</code> to create the socket to which <code class="command">pmlc</code> instances try to connect. The default base port number is 4330. If used, this variable should be set in the environment before <code class="command">pmlogger</code> is executed. If <code class="command">pmlc</code> and <code class="command">pmlogger</code> are on different hosts, then obviously <code class="literal">PMLOGGER_PORT</code> must be set to the same value in both places.
						</div></dd><dt><span class="term"><code class="literal">PMLOGGER_LOCAL</code></span></dt><dd><div class="para">
							<a id="IG31371889148" class="indexterm"></a><a id="IG31371888142" class="indexterm"></a>This environment variable indicates that <code class="command">pmlogger</code> must only bind to the loopback interface for <code class="command">pmlc</code> connections and requests. In this mode, <code class="command">pmlc</code> connections from remote hosts are not possible. If used, this variable should be set in the environment before <code class="command">pmlogger</code> is executed.
						</div></dd><dt><span class="term"><code class="literal">PMPROXY_PORT</code></span></dt><dd><div class="para">
							<a id="ITch03-30" class="indexterm"></a><a id="IG31371888152" class="indexterm"></a> This environment variable may be used to change the base TCP/IP port number used by <code class="command">pmproxy</code> to create the socket to which proxied clients connect, on their way to a distant <code class="command">pmcd</code>.
						</div></dd><dt><span class="term"><code class="literal">PMPROXY_LOCAL</code></span></dt><dd><div class="para">
							<a id="ITch03-31" class="indexterm"></a><a id="IG31371888151" class="indexterm"></a> This setting indicates that <code class="command">pmproxy</code> must only bind to the loopback interface for incoming connections and requests. In this mode, connections from remote hosts are not possible.
						</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE12082-PARENT">
      ⁠</a>3.5. Running PCP Tools through a Firewall</h2></div></div></div><div class="para">
				<a id="IG31371888153" class="indexterm"></a><a id="IG31371888154" class="indexterm"></a>In some production environments, the Performance Co-Pilot (PCP) monitoring hosts are on one side of a TCP/IP firewall, and the PCP collector hosts may be on the other side.
			</div><div class="para">
				<a id="IG31371888155" class="indexterm"></a><a id="IG31371888156" class="indexterm"></a><a id="IG31371888157" class="indexterm"></a><a id="IG31371888158" class="indexterm"></a><a id="IG31371888159" class="indexterm"></a><a id="IG31371888160" class="indexterm"></a><a id="IG31371888161" class="indexterm"></a>If the firewall service sits between the monitor and collector tools, the <code class="literal">pmproxy</code> service may be used to perform both packet forwarding and DNS proxying through the firewall; see the <code class="command">pmproxy(1)</code> man page. Otherwise, it is necessary to arrange for packet forwarding to be enabled for those TCP/IP ports used by PCP, namely 44321 (or the value of the <code class="literal">PMCD_PORT</code> environment variable) for connections to PMCD.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5196469">
      ⁠</a>3.5.1. The <code class="command">pmproxy</code> service</h3></div></div></div><div class="para">
					The <code class="command">pmproxy</code> service allows PCP clients running on hosts located on one side of a firewall to monitor remote hosts on the other side. The basic connection syntax is as follows, where <em class="replaceable">tool</em> is an arbitrary PCP application, typically a monitoring tool:
				</div><pre class="literallayout">pmprobe -h remotehost@proxyhost</pre><div class="para">
					This extended host specification syntax is part of a larger set of available extensions to the basic host naming syntax - refer to the <code class="command">PCPIntro(1)</code> man page for further details.
				</div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE17322-PARENT">
      ⁠</a>3.6. Transient Problems with Performance Metric Values </h2></div></div></div><div class="para">
				<a id="IG31371888164" class="indexterm"></a>Sometimes the values for a performance metric as reported by a PCP tool appear to be incorrect. This is typically caused by transient conditions such as metric wraparound or time skew, described below. These conditions result from design decisions that are biased in favor of lightweight protocols and minimal resource demands for PCP components.
			</div><div class="para">
				In all cases, these events are expected to occur infrequently, and should not persist beyond a few samples.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5196702">
      ⁠</a>3.6.1. Performance Metric Wraparound</h3></div></div></div><div class="para">
					<a id="ITch03-32" class="indexterm"></a><a id="IG31371888165" class="indexterm"></a>Performance metrics are usually expressed as numbers with finite precision. For metrics that are cumulative counters of events or resource consumption, the value of the metric may occasionally overflow the specified range and wraparound to zero.
				</div><div class="para">
					Because the value of these counter metrics is computed from the rate of change with respect to the previous sample, this may result in a transient condition where the rate of change is an unknown value. If the <code class="literal">PCP_COUNTER_WRAP</code> environment variable is set, this condition is treated as an overflow, and speculative rate calculations are made. In either case, the correct rate calculation for the metric returns with the next sample.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5196749">
      ⁠</a>3.6.2. Time Dilation and Time Skew</h3></div></div></div><div class="para">
					<a id="ITch03-33" class="indexterm"></a>If a PMDA is tardy in returning results, or the PCP monitoring tool is connected to PMCD via a slow or congested network, an error might be introduced in rate calculations due to a difference between the time the metric was sampled and the time PMCD sends the result to the monitoring tool.
				</div><div class="para">
					In practice, these errors are usually so small as to be insignificant, and the errors are self-correcting (not cumulative) over consecutive samples.
				</div><div class="para">
					A related problem may occur when the system time is not synchronized between multiple hosts, and the time stamps for the results returned from PMCD reflect the skew in the system times. In this case, it is recommended that NTP (network time protocol) be used to keep the system clocks on the collector systems synchronized; for information on NTP refer to the <code class="command">ntpd(1)</code> man page.
				</div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="LE38515-PARENT">
      ⁠</a>Chapter 4. Monitoring System Performance</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#LE91266-PARENT">4.1. The <code class="command">pmstat</code> Command</a></span></dt><dt><span class="section"><a href="#Z926977852sdc">4.2. The <code class="command">pmdumptext</code> Command</a></span></dt><dt><span class="section"><a href="#LE35315-PARENT">4.3. The <code class="command">pmval</code> Command</a></span></dt><dt><span class="section"><a href="#LE60452-PARENT">4.4. The <code class="command">pminfo</code> Command</a></span></dt><dt><span class="section"><a href="#LE10170-PARENT">4.5. The <code class="command">pmstore</code> Command</a></span></dt></dl></div><div class="para">
			<a id="IG31371888166" class="indexterm"></a><a id="IG31371888167" class="indexterm"></a><a id="IG31371888168" class="indexterm"></a><a id="Z1033415772tls" class="indexterm"></a>This chapter describes the performance monitoring tools available in Performance Co-Pilot (PCP). This product provides a group of commands and tools for measuring system performance. Each tool is described completely by its own man page. The man pages are accessible through the <code class="command">man</code> command. For example, the man page for the tool <code class="command">pmdumptext</code> is viewed by entering the following command:
		</div><pre class="literallayout"><strong class="userinput"><code>man pmdumptext</code></strong></pre><div class="para">
			The following major sections are covered in this chapter:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para"><a id="Z930615099sdc">
      ⁠</a>
					<a class="xref" href="#LE91266-PARENT">Section 4.1, “The <code class="command">pmstat</code> Command”</a>, discusses <code class="command">pmstat</code>, a utility that provides a periodic one-line summary of system performance.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#Z926977852sdc">Section 4.2, “The <code class="command">pmdumptext</code> Command”</a>, discusses <code class="command">pmdumptext</code>, a utility that shows the current values for named performance metrics.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE35315-PARENT">Section 4.3, “The <code class="command">pmval</code> Command”</a>, describes <code class="command">pmval</code>, a utility that displays performance metrics in a textual format.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE60452-PARENT">Section 4.4, “The <code class="command">pminfo</code> Command”</a>, describes <code class="command">pminfo</code>, a utility that displays information about performance metrics.
				</div></li><li class="listitem"><div class="para">
					<a id="IG31371888169" class="indexterm"></a><a class="xref" href="#LE10170-PARENT">Section 4.5, “The <code class="command">pmstore</code> Command”</a>, describes the use of the <code class="command">pmstore</code> utility to arbitrarily set or reset selected performance metric values.
				</div></li></ul></div><div class="para">
			<a id="IG31371888170" class="indexterm"></a><a id="IG31371888171" class="indexterm"></a>The following sections describe the various graphical and text-based PCP tools used to monitor local or remote system performance.
		</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE91266-PARENT">
      ⁠</a>4.1. The <code class="command">pmstat</code> Command</h2></div></div></div><div class="para">
				<a id="ITch04-20" class="indexterm"></a> The <code class="command">pmstat</code> command provides a periodic, one-line summary of system performance. This command is intended to monitor system performance at the highest level, after which other tools may be used for examining subsystems to observe potential performance problems in greater detail. After entering the <code class="command">pmstat</code> command, you see output similar to the following, with successive lines appearing periodically:
			</div><pre class="literallayout"><strong class="userinput"><code>pmstat</code></strong>
@ Thu Aug 15 09:25:56 2013
 loadavg                      memory      swap        io    system         cpu
   1 min   swpd   free   buff  cache   pi   po   bi   bo   in   cs  us  sy  id
    1.29 833960  5614m 144744 265824    0    0    0 1664  13K  23K   6   7  81
    1.51 833956  5607m 144744 265712    0    0    0 1664  13K  24K   5   7  83
    1.55 833956  5595m 145196 271908    0    0  14K 1056  13K  24K   7   7  74</pre><div class="para">
				An additional line of output is added every five seconds. The <code class="literal">-t </code><em class="replaceable">interval</em> option may be used to vary the update interval (i.e. the sampling interval).
			</div><div class="para">
				The output from <code class="command">pmstat</code> is directed to standard output, and the columns in the report are interpreted as follows:
			</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">loadavg</code></span></dt><dd><div class="para">
							The 1-minute load average (runnable processes).
						</div></dd><dt><span class="term"><code class="literal">memory</code></span></dt><dd><div class="para">
							The swpd column indicates average swap space used during the interval (all columns reported in Kbytes unless otherwise indicated). The <code class="literal">free</code> column indicates average free memory during the interval. The <code class="literal">buff</code> column indicates average buffer memory in use during the interval. The <code class="literal">cache</code> column indicates average cached memory in use during the interval.
						</div></dd><dt><span class="term"><code class="literal">swap</code></span></dt><dd><div class="para">
							Reports the average number of pages that are paged-in (<code class="literal">pi</code>) and paged-out (<code class="literal">po</code>) per second during the interval. It is normal for the paged-in values to be non-zero, but the system is suffering memory stress if the paged-out values are non-zero over an extended period.
						</div></dd><dt><span class="term"><code class="literal">io</code></span></dt><dd><div class="para">
							The <code class="literal">bi</code> and <code class="literal">bo</code> columns indicate the average rate per second of block input and block output operations respectfully, during the interval. These rates are independent of the I/O block size. If the values become large, they are reported as thousands of operations per second (K suffix) or millions of operations per second (M suffix).
						</div></dd><dt><span class="term"><code class="literal">system</code></span></dt><dd><div class="para">
							Context switch rate (<code class="literal">cs</code>) and interrupt rate (<code class="literal">in</code>). Rates are expressed as average operations per second during the interval. Note that the interrupt rate is normally at least HZ (the clock interrupt rate, and <code class="literal">kernel.all.hz</code> metric) interrupts per second.
						</div></dd><dt><span class="term"><code class="literal">cpu</code></span></dt><dd><div class="para">
							Percentage of CPU time spent executing user code (<code class="literal">us</code>), system and interrupt code (<code class="literal">sy</code>), idle loop (<code class="literal">id</code>).
						</div></dd></dl></div><div class="para">
				As with most PCP utilities, real-time metric, and archive logs are interchangeable.
			</div><div class="para">
				For example, the following command uses a local system PCP archive log <em class="replaceable">20130731</em> and the timezone of the host (<code class="literal">smash</code>) from which performance metrics in the archive were collected:
			</div><pre class="literallayout"><strong class="userinput"><code>pmstat -a </code></strong><em class="replaceable">${PCP_LOG_DIR}/pmlogger/smash/20130731</em> <strong class="userinput"><code>-t 2hour -A 1hour -z</code></strong>
Note: timezone set to local timezone of host "smash"
@ Wed Jul 31 10:00:00 2013
 loadavg                      memory      swap        io    system         cpu
   1 min   swpd   free   buff  cache   pi   po   bi   bo   in   cs  us  sy  id
    3.90  24648  6234m 239176  2913m    ?    ?    ?    ?    ?    ?   ?   ?   ?
    1.72  24648  5273m 239320  2921m    0    0    4   86  11K  19K   5   5  84
    3.12  24648  5194m 241428  2969m    0    0    0   84  10K  19K   5   5  85
    1.97  24644  4945m 244004  3146m    0    0    0   84  10K  19K   5   5  84
    3.82  24640  4908m 244116  3147m    0    0    0   83  10K  18K   5   5  85
    3.38  24620  4860m 244116  3148m    0    0    0   83  10K  18K   5   4  85
    2.89  24600  4804m 244120  3149m    0    0    0   83  10K  18K   5   4  85
pmFetch: End of PCP archive log</pre><div class="para">
				For complete information on <code class="literal">pmstat</code> usage and command line options, see the <code class="command">pmstat(1)</code> man page.
			</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="Z926977852sdc">
      ⁠</a>4.2. The <code class="command">pmdumptext</code> Command</h2></div></div></div><div class="para">
				<a id="IG31371888172" class="indexterm"></a>The <code class="command">pmdumptext</code> command displays performance metrics in ASCII tables, suitable for export into databases or report generators. It is a flexible command. For example, the following command provides continuous memory statistics on a host named <code class="literal">surf</code>:
			</div><pre class="literallayout"><strong class="userinput"><code>pmdumptext -Ximu -h </code></strong><strong class="userinput"><code>surf</code></strong><strong class="userinput"><code> -f '%H:%M:%S' xfs.buffer</code></strong>
[ 1] xfs.buffer.get
[ 2] xfs.buffer.create
[ 3] xfs.buffer.get_locked
[ 4] xfs.buffer.get_locked_waited
[ 5] xfs.buffer.busy_locked
[ 6] xfs.buffer.miss_locked
[ 7] xfs.buffer.page_retries
[ 8] xfs.buffer.page_found
[ 9] xfs.buffer.get_read

  Column	     1	     2	     3	     4	     5	     6	     7	     8	     9
  Metric	   get	create	locked	waited	locked	locked	etries	_found	t_read
   Units	   c/s	   c/s	   c/s	   c/s	   c/s	   c/s	   c/s	   c/s	   c/s
10:13:23	     ?	     ?	     ?	     ?	     ?	     ?	     ?	     ?	     ?
10:13:24	 0.16K	 9.00 	 0.15K	 5.00 	 0.00 	 0.00 	 0.00 	12.00 	 9.00 
10:13:25	 1.21K	38.00 	 1.17K	15.00 	 0.00 	 0.00 	 0.00 	62.01 	38.00 
10:13:26	 5.80K	 0.12K	 5.69K	41.99 	 0.00 	 0.00 	 0.00 	 0.19K	 0.12K</pre><div class="para">
				See the <code class="command">pmdumptext(1)</code> man page for more information.
			</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE35315-PARENT">
      ⁠</a>4.3. The <code class="command">pmval</code> Command</h2></div></div></div><div class="para">
				<a id="ITch04-23" class="indexterm"></a> The <code class="command">pmval</code> command dumps the current values for the named performance metrics. For example, the following command reports the value of performance metric <code class="literal">proc.nprocs</code> once per second (by default), and produces output similar to this:
			</div><pre class="literallayout"><strong class="userinput"><code>pmval proc.nprocs</code></strong>
metric:    proc.nprocs
host:      localhost
semantics: instantaneous value
units:     none
samples:   all
interval:  1.00 sec
         81
         81
         82
         81</pre><div class="para">
				In this example, the number of running processes was reported once per second.
			</div><div class="para">
				Where the semantics of the underlying performance metrics indicate that it would be sensible, <code class="command">pmval</code> reports the rate of change or resource utilization.
			</div><div class="para">
				For example, the following command reports idle processor utilization for each of four CPUs on the remote host <code class="literal">dove</code>, each five seconds apart, producing output of this form:
			</div><pre class="literallayout"><strong class="userinput"><code>pmval -h dove -t 5sec -s 4 kernel.percpu.cpu.idle</code></strong>
metric:    kernel.percpu.cpu.idle
host:      dove
semantics: cumulative counter (converting to rate)
units:     millisec (converting to time utilization)
samples:   4
interval:  5.00 sec

cpu:1.1.0.a cpu:1.1.0.c cpu:1.1.1.a cpu:1.1.1.c 
     1.000       0.9998      0.9998      1.000  
     1.000       0.9998      0.9998      1.000  
     0.8989      0.9987      0.9997      0.9995 
     0.9568      0.9998      0.9996      1.000
</pre><div class="para">
				Similarly, the following command reports disk I/O read rate every minute for just the disk <code class="literal">/dev/disk1</code>, and produces output similar to the following:
			</div><pre class="literallayout"><strong class="userinput"><code>pmval -t 1min -i disk1 disk.dev.read</code></strong>
metric:    disk.dev.read
host:      localhost
semantics: cumulative counter (converting to rate)
units:     count (converting to count / sec)
samples:   indefinite
interval:  60.00 sec
        disk1 
         33.67 
         48.71 
         52.33 
         11.33 
         2.333</pre><div class="para">
				The <code class="literal">-r</code> flag may be used to suppress the rate calculation (for metrics with counter semantics) and display the raw values of the metrics.
			</div><div class="para">
				In the example below, manipulation of the time within the archive is achieved by the exchange of time control messages between <code class="command">pmval</code> and <code class="command">pmtime</code>.
			</div><pre class="literallayout"><strong class="userinput"><code>pmval -g -a ${PCP_LOG_DIR}/pmlogger/myserver/20130731 kernel.all.load</code></strong></pre><div class="para">
				<a id="IG31371888173" class="indexterm"></a>The <code class="command">pmval</code> command is documented by the <code class="command">pmval(1)</code> man page, and annotated examples of the use of <code class="command">pmval</code> can be found in the <em class="citetitle">PCP Tutorials and Case Studies</em> companion document.
			</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE60452-PARENT">
      ⁠</a>4.4. The <code class="command">pminfo</code> Command</h2></div></div></div><div class="para">
				<a id="ITch04-25" class="indexterm"></a>The <code class="command">pminfo</code> command displays various types of information about performance metrics available through the Performance Co-Pilot (PCP) facilities.
			</div><div class="para">
				The <code class="literal">-T</code> option is extremely useful; it provides help text about performance metrics:
			</div><pre class="literallayout"><strong class="userinput"><code>pminfo -T mem.util.cached</code></strong>
mem.util.cached
Help:
Memory used by the page cache, including buffered file data.
This is in-memory cache for files read from the disk (the pagecache)
but doesn't include SwapCached.</pre><div class="para">
				The <code class="literal">-t</code> option displays the one-line help text associated with the selected metrics. The <code class="literal">-T</code> option prints more verbose help text.
			</div><div class="para">
				Without any options, <code class="command">pminfo</code> verifies that the specified metrics exist in the namespace, and echoes those names. Metrics may be specified as arguments to <code class="command">pminfo</code> using their full metric names. For example, this command returns the following response:
			</div><pre class="literallayout"><strong class="userinput"><code>pminfo hinv.ncpu network.interface.total.bytes</code></strong>
hinv.ncpu 
network.interface.total.bytes</pre><div class="para">
				A group of related metrics in the namespace may also be specified. For example, to list all of the <code class="literal">hinv</code> metrics you would use this command:
			</div><pre class="literallayout"><strong class="userinput"><code>pminfo hinv</code></strong>
hinv.physmem
hinv.pagesize
hinv.ncpu
hinv.ndisk
hinv.nfilesys
hinv.ninterface
hinv.nnode
hinv.machine
hinv.map.scsi
hinv.map.cpu_num
hinv.map.cpu_node
hinv.map.lvname
hinv.cpu.clock
hinv.cpu.vendor
hinv.cpu.model
hinv.cpu.stepping
hinv.cpu.cache
hinv.cpu.bogomips</pre><div class="para">
				If no metrics are specified, <code class="command">pminfo</code> displays the entire collection of metrics. This can be useful for searching for metrics, when only part of the full name is known. For example, this command returns the following response:
			</div><pre class="literallayout"><strong class="userinput"><code>pminfo | grep nfs</code></strong>
nfs.client.calls
nfs.client.reqs
nfs.server.calls
nfs.server.reqs
nfs3.client.calls
nfs3.client.reqs
nfs3.server.calls
nfs3.server.reqs
nfs4.client.calls
nfs4.client.reqs
nfs4.server.calls
nfs4.server.reqs</pre><div class="para">
				The <code class="literal">-d</code> option causes <code class="command">pminfo</code> to display descriptive information about metrics (refer to the <code class="command">pmLookupDesc(3)</code> man page for an explanation of this metadata information). The following command and response show use of the <code class="literal">-d</code> option:
			</div><pre class="literallayout"><strong class="userinput"><code>pminfo -d proc.nprocs disk.dev.read filesys.free</code></strong>
proc.nprocs
    Data Type: 32-bit unsigned int  InDom: PM_INDOM_NULL 0xffffffff
    Semantics: instant  Units: none

disk.dev.read
    Data Type: 32-bit unsigned int  InDom: 60.1 0xf000001
    Semantics: counter  Units: count

filesys.free
    Data Type: 64-bit unsigned int  InDom: 60.5 0xf000005
    Semantics: instant  Units: Kbyte</pre><div class="para">
				The <code class="literal">-f</code> option to <code class="command">pminfo</code> forces the current value of each named metric to be fetched and printed. In the example below, all metrics in the group <code class="literal">hinv</code> are selected:
			</div><pre class="literallayout"><strong class="userinput"><code>pminfo -f hinv</code></strong>
hinv.physmem
    value 15701

hinv.pagesize
    value 16384

hinv.ncpu
    value 4

hinv.ndisk
    value 6

hinv.nfilesys
    value 2

hinv.ninterface
    value 8

hinv.nnode
    value 2

hinv.machine
    value "IP35"

hinv.map.cpu_num
    inst [0 or "cpu:1.1.0.a"] value 0
    inst [1 or "cpu:1.1.0.c"] value 1
    inst [2 or "cpu:1.1.1.a"] value 2
    inst [3 or "cpu:1.1.1.c"] value 3

hinv.map.cpu_node
    inst [0 or "node:1.1.0"] value "/dev/hw/module/001c01/slab/0/node"
    inst [1 or "node:1.1.1"] value "/dev/hw/module/001c01/slab/1/node"

hinv.cpu.clock
    inst [0 or "cpu:1.1.0.a"] value 800
    inst [1 or "cpu:1.1.0.c"] value 800
    inst [2 or "cpu:1.1.1.a"] value 800
    inst [3 or "cpu:1.1.1.c"] value 800

hinv.cpu.vendor
    inst [0 or "cpu:1.1.0.a"] value "GenuineIntel"
    inst [1 or "cpu:1.1.0.c"] value "GenuineIntel"
    inst [2 or "cpu:1.1.1.a"] value "GenuineIntel"
    inst [3 or "cpu:1.1.1.c"] value "GenuineIntel"

hinv.cpu.model
    inst [0 or "cpu:1.1.0.a"] value "0"
    inst [1 or "cpu:1.1.0.c"] value "0"
    inst [2 or "cpu:1.1.1.a"] value "0"
    inst [3 or "cpu:1.1.1.c"] value "0"

hinv.cpu.stepping
    inst [0 or "cpu:1.1.0.a"] value "6"
    inst [1 or "cpu:1.1.0.c"] value "6"
    inst [2 or "cpu:1.1.1.a"] value "6"
    inst [3 or "cpu:1.1.1.c"] value "6"

hinv.cpu.cache
    inst [0 or "cpu:1.1.0.a"] value 0
    inst [1 or "cpu:1.1.0.c"] value 0
    inst [2 or "cpu:1.1.1.a"] value 0
    inst [3 or "cpu:1.1.1.c"] value 0

hinv.cpu.bogomips
    inst [0 or "cpu:1.1.0.a"] value 1195.37
    inst [1 or "cpu:1.1.0.c"] value 1195.37
    inst [2 or "cpu:1.1.1.a"] value 1195.37
    inst [3 or "cpu:1.1.1.c"] value 1195.37</pre><div class="para">
				The <code class="literal">-h</code> option directs <code class="command">pminfo</code> to retrieve information from the specified host. If the metric has an instance domain, the value associated with each instance of the metric is printed:
			</div><pre class="literallayout"><strong class="userinput"><code>pminfo -h dove -f filesys.mountdir</code></strong>
filesys.mountdir
    inst [0 or "/dev/xscsi/pci00.01.0/target81/lun0/part3"] value "/"
    inst [1 or "/dev/xscsi/pci00.01.0/target81/lun0/part1"] value "/boot/efi"</pre><div class="para">
				<a id="IG31371888174" class="indexterm"></a>The <code class="literal">-m</code> option prints the Performance Metric Identifiers (PMIDs) of the selected metrics. This is useful for finding out which PMDA supplies the metric. For example, the output below identifies the PMDA supporting domain 4 (the leftmost part of the PMID) as the one supplying information for the metric <code class="literal">environ.extrema.mintemp</code>:
			</div><pre class="literallayout">pminfo -m environ.extrema.mintemp 
environ.extrema.mintemp PMID: 4.0.3</pre><div class="para">
				The <code class="literal">-v</code> option verifies that metric definitions in the PMNS correspond with supported metrics, and checks that a value is available for the metric. Descriptions and values are fetched, but not printed. Only errors are reported.
			</div><div class="para">
				<a id="IG31371888175" class="indexterm"></a><a id="IG31371888176" class="indexterm"></a>Complete information on the <code class="command">pminfo</code> command is found in the <code class="command">pminfo(1)</code> man page. There are further examples of the use of <code class="command">pminfo</code> in the <em class="citetitle">PCP Tutorials and Case Studies</em>.
			</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE10170-PARENT">
      ⁠</a>4.5. The <code class="command">pmstore</code> Command</h2></div></div></div><div class="para">
				<a id="ITch04-26" class="indexterm"></a>From time to time you may wish to change the value of a particular metric. Some metrics are counters that may need to be reset, and some are simply control variables for agents that collect performance metrics. When you need to change the value of a metric for any reason, the command to use is <code class="command">pmstore</code>.
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					For obvious reasons, the ability to arbitrarily change the value of a performance metric is not supported. Rather, PCP collectors selectively allow some metrics to be modified in a very controlled fashion.
				</div></div></div><div class="para">
				The basic syntax of the command is as follows:
			</div><pre class="literallayout">pmstore <em class="replaceable">metricname</em> <em class="replaceable">value</em> </pre><div class="para">
				There are also command line flags to further specify the action. For example, the <code class="literal">-i</code> option restricts the change to one or more instances of the performance metric.
			</div><div class="para">
				The <em class="replaceable">value</em> may be in one of several forms, according to the following rules:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
						If the metric has an integer type, then <em class="replaceable">value</em> should consist of an optional leading hyphen, followed either by decimal digits or “0x” and some hexadecimal digits; “0X” is also acceptable instead of “0x.”
					</div></li><li class="listitem"><div class="para">
						If the metric has a floating point type, then <em class="replaceable">value</em> should be in the form of an integer (described above), a fixed point number, or a number in scientific notation.
					</div></li><li class="listitem"><div class="para">
						If the metric has a string type, then <em class="replaceable">value</em> is interpreted as a literal string of ASCII characters.
					</div></li><li class="listitem"><div class="para">
						If the metric has an aggregate type, then an attempt is made to interpret <em class="replaceable">value</em> as an integer, a floating point number, or a string. In the first two cases, the minimal word length encoding is used; for example, “123” would be interpreted as a four-byte aggregate, and “0x100000000” would be interpreted as an eight-byte aggregate.
					</div></li></ol></div><div class="para">
				The following example illustrates the use of <code class="command">pmstore</code> to enable performance metrics collection in the <code class="literal">txmon</code> PMDA (see <code class="literal">${PCP_PMDAS_DIR}/txmon</code> for the source code of the txmon PMDA). When the metric <code class="literal">txmon.control.level</code> has the value 0, no performance metrics are collected. Values greater than 0 enable progressively more verbose instrumentation.
			</div><pre class="literallayout"><strong class="userinput"><code>pminfo -f txmon.count</code></strong>
txmon.count
No value(s) available!
<strong class="userinput"><code>pmstore txmon.control.level 1</code></strong>
txmon.control.level old value=0 new value=1
<strong class="userinput"><code>pminfo -f txmon.count</code></strong>
txmon.count
       inst [0 or "ord-entry"] value 23
       inst [1 or "ord-enq"] value 11
       inst [2 or "ord-ship"] value 10
       inst [3 or "part-recv"] value 3
       inst [4 or "part-enq"] value 2
       inst [5 or "part-used"] value 1
       inst [6 or "b-o-m"] value 0</pre><div class="para">
				For complete information on <code class="command">pmstore</code> usage and syntax, see the <code class="command">pmstore(1)</code> man page.
			</div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="LE21414-PARENT">
      ⁠</a>Chapter 5. Performance Metrics Inference Engine</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#LE41170-PARENT">5.1. Introduction to <code class="command">pmie</code></a></span></dt><dt><span class="section"><a href="#LE15993-PARENT">5.2. Basic <code class="command">pmie</code> Usage</a></span></dt><dd><dl><dt><span class="section"><a href="#LE23271-PARENT">5.2.1. <code class="command">pmie</code> use of PCP services</a></span></dt><dt><span class="section"><a href="#id5199666">5.2.2. Simple <code class="command">pmie</code> Usage</a></span></dt><dt><span class="section"><a href="#id5199841">5.2.3. Complex <code class="command">pmie</code> Examples</a></span></dt></dl></dd><dt><span class="section"><a href="#LE90227-PARENT">5.3. Specification Language for <code class="command">pmie</code></a></span></dt><dd><dl><dt><span class="section"><a href="#LE51927-PARENT">5.3.1. Basic <code class="command">pmie</code> Syntax</a></span></dt><dt><span class="section"><a href="#LE88708-PARENT">5.3.2. Setting Evaluation Frequency</a></span></dt><dt><span class="section"><a href="#LE73508-PARENT">5.3.3. <code class="command">pmie</code> Metric Expressions</a></span></dt><dt><span class="section"><a href="#LE59099-PARENT">5.3.4. <code class="command">pmie</code> Rate Conversion</a></span></dt><dt><span class="section"><a href="#id5201567">5.3.5. <code class="command">pmie</code> Arithmetic Expressions</a></span></dt><dt><span class="section"><a href="#id5201630">5.3.6. <code class="command">pmie</code> Logical Expressions</a></span></dt><dt><span class="section"><a href="#id5202519">5.3.7. <code class="command">pmie</code> Rule Expressions</a></span></dt><dt><span class="section"><a href="#LE87294-PARENT">5.3.8. <code class="command">pmie</code> Intrinsic Operators</a></span></dt></dl></dd><dt><span class="section"><a href="#LE60280-PARENT">5.4. <code class="command">pmie</code> Examples</a></span></dt><dt><span class="section"><a href="#LE31514-PARENT">5.5. Developing and Debugging <code class="command">pmie</code> Rules</a></span></dt><dt><span class="section"><a href="#LE91221-PARENT">5.6. Caveats and Notes on <code class="command">pmie</code></a></span></dt><dd><dl><dt><span class="section"><a href="#id5204255">5.6.1. Performance Metrics Wraparound</a></span></dt><dt><span class="section"><a href="#id5204304">5.6.2. <code class="command">pmie</code> Sample Intervals</a></span></dt><dt><span class="section"><a href="#id5204396">5.6.3. <code class="command">pmie</code> Instance Names</a></span></dt><dt><span class="section"><a href="#id5204468">5.6.4. <code class="command">pmie</code> Error Detection</a></span></dt></dl></dd><dt><span class="section"><a href="#Z927039566sdc">5.7. Creating <code class="command">pmie</code> Rules with <code class="command">pmieconf</code></a></span></dt><dt><span class="section"><a href="#Z927039824sdc">5.8. Management of <code class="command">pmie</code> Processes</a></span></dt><dd><dl><dt><span class="section"><a href="#id5208584">5.8.1. Add a <code class="command">pmie</code> <code class="command">crontab</code> Entry</a></span></dt><dt><span class="section"><a href="#id5205585">5.8.2. Global Files and Directories</a></span></dt><dt><span class="section"><a href="#id5205812">5.8.3. <code class="command">pmie</code> Instances and Their Progress</a></span></dt></dl></dd></dl></div><div class="para">
			<a id="ITch06-0" class="indexterm"></a><a id="ITch06-1" class="indexterm"></a><a id="ITch06-2" class="indexterm"></a>The Performance Metrics Inference Engine (<code class="command">pmie</code>) is a tool that provides automated monitoring of, and reasoning about, system performance within the Performance Co-Pilot (PCP) framework.
		</div><div class="para">
			The major sections in this chapter are as follows:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					<a class="xref" href="#LE41170-PARENT">Section 5.1, “Introduction to <code class="command">pmie</code>”</a>, provides an introduction to the concepts and design of <code class="command">pmie</code>.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE15993-PARENT">Section 5.2, “Basic <code class="command">pmie</code> Usage”</a>, describes the basic syntax and usage of <code class="command">pmie</code>.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE90227-PARENT">Section 5.3, “Specification Language for <code class="command">pmie</code>”</a>, discusses the complete <code class="command">pmie</code> rule specification language.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE60280-PARENT">Section 5.4, “<code class="command">pmie</code> Examples”</a>, provides an example, covering several common performance scenarios.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE31514-PARENT">Section 5.5, “Developing and Debugging <code class="command">pmie</code> Rules”</a>, presents some tips and techniques for <code class="command">pmie</code> rule development.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE91221-PARENT">Section 5.6, “Caveats and Notes on <code class="command">pmie</code>”</a>, presents some important information on using <code class="command">pmie</code>.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#Z927039566sdc">Section 5.7, “Creating <code class="command">pmie</code> Rules with <code class="command">pmieconf</code>”</a>, describes how to use the <code class="command">pmieconf</code> command to generate <code class="command">pmie</code> rules.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#Z927039824sdc">Section 5.8, “Management of <code class="command">pmie</code> Processes”</a>, provides support for running <code class="command">pmie</code> as a daemon.
				</div></li></ul></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE41170-PARENT">
      ⁠</a>5.1. Introduction to <code class="command">pmie</code></h2></div></div></div><div class="para">
				<a id="ITch06-4" class="indexterm"></a>Automated reasoning within Performance Co-Pilot (PCP) is provided by the Performance Metrics Inference Engine, (<code class="command">pmie</code>), which is an applied artificial intelligence application.
			</div><div class="para">
				The <code class="command">pmie</code> tool accepts expressions describing adverse performance scenarios, and periodically evaluates these against streams of performance metric values from one or more sources. When an expression is found to be true, <code class="command">pmie</code> is able to execute arbitrary actions to alert or notify the system administrator of the occurrence of an adverse performance scenario. These facilities are very general, and are designed to accommodate the automated execution of a mixture of generic and site-specific performance monitoring and control functions.
			</div><div class="para">
				The stream of performance metrics to be evaluated may be from one or more hosts, or from one or more PCP archive logs. In the latter case, <code class="command">pmie</code> may be used to retrospectively identify adverse performance conditions.
			</div><div class="para">
				<a id="IG31371888177" class="indexterm"></a><a id="IG31371888178" class="indexterm"></a>Using <code class="command">pmie</code>, you can filter, interpret, and reason about the large volume of performance data made available from PCP collector systems or PCP archives.
			</div><div class="para">
				Typical <code class="command">pmie</code> uses include the following:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						Automated real-time monitoring of a host, a set of hosts, or client-server pairs of hosts to raise operational alarms when poor performance is detected in a production environment
					</div></li><li class="listitem"><div class="para">
						Nightly processing of archive logs to detect and report performance regressions, or quantify quality of service for service level agreements or management reports, or produce advance warning of pending performance problems
					</div></li><li class="listitem"><div class="para">
						Strategic performance management, for example, detection of slightly abnormal to chronic system behavior, trend analysis, and capacity planning
					</div></li></ul></div><div class="para">
				<a id="IG31371888179" class="indexterm"></a>The <code class="command">pmie</code> expressions are described in a language with expressive power and operational flexibility. It includes the following operators and functions:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						Generalized predicate-action pairs, where a predicate is a logical expression over the available performance metrics, and the action is arbitrary. Predefined actions include the following:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<a id="IG31371888180" class="indexterm"></a>Launch a visible alarm with <code class="literal">pmconfirm</code>; see the <code class="command">pmconfirm(1)</code> man page.
							</div></li><li class="listitem"><div class="para">
								<a id="IG31371888181" class="indexterm"></a><a id="IG31371888182" class="indexterm"></a>Post an entry to the system log file; see the <code class="command">syslog(3)</code> man page.
							</div></li><li class="listitem"><div class="para">
								<a id="IG31371888183" class="indexterm"></a>Post an entry to the PCP noticeboard file <code class="filename">${PCP_LOG_DIR}/NOTICES</code>; see the <code class="command">pmpost(1)</code> man page.
							</div></li><li class="listitem"><div class="para">
								Execute a shell command or script, for example, to send e-mail, initiate a pager call, warn the help desk, and so on.
							</div></li><li class="listitem"><div class="para">
								Echo a message on standard output; useful for scripts that generate reports from retrospective processing of PCP archive logs.
							</div></li></ul></div></li><li class="listitem"><div class="para">
						Arithmetic and logical expressions in a C-like syntax.
					</div></li><li class="listitem"><div class="para">
						Expression groups may have an independent evaluation frequency, to support both short-term and long-term monitoring.
					</div></li><li class="listitem"><div class="para">
						Canonical scale and rate conversion of performance metric values to provide sensible expression evaluation.
					</div></li><li class="listitem"><div class="para">
						Aggregation functions of <code class="literal">sum</code>, <code class="literal">avg</code>, <code class="literal">min</code>, and <code class="literal">max</code>, that may be applied to collections of performance metrics values clustered over multiple hosts, or multiple instances, or multiple consecutive samples in time.
					</div></li><li class="listitem"><div class="para">
						Universal and existential quantification, to handle expressions of the form “for every....” and “at least one...”.
					</div></li><li class="listitem"><div class="para">
						Percentile aggregation to handle statistical outliers, such as “for at least 80% of the last 20 samples, ...”.
					</div></li><li class="listitem"><div class="para">
						Macro processing to expedite repeated use of common subexpressions or specification components.
					</div></li><li class="listitem"><div class="para">
						Transparent operation against either live-feeds of performance metric values from PMCD on one or more hosts, or against PCP archive logs of previously accumulated performance metric values.
					</div></li></ul></div><div class="para">
				The power of <code class="command">pmie</code> may be harnessed to automate the most common of the deterministic system management functions that are responses to changes in system performance. For example, disable a batch stream if the DBMS transaction commit response time at the ninetieth percentile goes over two seconds, or stop accepting uploads and send e-mail to the <em class="replaceable">sysadmin</em> alias if free space in a storage system falls below five percent.
			</div><div class="para">
				Moreover, the power of <code class="command">pmie</code> can be directed towards the exceptional and sporadic performance problems. For example, if a network packet storm is expected, enable IP header tracing for ten seconds, and send e-mail to advise that data has been collected and is awaiting analysis. Or, if production batch throughput falls below 50 jobs per minute, activate a pager to the systems administrator on duty.
			</div><div class="para">
				<a id="IG31371888184" class="indexterm"></a><a id="IG31371888185" class="indexterm"></a>Obviously, <code class="command">pmie</code> customization is required to produce meaningful filtering and actions in each production environment. The <code class="command">pmieconf</code> tool provides a convenient customization method, allowing the user to generate parameterized <code class="command">pmie</code> rules for some of the more common performance scenarios.
			</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE15993-PARENT">
      ⁠</a>5.2. Basic <code class="command">pmie</code> Usage</h2></div></div></div><div class="para">
				<a id="IG31371888186" class="indexterm"></a>This section presents and explains some basic examples of <code class="command">pmie</code> usage. The <code class="command">pmie</code> tool accepts the common PCP command line arguments, as described in <a class="xref" href="#LE94335-PARENT">Chapter 3, <em>Common Conventions and Arguments</em></a>. In addition, <code class="command">pmie</code> accepts the following command line arguments:
			</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">-d</code></span></dt><dd><div class="para">
							Enables interactive debug mode.
						</div></dd><dt><span class="term"><code class="literal">-v</code></span></dt><dd><div class="para">
							Verbose mode: expression values are displayed.
						</div></dd><dt><span class="term"><code class="literal">-V</code></span></dt><dd><div class="para">
							Verbose mode: annotated expression values are displayed.
						</div></dd><dt><span class="term"><code class="literal">-W</code></span></dt><dd><div class="para">
							When-verbose mode: when a condition is true, the satisfying expression bindings are displayed.
						</div></dd></dl></div><div class="para">
				One of the most basic invocations of this tool is this form:
			</div><pre class="literallayout"><strong class="userinput"><code>pmie</code></strong> <em class="replaceable">filename</em></pre><div class="para">
				In this form, the expressions to be evaluated are read from <em class="replaceable">filename</em>. In the absence of a given <em class="replaceable">filename</em>, expressions are read from standard input, which may be your system keyboard.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE23271-PARENT">
      ⁠</a>5.2.1. <code class="command">pmie</code> use of PCP services</h3></div></div></div><div class="para">
					<a id="ITch06-7" class="indexterm"></a>Before you use <code class="command">pmie</code>, it is strongly recommended that you familiarize yourself with the concepts from the <a class="xref" href="#LE79836-PARENT">Section 1.2, “Conceptual Foundations”</a>. The discussion in this section serves as a very brief review of these concepts.
				</div><div class="para">
					<a id="IG31371888187" class="indexterm"></a>PCP makes available thousands of performance metrics that you can use when formulating expressions for <code class="command">pmie</code> to evaluate. If you want to find out which metrics are currently available on your system, use this command:
				</div><pre class="literallayout"><strong class="userinput"><code>pminfo</code></strong> </pre><div class="para">
					Use the <code class="command">pmie</code> command line arguments to find out more about a particular metric. In <a class="xref" href="#Z983825969sdc">Example 5.1, “<code class="command">pmie</code> with the <code class="literal">-f</code> Option”</a>, to fetch new metric values from host <code class="literal">dove</code>, you use the <code class="literal">-f</code> flag:
				</div><div class="example"><a id="Z983825969sdc">
      ⁠</a><p class="title"><strong>Example 5.1. <code class="command">pmie</code> with the <code class="literal">-f</code> Option</strong></p><div class="example-contents"><pre class="literallayout"><strong class="userinput"><code>pminfo -f -h dove disk.dev.total</code></strong></pre><div class="para">
						This produces the following response:
					</div><pre class="literallayout">disk.dev.total
    inst [0 or "xscsi/pci00.01.0/target81/lun0/disc"] value 131233
    inst [4 or "xscsi/pci00.01.0/target82/lun0/disc"] value 4
    inst [8 or "xscsi/pci00.01.0/target83/lun0/disc"] value 4
    inst [12 or "xscsi/pci00.01.0/target84/lun0/disc"] value 4
    inst [16 or "xscsi/pci00.01.0/target85/lun0/disc"] value 4
    inst [18 or "xscsi/pci00.01.0/target86/lun0/disc"] value 4</pre></div></div><div class="para">
					This reveals that on the host <code class="literal">dove</code>, the metric <code class="literal">disk.dev.total</code> has six instances, one for each disk on the system.
				</div><div class="para">
					Use the following command to request help text (specified with the <code class="literal">-T</code> flag) to provide more information about performance metrics:
				</div><pre class="literallayout"><strong class="userinput"><code>pminfo -T network.interface.in.packets</code></strong></pre><div class="para">
					The metadata associated with a performance metric is used by <code class="command">pmie</code> to determine how the value should be interpreted. You can examine the descriptor that encodes the metadata by using the <code class="literal">-d</code> flag for <code class="command">pminfo</code>, as shown in <a class="xref" href="#Z983826092sdc">Example 5.2, “<code class="command">pmie</code> with the <code class="literal">-d</code> and <code class="literal">-h</code> Options”</a>:
				</div><div class="example"><a id="Z983826092sdc">
      ⁠</a><p class="title"><strong>Example 5.2. <code class="command">pmie</code> with the <code class="literal">-d</code> and <code class="literal">-h</code> Options</strong></p><div class="example-contents"><pre class="literallayout"><strong class="userinput"><code>pminfo -d -h </code></strong><em class="replaceable">somehost </em><strong class="userinput"><code>mem.util.cached kernel.percpu.cpu.user</code></strong></pre><div class="para">
						In response, you see output similar to this:
					</div><pre class="literallayout">mem.util.cached
    Data Type: 64-bit unsigned int  InDom: PM_INDOM_NULL 0xffffffff
    Semantics: instant  Units: Kbyte

kernel.percpu.cpu.user
    Data Type: 64-bit unsigned int  InDom: 60.0 0xf000000
    Semantics: counter  Units: millisec</pre></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						<a id="ITch06-8" class="indexterm"></a>A cumulative counter such as <code class="literal">kernel.percpu.cpu.user</code> is automatically converted by <code class="command">pmie</code> into a rate (measured in events per second, or count/second), while instantaneous values such as <code class="literal">mem.util.cached</code> are not subjected to rate conversion. Metrics with an instance domain (<code class="literal">InDom</code> in the <code class="command">pminfo</code> output) of <code class="literal">PM_INDOM_NULL</code> are singular and always produce one value per source. However, a metric like <code class="literal">kernel.percpu.cpu.user</code> has an instance domain, and may produce multiple values per source (in this case, it is one value for each configured CPU).
					</div></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5199666">
      ⁠</a>5.2.2. Simple <code class="command">pmie</code> Usage</h3></div></div></div><div class="para">
					<a id="ITch06-9" class="indexterm"></a><a class="xref" href="#Z983823607sdc">Example 5.3, “<code class="command">pmie</code> with the <code class="literal">-v</code> Option”</a> directs the inference engine to evaluate and print values (specified with the <code class="literal">-v</code> flag) for a single performance metric (the simplest possible expression), in this case <code class="literal">disk.dev.total</code>, collected from the local PMCD:
				</div><div class="example"><a id="Z983823607sdc">
      ⁠</a><p class="title"><strong>Example 5.3. <code class="command">pmie</code> with the <code class="literal">-v</code> Option</strong></p><div class="example-contents"><pre class="literallayout"><strong class="userinput"><code>pmie -v</code></strong>
<strong class="userinput"><code>iops = disk.dev.total;</code></strong>
<strong class="userinput"><code>Ctrl+D</code></strong>
iops:      ?      ?
iops:   14.4      0
iops:   25.9  0.112
iops:   12.2      0
iops:   12.3   64.1
iops:  8.594  52.17
iops:  2.001  71.64</pre></div></div><div class="para">
					On this system, there are two disk spindles, hence two values of the expression <code class="command">iops</code> per sample. Notice that the values for the first sample are unknown (represented by the question marks [?] in the first line of output), because rates can be computed only when at least two samples are available. The subsequent samples are produced every ten seconds by default. The second sample reports that during the preceding ten seconds there was an average of 14.4 transfers per second on one disk and no transfers on the other disk.
				</div><div class="para">
					Rates are computed using time stamps delivered by PMCD. Due to unavoidable inaccuracy in the actual sampling time (the sample interval is not exactly 10 seconds), you may see more decimal places in values than you expect. Notice, however, that these errors do not accumulate but cancel each other out over subsequent samples.
				</div><div class="para">
					In <a class="xref" href="#Z983823607sdc">Example 5.3, “<code class="command">pmie</code> with the <code class="literal">-v</code> Option”</a>, the expression to be evaluated was entered using the keyboard, followed by the end-of-file character [<span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>D</strong></span>]. Usually, it is more convenient to enter expressions into a file (for example, <code class="filename">myrules</code>) and ask <code class="command">pmie</code> to read the file. Use this command syntax:
				</div><pre class="literallayout"><strong class="userinput"><code>pmie -v myrules</code></strong> </pre><div class="para">
					Please refer to the <code class="command">pmie(1)</code> man page for a complete description of <code class="command">pmie</code> command line options.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5199841">
      ⁠</a>5.2.3. Complex <code class="command">pmie</code> Examples</h3></div></div></div><div class="para">
					<a id="ITch06-10" class="indexterm"></a>This section illustrates more complex <code class="command">pmie</code> expressions of the specification language. <a class="xref" href="#LE90227-PARENT">Section 5.3, “Specification Language for <code class="command">pmie</code>”</a>, provides a complete description of the <code class="command">pmie</code> specification language.
				</div><div class="para">
					The following arithmetic expression computes the percentage of write operations over the total number of disk transfers.
				</div><pre class="literallayout">(disk.all.write / disk.all.total) * 100;</pre><div class="para">
					The <code class="literal">disk.all</code> metrics are singular, so this expression produces exactly one value per sample, independent of the number of disk devices.
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						If there is no disk activity,<code class="literal"> disk.all.total</code> will be zero and <code class="command">pmie</code> evaluates this expression to be not a number. When <code class="literal">-v</code> is used, any such values are displayed as question marks.
					</div></div></div><div class="para">
					The following logical expression has the value <code class="literal">true</code> or <code class="literal">false</code> for each disk:
				</div><pre class="literallayout">disk.dev.total &gt; 10 &amp;&amp; 
disk.dev.write &gt; disk.dev.read;</pre><div class="para">
					The value is true if the number of writes exceeds the number of reads, and if there is significant disk activity (more than 10 transfers per second). <a class="xref" href="#Z983824038sdc">Example 5.4, “Printed <code class="command">pmie</code> Output”</a> demonstrates a simple action:
				</div><div class="example"><a id="Z983824038sdc">
      ⁠</a><p class="title"><strong>Example 5.4. Printed <code class="command">pmie</code> Output</strong></p><div class="example-contents"><pre class="literallayout">some_inst disk.dev.total &gt; 60
           -&gt; print "[%i] high disk i/o";
</pre></div></div><div class="para">
					This prints a message to the standard output whenever the total number of transfers for some disk (<code class="literal">some_inst</code>) exceeds 60 transfers per second. The <code class="literal">%i</code> (instance) in the message is replaced with the name(s) of the disk(s) that caused the logical expression to be <code class="literal">true</code>.
				</div><div class="para">
					Using <code class="command">pmie</code> to evaluate the above expressions every 3 seconds, you see output similar to <a class="xref" href="#Z983824037sdc">Example 5.5, “Labelled <code class="command">pmie</code> Output”</a>. Notice the introduction of labels for each <code class="command">pmie</code> expression.
				</div><div class="example"><a id="Z983824037sdc">
      ⁠</a><p class="title"><strong>Example 5.5. Labelled <code class="command">pmie</code> Output</strong></p><div class="example-contents"><pre class="literallayout"><strong class="userinput"><code>pmie -v -t 3sec</code></strong>
<strong class="userinput"><code>pct_wrt = (disk.all.write / disk.all.total) * 100;</code></strong>
<strong class="userinput"><code>busy_wrt = disk.dev.total &gt; 10 &amp;&amp;</code></strong>
           <strong class="userinput"><code>disk.dev.write &gt; disk.dev.read;</code></strong>
<strong class="userinput"><code>busy = some_inst disk.dev.total &gt; 60</code></strong>
           <strong class="userinput"><code>-&gt; print "[%i] high disk i/o ";</code></strong>
<strong class="userinput"><code>Ctrl+D</code></strong>
pct_wrt:       ? 
busy_wrt:      ?      ?
busy:          ?

pct_wrt:   18.43
busy_wrt:  false  false
busy:      false

Mon Aug  5 14:56:08 2012: [disk2] high disk i/o
pct_wrt:   10.83
busy_wrt:  false  false
busy:      true

pct_wrt:   19.85
busy_wrt:   true  false
busy:      false

pct_wrt:       ?
busy_wrt:  false  false
busy:      false

Mon Aug  5 14:56:17 2012: [disk1] high disk i/o [disk2] high disk i/o
pct_wrt:   14.8
busy_wrt:  false  false
busy:   true</pre></div></div><div class="para">
					The first sample contains unknowns, since all expressions depend on computing rates. Also notice that the expression <code class="literal">pct_wrt</code> may have an undefined value whenever all disks are idle, as the denominator of the expression is zero. If one or more disks is busy, the expression <code class="literal">busy</code> is true, and the message from the <code class="literal">print</code> in the action part of the rule appears (before the <code class="literal">-v</code> values).
				</div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE90227-PARENT">
      ⁠</a>5.3. Specification Language for <code class="command">pmie</code></h2></div></div></div><div class="para">
				<a id="IG31371888188" class="indexterm"></a>This section describes the complete syntax of the <code class="command">pmie</code> specification language, as well as macro facilities and the issue of sampling and evaluation frequency. The reader with a preference for learning by example may choose to skip this section and go straight to the examples in <a class="xref" href="#LE60280-PARENT">Section 5.4, “<code class="command">pmie</code> Examples”</a>.
			</div><div class="para">
				Complex expressions are built up recursively from simple elements:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
						Performance metric values are obtained from PMCD for real-time sources, otherwise from PCP archive logs.
					</div></li><li class="listitem"><div class="para">
						Metrics values may be combined using arithmetic operators to produce arithmetic expressions.
					</div></li><li class="listitem"><div class="para">
						Arithmetic expressions may be compared using relational operators to produce logical expressions.
					</div></li><li class="listitem"><div class="para">
						Logical expressions may be combined using Boolean operators, including powerful quantifiers.
					</div></li><li class="listitem"><div class="para">
						Aggregation operators may be used to compute summary expressions, for either arithmetic or logical operands.
					</div></li><li class="listitem"><div class="para">
						The final logical expression may be used to initiate a sequence of actions.
					</div></li></ol></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE51927-PARENT">
      ⁠</a>5.3.1. Basic <code class="command">pmie</code> Syntax</h3></div></div></div><div class="para">
					<a id="ITch06-11" class="indexterm"></a>The <code class="command">pmie</code> rule specification language supports a number of basic syntactic elements.
				</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5200293">
      ⁠</a>5.3.1.1. Lexical Elements</h4></div></div></div><div class="para">
						<a id="IG31371888189" class="indexterm"></a>All <code class="command">pmie</code> expressions are composed of the following lexical elements:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Identifier</span></dt><dd><div class="para">
									Begins with an alphabetic character (either upper or lowercase), followed by zero or more letters, the numeric digits, and the special characters period (<code class="literal">.</code>) and underscore (<code class="literal">_</code>), as shown in the following example:
<pre class="literallayout"><code class="literal">x</code>, <code class="literal">disk.dev.total</code> and <code class="literal">my_stuff</code></pre>
								</div><div class="para">
									As a special case, an arbitrary sequence of letters enclosed by apostrophes (<code class="literal">'</code>) is also interpreted as an <em class="replaceable">identifier</em>; for example:
<pre class="literallayout">'vms$slow_response'</pre>
								</div></dd><dt><span class="term">Keyword</span></dt><dd><div class="para">
									The aggregate operators, units, and predefined actions are represented by keywords; for example, <code class="literal">some_inst</code>, <code class="literal">print</code>, and <code class="literal">hour</code>.
								</div></dd><dt><span class="term">Numeric constant</span></dt><dd><div class="para">
									Any likely representation of a decimal integer or floating point number; for example, 124, 0.05, and -45.67
								</div></dd><dt><span class="term">String constant</span></dt><dd><div class="para">
									An arbitrary sequence of characters, enclosed by double quotation marks (<code class="literal">"x"</code>).
								</div></dd></dl></div><div class="para">
						Within quotes of any sort, the backslash (<code class="literal">\</code>) may be used as an escape character as shown in the following example:
					</div><pre class="literallayout">"A \"gentle\" reminder"</pre></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5200461">
      ⁠</a>5.3.1.2. Comments </h4></div></div></div><div class="para">
						<a id="IG31371888190" class="indexterm"></a>Comments may be embedded anywhere in the source, in either of these forms:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">/* text */</code></span></dt><dd><div class="para">
									Comment, optionally spanning multiple lines, with no nesting of comments.
								</div></dd><dt><span class="term"><code class="literal">// text</code></span></dt><dd><div class="para">
									Comment from here to the end of the line.
								</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5200514">
      ⁠</a>5.3.1.3. Macros</h4></div></div></div><div class="para">
						<a id="IG31371888191" class="indexterm"></a>When they are fully specified, expressions in <code class="command">pmie</code> tend to be verbose and repetitive. The use of macros can reduce repetition and improve readability and modularity. Any statement of the following form associates the macro name <code class="literal">identifier</code> with the given string constant.
					</div><pre class="literallayout"><code class="literal">identifier = "<em class="replaceable">string</em>";</code></pre><div class="para">
						Any subsequent occurrence of the macro name <code class="literal">identifier</code> is replaced by the <em class="replaceable">string</em> most recently associated with a macro definition for <code class="literal">identifier</code>.
					</div><pre class="literallayout"><strong class="userinput"><code>$</code></strong><code class="literal">identifier</code> </pre><div class="para">
						For example, start with the following macro definition:
					</div><pre class="literallayout">disk = "disk.all";</pre><div class="para">
						You can then use the following syntax:
					</div><pre class="literallayout">pct_wrt = ($disk.write / $disk.total) * 100;</pre><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							Macro expansion is performed before syntactic parsing; so macros may only be assigned constant string values.
						</div></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5200653">
      ⁠</a>5.3.1.4. Units</h4></div></div></div><div class="para">
						<a id="IG31371888192" class="indexterm"></a>The inference engine converts all numeric values to canonical units (seconds for time, bytes for space, and events for count). To avoid surprises, you are encouraged to specify the units for numeric constants. If units are specified, they are checked for dimension compatibility against the metadata for the associated performance metrics.
					</div><div class="para">
						The syntax for a <code class="literal">units</code> specification is a sequence of one or more of the following keywords separated by either a space or a slash (<code class="literal">/</code>), to denote per: <code class="literal">byte</code>, <code class="literal">KByte</code>, <code class="literal">MByte</code>, <code class="literal">GByte</code>, <code class="literal">TByte</code>, <code class="literal">nsec</code>, <code class="literal">nanosecond</code>, <code class="literal">usec</code>, <code class="literal">microsecond</code>, <code class="literal">msec</code>, <code class="literal">millisecond</code>, <code class="literal">sec</code>, <code class="literal">second</code>, <code class="literal">min</code>, <code class="literal">minute</code>, <code class="literal">hour</code>, <code class="literal">count</code>, <code class="literal">Kcount</code>, <code class="literal">Mcount</code>, <code class="literal">Gcount</code>, or <code class="literal">Tcount</code>. Plural forms are also accepted.
					</div><div class="para">
						The following are examples of units usage:
					</div><pre class="literallayout">disk.dev.blktotal &gt; 1 Mbyte / second; 
mem.util.cached &lt; 500 Kbyte;</pre><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							If you do not specify the units for numeric constants, it is assumed that the constant is in the canonical units of seconds for time, bytes for space, and events for count, and the dimensionality of the constant is assumed to be correct. Thus, in the following expression, the <code class="literal">500</code> is interpreted as 500 bytes.
						</div><pre class="literallayout">mem.util.cached &lt; 500</pre></div></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE88708-PARENT">
      ⁠</a>5.3.2. Setting Evaluation Frequency</h3></div></div></div><div class="para">
					<a id="ITch06-12" class="indexterm"></a><a id="IG31371888193" class="indexterm"></a>The identifier name <code class="literal">delta</code> is reserved to denote the interval of time between consecutive evaluations of one or more expressions. Set <code class="literal">delta</code> as follows:
				</div><pre class="literallayout">delta = <em class="replaceable">number</em> [<em class="replaceable">units</em>];</pre><div class="para">
					If present, <code class="literal">units</code> must be one of the time units described in the preceding section. If absent, <code class="literal">units</code> are assumed to be <code class="literal">seconds</code>. For example, the following expression has the effect that any subsequent expressions (up to the next expression that assigns a value to <code class="literal">delta</code>) are scheduled for evaluation at a fixed frequency, once every five minutes.
				</div><pre class="literallayout">delta = 5 min;</pre><div class="para">
					The default value for <code class="literal">delta</code> may be specified using the <code class="literal">-t</code> command line option; otherwise <code class="literal">delta</code> is initially set to be 10 seconds.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE73508-PARENT">
      ⁠</a>5.3.3. <code class="command">pmie</code> Metric Expressions</h3></div></div></div><div class="para">
					<a id="ITch06-13" class="indexterm"></a><a id="IG31371888194" class="indexterm"></a><a id="IG31371888196" class="indexterm"></a>The performance metrics namespace (PMNS) provides a means of naming performance metrics, for example, <code class="literal">disk.dev.read</code>. PCP allows an application to retrieve one or more values for a performance metric from a designated source (a collector host running PMCD, or a set of PCP archive logs). To specify a single value for some performance metric requires the metric name to be associated with all three of the following:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							A particular host (or source of metrics values)
						</div></li><li class="listitem"><div class="para">
							A particular instance (for metrics with multiple values)
						</div></li><li class="listitem"><div class="para">
							A sample time
						</div></li></ul></div><div class="para">
					The permissible values for hosts are the range of valid hostnames as provided by Internet naming conventions.
				</div><div class="para">
					<a id="IG31371888197" class="indexterm"></a>The names for instances are provided by the Performance Metrics Domain Agents (PMDA) for the instance domain associated with the chosen performance metric.
				</div><div class="para">
					The sample time specification is defined as the set of natural numbers 0, 1, 2, and so on. A number refers to one of a sequence of sampling events, from the current sample 0 to its predecessor 1, whose predecessor was 2, and so on. This scheme is illustrated by the time line shown in <a class="xref" href="#id5201070">Figure 5.1, “Sampling Time Line”</a>.
				</div><div class="figure"><a id="id5201070">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/sampling-timeline.svg" type="image/svg+xml"><img src="images/sampling-timeline.png" alt="Sampling Time Line" /></object></div></div><p class="title"><strong>Figure 5.1. Sampling Time Line</strong></p></div><div class="para">
					Each sample point is assumed to be separated from its predecessor by a constant amount of real time, the <code class="literal">delta</code>. The most recent sample point is always zero. The value of <code class="literal">delta</code> may vary from one expression to the next, but is fixed for each expression; for more information on the sampling interval, see <a class="xref" href="#LE88708-PARENT">Section 5.3.2, “Setting Evaluation Frequency”</a>.
				</div><div class="para">
					For <code class="command">pmie</code>, a metrics expression is the name of a metric, optionally qualified by a host, instance and sample time specification. Special characters introduce the qualifiers: colon (<code class="literal">:</code>) for hosts, hash or pound sign (<code class="literal">#</code>) for instances, and at (<code class="literal">@</code>) for sample times. The following expression refers to the previous value (<code class="literal">@1</code>) of the counter for the disk read operations associated with the disk instance <code class="literal">#disk1</code> on the host <code class="literal">moomba</code>.
				</div><pre class="literallayout">disk.dev.read :moomba #disk1 @1</pre><div class="para">
					In fact, this expression defines a point in the three-dimensional (3D) parameter space of {<code class="literal">host</code>} x {<code class="literal">instance</code>} x {<code class="literal">sample time</code>} as shown in <a class="xref" href="#id5201194">Figure 5.2, “Three-Dimensional Parameter Space”</a>.
				</div><div class="figure"><a id="id5201194">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/parameter-space.svg" type="image/svg+xml"><img src="images/parameter-space.png" alt="Three-Dimensional Parameter Space" /></object></div></div><p class="title"><strong>Figure 5.2. Three-Dimensional Parameter Space</strong></p></div><div class="para">
					A metric expression may also identify sets of values corresponding to one-, two-, or three-dimensional slices of this space, according to the following rules:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
							A metric expression consists of a PCP metric name, followed by optional host specifications, followed by optional instance specifications, and finally, optional sample time specifications.
						</div></li><li class="listitem"><div class="para">
							A host specification consists of one or more host names, each prefixed by a colon (<code class="literal">:</code>). For example: <code class="literal">:indy :far.away.domain.com :localhost</code>
						</div></li><li class="listitem"><div class="para">
							A missing host specification implies the default <code class="command">pmie</code> source of metrics, as defined by a <code class="literal">-h</code> option on the command line, or the first named archive in an <code class="literal">-a</code> option on the command line, or PMCD on the local host.
						</div></li><li class="listitem"><div class="para">
							An instance specification consists of one or more instance names, each prefixed by a hash or pound (<code class="literal">#</code>) sign. For example: <code class="literal">#eth0 #eth2</code>
						</div><div class="para">
							Recall that you can discover the instance names for a particular metric, using the <code class="command">pminfo</code> command. See <a class="xref" href="#LE23271-PARENT">Section 5.2.1, “<code class="command">pmie</code> use of PCP services”</a>.
						</div><div class="para">
							Within the <code class="command">pmie</code> grammar, an instance name is an identifier. If the instance name contains characters other than alphanumeric characters, enclose the instance name in single quotes; for example, <code class="literal">#'/boot' #'/usr'</code>
						</div></li><li class="listitem"><div class="para">
							A missing instance specification implies all instances for the associated performance metric from each associated <code class="command">pmie</code> source of metrics.
						</div></li><li class="listitem"><div class="para">
							A sample time specification consists of either a single time or a range of times. A single time is represented as an at (<code class="literal">@</code>) followed by a natural number. A range of times is an at (<code class="literal">@</code>), followed by a natural number, followed by two periods (<code class="literal">..</code>) followed by a second natural number. The ordering of the end points in a range is immaterial. For example, <code class="literal">@0..9</code> specifies the last 10 sample times.
						</div></li><li class="listitem"><div class="para">
							A missing sample time specification implies the most recent sample time.
						</div></li></ol></div><div class="para">
					The following metric expression refers to a three-dimensional set of values, with two hosts in one dimension, five sample times in another, and the number of instances in the third dimension being determined by the number of configured disk spindles on the two hosts.
				</div><pre class="literallayout">disk.dev.read :foo :bar @0..4</pre></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE59099-PARENT">
      ⁠</a>5.3.4. <code class="command">pmie</code> Rate Conversion</h3></div></div></div><div class="para">
					<a id="ITch06-14" class="indexterm"></a><a id="IG31371888198" class="indexterm"></a>Many of the metrics delivered by PCP are cumulative counters. Consider the following metric:
				</div><pre class="literallayout">disk.all.total</pre><div class="para">
					A single value for this metric tells you only that a certain number of disk I/O operations have occurred since boot time, and that information may be invalid if the counter has exceeded its 32-bit range and wrapped. You need at least two values, sampled at known times, to compute the recent rate at which the I/O operations are being executed. The required syntax would be this:
				</div><pre class="literallayout">(disk.all.total @0 - disk.all.total @1) / delta</pre><div class="para">
					The accuracy of <code class="literal">delta</code> as a measure of actual inter-sample delay is an issue. <code class="command">pmie</code> requests samples, at intervals of approximately <code class="literal">delta</code>, while the results exported from PMCD are time stamped with the high-resolution system clock time when the samples were extracted. For these reasons, a built-in and implicit rate conversion using accurate time stamps is provided by <code class="command">pmie</code> for performance metrics that have counter semantics. For example, the following expression is unconditionally converted to a rate by <code class="command">pmie</code>.
				</div><pre class="literallayout">disk.all.total</pre></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5201567">
      ⁠</a>5.3.5. <code class="command">pmie</code> Arithmetic Expressions</h3></div></div></div><div class="para">
					<a id="ITch06-15" class="indexterm"></a><a id="IG31371888199" class="indexterm"></a>Within <code class="command">pmie</code>, simple arithmetic expressions are constructed from metrics expressions (see <a class="xref" href="#LE73508-PARENT">Section 5.3.3, “<code class="command">pmie</code> Metric Expressions”</a>) and numeric constants, using all of the arithmetic operators and precedence rules of the C programming language.
				</div><div class="para">
					All <code class="command">pmie</code> arithmetic is performed in double precision.
				</div><div class="para">
					<a class="xref" href="#LE87294-PARENT">Section 5.3.8, “<code class="command">pmie</code> Intrinsic Operators”</a>, describes additional operators that may be used for aggregate operations to reduce the dimensionality of an arithmetic expression.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5201630">
      ⁠</a>5.3.6. <code class="command">pmie</code> Logical Expressions</h3></div></div></div><div class="para">
					<a id="ITch06-16" class="indexterm"></a><a id="IG31371888200" class="indexterm"></a>A number of logical expression types are supported:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							Logical constants
						</div></li><li class="listitem"><div class="para">
							Relational expressions
						</div></li><li class="listitem"><div class="para">
							Boolean expressions
						</div></li><li class="listitem"><div class="para">
							Quantification operators
						</div></li></ul></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5201707">
      ⁠</a>5.3.6.1. Logical Constants</h4></div></div></div><div class="para">
						<a id="IG31371888201" class="indexterm"></a>Like in the C programming language, <code class="command">pmie</code> interprets an arithmetic value of zero to be false, and all other arithmetic values are considered true.
					</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5201731">
      ⁠</a>5.3.6.2. Relational Expressions</h4></div></div></div><div class="para">
						<a id="IG31371888202" class="indexterm"></a>Relational expressions are the simplest form of logical expression, in which values may be derived from arithmetic expressions using <code class="command">pmie</code> relational operators. For example, the following is a relational expression that is true or false, depending on the aggregate total of disk read operations per second being greater than 50.
					</div><pre class="literallayout">disk.all.read &gt; 50 count/sec</pre><div class="para">
						All of the relational logical operators and precedence rules of the C programming language are supported in <code class="command">pmie</code>.
					</div><div class="para">
						As described in <a class="xref" href="#LE73508-PARENT">Section 5.3.3, “<code class="command">pmie</code> Metric Expressions”</a>, arithmetic expressions in <code class="command">pmie</code> may assume set values. The relational operators are also required to take constant, singleton, and set-valued expressions as arguments. The result has the same dimensionality as the operands. Suppose the rule in <a class="xref" href="#Z983832287sdc">Example 5.6, “Relational Expressions ”</a> is given:
					</div><div class="example"><a id="Z983832287sdc">
      ⁠</a><p class="title"><strong>Example 5.6. Relational Expressions </strong></p><div class="example-contents"><pre class="literallayout"><strong class="userinput"><code>hosts = ":gonzo";</code></strong>
<strong class="userinput"><code>intfs = "#eth0 #eth2";</code></strong>
<strong class="userinput"><code>all_intf = network.interface.in.packets</code></strong>
               <strong class="userinput"><code>$hosts $intfs @0..2 &gt; 300 count/sec;</code></strong></pre><div class="para">
							Then the execution of <code class="command">pmie</code> may proceed as follows:
						</div><pre class="literallayout"><strong class="userinput"><code>pmie -V uag.11</code></strong>
all_intf: 
       gonzo: [eth0]      ?      ?      ? 
       gonzo: [eth2]      ?      ?      ?
all_intf:
       gonzo: [eth0]  false      ?      ?
       gonzo: [eth2]  false      ?      ?
all_intf:
       gonzo: [eth0]   true  false      ?
       gonzo: [eth2]  false  false      ?
all_intf:
       gonzo: [eth0]   true   true  false
       gonzo: [eth2]  false  false  false</pre></div></div><div class="para">
						At each sample, the relational operator greater than (&gt;) produces six truth values for the cross-product of the <code class="literal">instance</code> and <code class="literal">sample time</code> dimensions.
					</div><div class="para">
						<a class="xref" href="#LE97708-PARENT">Section 5.3.6.4, “Quantification Operators”</a>, describes additional logical operators that may be used to reduce the dimensionality of a relational expression.
					</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5201927">
      ⁠</a>5.3.6.3. Boolean Expressions</h4></div></div></div><div class="para">
						<a id="IG31371888203" class="indexterm"></a>The regular Boolean operators from the C programming language are supported: conjunction (<code class="literal">&amp;&amp;</code>), disjunction (<code class="literal">||</code>) and negation (<code class="literal">!</code>).
					</div><div class="para">
						As with the relational operators, the Boolean operators accommodate set-valued operands, and set-valued results.
					</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="LE97708-PARENT">
      ⁠</a>5.3.6.4. Quantification Operators</h4></div></div></div><div class="para">
						<a id="IG31371888204" class="indexterm"></a><a id="IG31371888205" class="indexterm"></a>Boolean and relational operators may accept set-valued operands and produce set-valued results. In many cases, rules that are appropriate for performance management require a set of truth values to be reduced along one or more of the dimensions of hosts, instances, and sample times described in <a class="xref" href="#LE73508-PARENT">Section 5.3.3, “<code class="command">pmie</code> Metric Expressions”</a>. The <code class="command">pmie</code> quantification operators perform this function.
					</div><div class="para">
						Each quantification operator takes a one-, two-, or three-dimension set of truth values as an operand, and reduces it to a set of smaller dimension, by quantification along a single dimension. For example, suppose the expression in the previous example is simplified and prefixed by <code class="literal">some_sample</code>, to produce the following expression:
					</div><pre class="literallayout"><strong class="userinput"><code>intfs = "#eth0 #eth2";</code></strong> 
<strong class="userinput"><code>all_intf = some_sample network.interface.in.packets</code></strong>
                     <strong class="userinput"><code>$intfs @0..2 &gt; 300 count/sec;</code></strong></pre><div class="para">
						Then the expression result is reduced from six values to two (one per interface instance), such that the result for a particular instance will be false unless the relational expression for the same interface instance is true for at least one of the preceding three sample times.
					</div><div class="para">
						There are existential, universal, and percentile quantification operators in each of the <em class="replaceable">host</em>, <em class="replaceable">instance</em>, and <em class="replaceable">sample time</em> dimensions to produce the nine operators as follows:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">some_host</code></span></dt><dd><div class="para">
									True if the expression is true for at least one <em class="replaceable">host</em> for the same <em class="replaceable">instance</em> and <code class="literal">sample time</code>.
								</div></dd><dt><span class="term"><code class="literal">all_host</code></span></dt><dd><div class="para">
									True if the expression is true for every <em class="replaceable">host</em> for the same <em class="replaceable">instance</em> and <em class="replaceable">sample time</em>.
								</div></dd><dt><span class="term"><em class="replaceable">N</em><code class="literal">%</code><code class="literal">_host</code></span></dt><dd><div class="para">
									True if the expression is true for at least <em class="replaceable">N</em>% of the <em class="replaceable">hosts</em> for the same <em class="replaceable">instance</em> and <em class="replaceable">sample time</em>.
								</div></dd><dt><span class="term"><code class="literal">some_inst</code></span></dt><dd><div class="para">
									True if the expression is true for at least one <em class="replaceable">instance</em> for the same <em class="replaceable">host</em> and <em class="replaceable">sample time</em>.
								</div></dd><dt><span class="term"><code class="literal">all_instance</code></span></dt><dd><div class="para">
									True if the expression is true for every <em class="replaceable">instance</em> for the same <em class="replaceable">host</em> and <em class="replaceable">sample time</em>.
								</div></dd><dt><span class="term"><em class="replaceable">N</em><code class="literal">%</code><code class="literal">_instance</code></span></dt><dd><div class="para">
									True if the expression is true for at least <em class="replaceable">N</em>% of the <em class="replaceable">instances</em> for the same <em class="replaceable">host</em> and <em class="replaceable">sample time</em>.
								</div></dd><dt><span class="term"><code class="literal">some_sample time</code></span></dt><dd><div class="para">
									True if the expression is true for at least one <em class="replaceable">sample time</em> for the same <em class="replaceable">host</em> and <em class="replaceable">instance</em>.
								</div></dd><dt><span class="term"><code class="literal">all_sample time</code></span></dt><dd><div class="para">
									True if the expression is true for every <em class="replaceable">sample time</em> for the same <em class="replaceable">host</em> and <em class="replaceable">instance</em>.
								</div></dd><dt><span class="term"><em class="replaceable">N</em><code class="literal">%</code><code class="literal">_sample time</code></span></dt><dd><div class="para">
									True if the expression is true for at least <em class="replaceable">N</em>% of the <em class="replaceable">sample times</em> for the same <em class="replaceable">host</em> and <em class="replaceable">instance</em>.
								</div></dd></dl></div><div class="para">
						These operators may be nested. For example, the following expression answers the question: “Are all hosts experiencing at least 20% of their disks busy either reading or writing?”
					</div><pre class="literallayout">Servers = ":moomba :babylon";
all_host ( 
    20%_inst disk.dev.read $Servers &gt; 40 || 
    20%_inst disk.dev.write $Servers &gt; 40
);</pre><div class="para">
						The following expression uses different syntax to encode the same semantics:
					</div><pre class="literallayout">all_host (
    20%_inst (
        disk.dev.read $Servers &gt; 40 ||
        disk.dev.write $Servers &gt; 40
    )
);</pre><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							To avoid confusion over precedence and scope for the quantification operators, use explicit parentheses.
						</div></div></div><div class="para">
						Two additional quantification operators are available for the instance dimension only, namely <code class="literal">match_inst</code> and <code class="literal">nomatch_inst</code>, that take a regular expression and a boolean expression. The result is the boolean AND of the expression and the result of matching (or not matching) the associated instance name against the regular expression.
					</div><div class="para">
						For example, this rule evaluates error rates on various 10BaseT Ethernet network interfaces (such as ecN, ethN, or efN):
					</div><pre class="literallayout">some_inst
        match_inst "^(ec|eth|ef)"
                network.interface.total.errors &gt; 10 count/sec
-&gt; syslog "Ethernet errors:" " %i"</pre></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5202519">
      ⁠</a>5.3.7. <code class="command">pmie</code> Rule Expressions</h3></div></div></div><div class="para">
					<a id="IG31371888206" class="indexterm"></a>Rule expressions for <code class="command">pmie</code> have the following syntax:
				</div><pre class="literallayout">lexpr -&gt; <em class="replaceable">actions</em> ;</pre><div class="para">
					The semantics are as follows:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							If the logical expression <code class="literal">lexpr</code> evaluates <code class="literal">true</code>, then perform the <em class="replaceable">actions</em> that follow. Otherwise, do not perform the <em class="replaceable">actions</em>.
						</div></li><li class="listitem"><div class="para">
							It is required that <code class="literal">lexpr</code> has a singular truth value. Aggregation and quantification operators must have been applied to reduce multiple truth values to a single value.
						</div></li><li class="listitem"><div class="para">
							When executed, an <em class="replaceable">action</em> completes with a success/failure status.
						</div></li><li class="listitem"><div class="para">
							One or more <em class="replaceable">actions</em> may appear; consecutive <em class="replaceable">actions</em> are separated by operators that control the execution of subsequent <em class="replaceable">actions</em>, as follows:
						</div><div class="variablelist"><a id="Z926963018sdc">
      ⁠</a><dl class="variablelist"><dt><span class="term"><em class="replaceable">action-1 </em><code class="literal">&amp;</code></span></dt><dd><div class="para">
										Always execute subsequent actions (serial execution).
									</div></dd><dt><span class="term"><em class="replaceable">action-1 </em><strong class="userinput"><code>|</code></strong> </span></dt><dd><div class="para">
										If <em class="replaceable">action-1</em> fails, execute subsequent actions, otherwise skip the subsequent actions (alternation).
									</div></dd></dl></div></li></ul></div><div class="para">
					An <em class="replaceable">action</em> is composed of a keyword to identify the action method, an optional <em class="replaceable">time</em> specification, and one or more arguments.
				</div><div class="para">
					A <em class="replaceable">time</em> specification uses the same syntax as a valid time interval that may be assigned to <code class="literal">delta</code>, as described in <a class="xref" href="#LE88708-PARENT">Section 5.3.2, “Setting Evaluation Frequency”</a>. If the <em class="replaceable">action</em> is executed and the <em class="replaceable">time</em> specification is present, <code class="command">pmie</code> will suppress any subsequent execution of this <em class="replaceable">action</em> until the wall clock time has advanced by <em class="replaceable">time</em>.
				</div><div class="para">
					The arguments are passed directly to the action method.
				</div><div class="para">
					The following action methods are provided:
				</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">shell</code></span></dt><dd><div class="para">
								The single argument is passed to the shell for execution. This <em class="replaceable">action</em> is implemented using <code class="literal">system</code> in the background. The <em class="replaceable">action</em> does not wait for the system call to return, and succeeds unless the fork fails.
							</div></dd><dt><span class="term"><code class="literal">alarm</code></span></dt><dd><div class="para">
								<a id="IG31371888207" class="indexterm"></a>A notifier containing a time stamp, a single <em class="replaceable">argument</em> as a message, and a <span class="guilabel"><strong>Cancel</strong></span> button is posted on the current display screen (as identified by the <code class="literal">DISPLAY</code> environment variable). Each alarm <em class="replaceable">action</em> first checks if its notifier is already active. If there is an identical active notifier, a duplicate notifier is not posted. The action succeeds unless the fork fails.
							</div></dd><dt><span class="term"><code class="literal">syslog</code></span></dt><dd><div class="para">
								<a id="IG31371888208" class="indexterm"></a><a id="IG31371888209" class="indexterm"></a>A message is written into the system log. If the first word of the first argument is <code class="literal">-p</code>, the second word is interpreted as the priority (see the <code class="command">syslog(3)</code> man page); the message tag is <code class="literal">pcp-pmie</code>. The remaining argument is the message to be written to the system log. This action always succeeds.
							</div></dd><dt><span class="term"><code class="literal">print</code></span></dt><dd><div class="para">
								<a id="IG31371888210" class="indexterm"></a>A message containing a time stamp in <code class="command">ctime(3)</code> format and the argument is displayed out to standard output (<code class="command">stdout</code>). This action always succeeds.
							</div></dd></dl></div><div class="para">
					Within the argument passed to an action method, the following expansions are supported to allow some of the context from the logical expression on the left to appear to be embedded in the argument:
				</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">%h</code></span></dt><dd><div class="para">
								The value of a <em class="replaceable">host</em> that makes the expression true.
							</div></dd><dt><span class="term"><code class="literal">%i</code></span></dt><dd><div class="para">
								The value of an <em class="replaceable">instance</em> that makes the expression true.
							</div></dd><dt><span class="term"><code class="literal">%v</code></span></dt><dd><div class="para">
								The value of a performance metric from the logical expression.
							</div></dd></dl></div><div class="para">
					<a id="IG31371888211" class="indexterm"></a>Some ambiguity may occur in respect to which host, instance, or performance metric is bound to a %-token. In most cases, the leftmost binding in the top-level subexpression is used. You may need to use <code class="command">pmie</code> in the interactive debugging mode (specify the <code class="literal">-d</code> command line option) in conjunction with the <code class="literal">-W</code> command line option to discover which subexpressions contributes to the %-token bindings.
				</div><div class="para">
					<a class="xref" href="#Z983833504sdc">Example 5.7, “Rule Expression Options ”</a> illustrates some of the options when constructing rule expressions:
				</div><div class="example"><a id="Z983833504sdc">
      ⁠</a><p class="title"><strong>Example 5.7. Rule Expression Options </strong></p><div class="example-contents"><pre class="literallayout">some_inst ( disk.dev.total &gt; 60 ) 
       -&gt; syslog 10 mins "[%i] busy, %v IOPS " &amp; 
          shell 1 hour "echo \ 
               'Disk %i is REALLY busy. Running at %v I/Os per second' \ 
               | Mail -s 'pmie alarm' sysadm";</pre></div></div><div class="para">
					<a id="IG31371888212" class="indexterm"></a>In this case, <code class="literal">%v</code> and <code class="literal">%i</code> are both associated with the instances for the metric <code class="literal">disk.dev.total</code> that make the expression true. If more than one instance makes the expression true (more than one disk is busy), then the argument is formed by concatenating the result from each %-token binding. The text added to the system log file might be as shown in <a class="xref" href="#Z983833442sdc">Example 5.8, “System Log Text”</a>:
				</div><div class="example"><a id="Z983833442sdc">
      ⁠</a><p class="title"><strong>Example 5.8. System Log Text</strong></p><div class="example-contents"><pre class="literallayout">Aug 6 08:12:44 5B:gonzo pcp-pmie[3371]:
                         [disk1] busy, 3.7 IOPS [disk2] busy, 0.3 IOPS</pre></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						When <code class="command">pmie</code> is processing performance metrics from a set of PCP archive logs, the <em class="replaceable">actions</em> will be processed in the expected manner; however, the action methods are modified to report a textual facsimile of the <em class="replaceable">action</em> on the standard output.
					</div></div></div><div class="para">
					Consider the rule in <a class="xref" href="#Z983833364sdc">Example 5.9, “Standard Output”</a>:
				</div><div class="example"><a id="Z983833364sdc">
      ⁠</a><p class="title"><strong>Example 5.9. Standard Output</strong></p><div class="example-contents"><pre class="literallayout">delta = 2 sec;  // more often for demonstration purposes 
percpu  = "kernel.percpu"; 
// Unusual usr-sys split when some CPU is more than 20% in usr mode 
// and sys mode is at least 1.5 times usr mode 
// 
cpu_usr_sys = some_inst ( 
        $percpu.cpu.sys &gt; $percpu.cpu.user * 1.5 &amp;&amp; 
        $percpu.cpu.user &gt; 0.2 
   ) -&gt;  alarm "Unusual sys time: " "%i ";</pre><div class="para">
						When evaluated against an archive, the following output is generated (the alarm action produces a message on standard output):
					</div><pre class="literallayout"><strong class="userinput"><code>pmafm ${HOME}/f4 pmie cpu.head cpu.00</code></strong>
alarm Wed Aug  7 14:54:48 2012: Unusual sys time: cpu0 
alarm Wed Aug  7 14:54:50 2012: Unusual sys time: cpu0 
alarm Wed Aug  7 14:54:52 2012: Unusual sys time: cpu0 
alarm Wed Aug  7 14:55:02 2012: Unusual sys time: cpu0 
alarm Wed Aug  7 14:55:06 2012: Unusual sys time: cpu0</pre></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE87294-PARENT">
      ⁠</a>5.3.8. <code class="command">pmie</code> Intrinsic Operators</h3></div></div></div><div class="para">
					<a id="ITch06-17" class="indexterm"></a><a id="IG31371888213" class="indexterm"></a>The following sections describe some other useful intrinsic operators for <code class="command">pmie</code>. These operators are divided into three groups:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							Arithmetic aggregation
						</div></li><li class="listitem"><div class="para">
							The <code class="literal">rate</code> operator
						</div></li><li class="listitem"><div class="para">
							Transitional operators
						</div></li></ul></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5203384">
      ⁠</a>5.3.8.1. Arithmetic Aggregation</h4></div></div></div><div class="para">
						<a id="IG31371888214" class="indexterm"></a><a id="IG31371888215" class="indexterm"></a>For set-valued arithmetic expressions, the following operators reduce the dimensionality of the result by arithmetic aggregation along one of the <em class="replaceable">host</em>, <em class="replaceable">instance</em>, or <em class="replaceable">sample time</em> dimensions. For example, to aggregate in the <em class="replaceable">host</em> dimension, the following operators are provided:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">avg_host</code></span></dt><dd><div class="para">
									<a id="IG31371888216" class="indexterm"></a>Computes the average value across all <em class="replaceable">instances</em> for the same <em class="replaceable">host</em> and <em class="replaceable">sample time</em>
								</div></dd><dt><span class="term"><code class="literal">sum_host</code></span></dt><dd><div class="para">
									<a id="IG31371888217" class="indexterm"></a>Computes the total value across all <em class="replaceable">instances</em> for the same <em class="replaceable">host</em> and <em class="replaceable">sample time</em>
								</div></dd><dt><span class="term"><code class="literal">count_host</code></span></dt><dd><div class="para">
									<a id="IG31371888218" class="indexterm"></a>Computes the number of values across all <em class="replaceable">instances</em> for the same <em class="replaceable">host</em> and <em class="replaceable">sample time</em>
								</div></dd><dt><span class="term"><code class="literal">min_host</code></span></dt><dd><div class="para">
									<a id="IG31371888219" class="indexterm"></a>Computes the minimum value across all <em class="replaceable">instances</em> for the same <em class="replaceable">host</em> and <em class="replaceable">sample time</em>
								</div></dd><dt><span class="term"><code class="literal">max_host</code></span></dt><dd><div class="para">
									<a id="IG31371888220" class="indexterm"></a>Computes the maximum value across all <em class="replaceable">instances</em> for the same <em class="replaceable">host</em> and <em class="replaceable">sample time</em>
								</div></dd></dl></div><div class="para">
						<a id="IG31371888221" class="indexterm"></a><a id="IG31371888222" class="indexterm"></a>Ten additional operators correspond to the forms <code class="literal">*_inst</code> and <code class="literal">*_sample</code>.
					</div><div class="para">
						The following example illustrates the use of an aggregate operator in combination with an existential operator to answer the question “Does some host currently have two or more busy processors?”
					</div><pre class="literallayout">// note '' to escape - in host name 
poke = ":moomba :'mac-larry' :bitbucket"; 
some_host ( 
    count_inst ( kernel.percpu.cpu.user $poke + 
                 kernel.percpu.cpu.sys $poke &gt; 0.7 ) &gt;= 2 
    ) 
       -&gt; alarm "2 or more busy CPUs";</pre></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5203682">
      ⁠</a>5.3.8.2. The <code class="command">rate</code> Operator</h4></div></div></div><div class="para">
						<a id="IG31371888223" class="indexterm"></a><a id="IG31371888224" class="indexterm"></a>The <code class="literal">rate</code> operator computes the rate of change of an arithmetic expression as shown in the following example:
					</div><pre class="literallayout">rate mem.util.cached</pre><div class="para">
						It returns the rate of change for the <code class="literal">mem.util.cached</code> performance metric; that is, the rate at which page cache memory is being allocated and released.
					</div><div class="para">
						The <code class="literal">rate</code> intrinsic operator is most useful for metrics with instantaneous value semantics. For metrics with counter semantics, <code class="command"> pmie</code> already performs an implicit rate calculation (see the <a class="xref" href="#LE59099-PARENT">Section 5.3.4, “<code class="command">pmie</code> Rate Conversion”</a>) and the <code class="literal">rate</code> operator would produce the second derivative with respect to time, which is less likely to be useful.
					</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5203810">
      ⁠</a>5.3.8.3. Transitional Operators</h4></div></div></div><div class="para">
						<a id="IG31371888225" class="indexterm"></a><a id="IG31371888226" class="indexterm"></a>In some cases, an action needs to be triggered when an expression changes from true to false or vice versa. The following operators take a logical expression as an operand, and return a logical expression:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">rising</code></span></dt><dd><div class="para">
									Has the value <code class="literal">true</code> when the operand transitions from <code class="literal">false</code> to <code class="literal">true</code> in consecutive samples.
								</div></dd><dt><span class="term"><code class="literal">falling</code></span></dt><dd><div class="para">
									Has the value <code class="literal">false</code> when the operand transitions from <code class="literal">true</code> to <code class="literal">false</code> in consecutive samples.
								</div></dd></dl></div></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE60280-PARENT">
      ⁠</a>5.4. <code class="command">pmie</code> Examples</h2></div></div></div><div class="para">
				<a id="ITch06-18" class="indexterm"></a>The examples presented in this section are task-oriented and use the full power of the <code class="command">pmie</code> specification language as described in <a class="xref" href="#LE90227-PARENT">Section 5.3, “Specification Language for <code class="command">pmie</code>”</a>.
			</div><div class="para">
				<a id="IG31371888228" class="indexterm"></a>Source code for the <code class="command">pmie</code> examples in this chapter, and many more examples, is provided within the <em class="citetitle">PCP Tutorials and Case Studies</em>. <a class="xref" href="#Z928441343sdc">Example 5.10, “Monitoring CPU Utilization”</a> and <a class="xref" href="#Z928441176sdc">Example 5.11, “Monitoring Disk Activity ”</a> illustrate monitoring CPU utilization and disk activity.
			</div><div class="example"><a id="Z928441343sdc">
      ⁠</a><p class="title"><strong>Example 5.10. Monitoring CPU Utilization</strong></p><div class="example-contents"><pre class="literallayout">// Some Common Performance Monitoring Scenarios
//
// The CPU Group
//
delta = 2 sec;  // more often for demonstration purposes
// common prefixes
//
percpu  = "kernel.percpu";
all     = "kernel.all";
// Unusual usr-sys split when some CPU is more than 20% in usr mode
// and sys mode is at least 1.5 times usr mode
//
cpu_usr_sys =
       some_inst (
           $percpu.cpu.sys &gt; $percpu.cpu.user * 1.5 &amp;&amp;
           $percpu.cpu.user &gt; 0.2
       )
           -&gt;  alarm "Unusual sys time: " "%i ";
// Over all CPUs, syscall_rate &gt; 1000 * no_of_cpus
//
cpu_syscall =
       $all.syscall &gt; 1000 count/sec * hinv.ncpu
       -&gt;  print "high aggregate syscalls: %v";
// Sustained high syscall rate on a single CPU
//
delta = 30 sec;
percpu_syscall =
       some_inst (
           $percpu.syscall &gt; 2000 count/sec
       )
           -&gt; syslog "Sustained syscalls per second? " "[%i] %v ";
// the 1 minute load average exceeds 5 * number of CPUs on any host
hosts = ":gonzo :moomba";   // change as required
delta = 1 minute;           // no need to evaluate more often than this
high_load =
     some_host (
           $all.load $hosts #'1 minute' &gt; 5 * hinv.ncpu
       )
           -&gt; alarm "High Load Average? " "%h: %v ";</pre></div></div><div class="example"><a id="Z928441176sdc">
      ⁠</a><p class="title"><strong>Example 5.11. Monitoring Disk Activity </strong></p><div class="example-contents"><pre class="literallayout">// Some Common Performance Monitoring Scenarios
//
// The Disk Group
//
delta = 15 sec;         // often enough for disks?
// common prefixes
//
disk    = "disk";
// Any disk performing more than 40 I/Os per second, sustained over
// at least 30 seconds is probably busy
//
delta = 30 seconds;
disk_busy =
       some_inst (
           $disk.dev.total &gt; 40 count/sec
       )
]      -&gt; shell "Mail -s 'Heavy systained disk traffic' sysadm";
// Try and catch bursts of activity ... more than 60 I/Os per second
// for at least 25% of 8 consecutive 3 second samples
//
delta = 3 sec;
disk_burst =
       some_inst (
           25%_sample (
               $disk.dev.total @0..7 &gt; 60 count/sec
           )
       )
       -&gt; alarm "Disk Burst? " "%i ";
// any SCSI disk controller performing more than 3 Mbytes per
// second is busy
// Note: the obscure 512 is to convert blocks/sec to byte/sec,
//       and pmie handles the rest of the scale conversion
//
some_inst $disk.ctl.blktotal * 512 &gt; 3 Mbyte/sec
           -&gt; alarm "Busy Disk Controller: " "%i ";</pre></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE31514-PARENT">
      ⁠</a>5.5. Developing and Debugging <code class="command">pmie</code> Rules</h2></div></div></div><div class="para">
				<a id="ITch06-20" class="indexterm"></a>Given the <code class="literal">-d</code> command line option, <code class="command">pmie</code> executes in interactive mode, and the user is presented with a menu of options:
			</div><pre class="literallayout">pmie debugger commands
     f [file-name]      - load expressions from given file or stdin
     l [expr-name]      - list named expression or all expressions
     r [interval]       - run for given or default interval
     S time-spec        - set start time for run
     T time-spec        - set default interval for run command
     v [expr-name]      - print subexpression for %h, %i and %v bindings
     h or ?             - print this menu of commands
     q                  - quit
pmie&gt;</pre><div class="para">
				If both the <code class="literal">-d</code> option and a filename are present, the expressions in the given file are loaded before entering interactive mode. Interactive mode is useful for debugging new rules.
			</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE91221-PARENT">
      ⁠</a>5.6. Caveats and Notes on <code class="command">pmie</code></h2></div></div></div><div class="para">
				<a id="IG31371888229" class="indexterm"></a>The following sections provide important information for users of <code class="command">pmie</code>.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5204255">
      ⁠</a>5.6.1. Performance Metrics Wraparound</h3></div></div></div><div class="para">
					<a id="ITch06-21" class="indexterm"></a><a id="IG31371888230" class="indexterm"></a><a id="IG31371888231" class="indexterm"></a>Performance metrics that are cumulative counters may occasionally overflow their range and wraparound to 0. When this happens, an unknown value (printed as <code class="literal">?</code>) is returned as the value of the metric for one sample (recall that the value returned is normally a rate). You can have PCP interpolate a value based on expected rate of change by setting the <code class="literal">PCP_COUNTER_WRAP</code> environment variable.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5204304">
      ⁠</a>5.6.2. <code class="command">pmie</code> Sample Intervals</h3></div></div></div><div class="para">
					<a id="ITch06-22" class="indexterm"></a><a id="IG31371888232" class="indexterm"></a>The sample interval (<code class="literal">delta</code>) should always be long enough, particularly in the case of rates, to ensure that a meaningful value is computed. Interval may vary according to the metric and your needs. A reasonable minimum is in the range of ten seconds or several minutes. Although PCP supports sampling rates up to hundreds of times per second, using small sample intervals creates unnecessary load on the monitored system.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5204396">
      ⁠</a>5.6.3. <code class="command">pmie</code> Instance Names</h3></div></div></div><div class="para">
					<a id="ITch06-23" class="indexterm"></a>When you specify a metric instance name (<code class="literal">#</code><em class="replaceable">identifier</em>) in a <code class="command">pmie</code> expression, it is compared against the instance name looked up from either a live collector system or an archive as follows:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							If the given instance name and the looked up name are the same, they are considered to match.
						</div></li><li class="listitem"><div class="para">
							Otherwise, the first two space separated tokens are extracted from the looked up name. If the given instance name is the same as either of these tokens, they are considered a match.
						</div></li></ul></div><div class="para">
					For some metrics, notably the per process (<code class="literal">proc.xxx.xxx</code>) metrics, the first token in the looked up instance name is impossible to determine at the time you are writing <code class="command">pmie</code> expressions. The above policy circumvents this problem.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5204468">
      ⁠</a>5.6.4. <code class="command">pmie</code> Error Detection</h3></div></div></div><div class="para">
					<a id="ITch06-24" class="indexterm"></a><a id="IG31371888233" class="indexterm"></a>The parser used in <code class="command">pmie</code> is not particularly robust in handling syntax errors. It is suggested that you check any problematic expressions individually in interactive mode:
				</div><pre class="literallayout"><strong class="userinput"><code>pmie -v -d</code></strong>
pmie&gt; f
<em class="replaceable">expression</em>
<strong class="userinput"><code>Ctrl+D</code></strong></pre><div class="para">
					If the expression was parsed, its internal representation is shown:
				</div><pre class="literallayout">pmie&gt; <strong class="userinput"><code>l</code></strong></pre><div class="para">
					The expression is evaluated twice and its value printed:
				</div><pre class="literallayout">pmie&gt; <strong class="userinput"><code>r 10sec</code></strong></pre><div class="para">
					Then quit:
				</div><pre class="literallayout">pmie&gt; <strong class="userinput"><code>q</code></strong></pre><div class="para">
					It is not always possible to detect semantic errors at parse time. This happens when a performance metric descriptor is not available from the named host at this time. A warning is issued, and the expression is put on a wait list. The wait list is checked periodically (about every five minutes) to see if the metric descriptor has become available. If an error is detected at this time, a message is printed to the standard error stream (<code class="command">stderr</code>) and the offending expression is set aside.
				</div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="Z927039566sdc">
      ⁠</a>5.7. Creating <code class="command">pmie</code> Rules with <code class="command">pmieconf</code></h2></div></div></div><div class="para">
				<a id="IG31371888234" class="indexterm"></a><a id="IG31371888235" class="indexterm"></a>The <code class="command">pmieconf</code> tool is a command line utility that is designed to aid the specification of <code class="command">pmie</code> rules from parameterized versions of the rules. <code class="command">pmieconf</code> is used to display and modify variables or parameters controlling the details of the generated <code class="command">pmie</code> rules.
			</div><div class="para">
				<code class="command">pmieconf</code> reads two different forms of supplied input files and produces a localized <code class="command">pmie</code> configuration file as its output.
			</div><div class="para">
				The first input form is a generalized <code class="command">pmie</code> rule file such as those found below <code class="filename">${PCP_VAR_DIR}/config/pmieconf</code>. These files contain the generalized rules which <code class="command">pmieconf</code> is able to manipulate. Each of the rules can be enabled or disabled, or the individual variables associated with each rule can be edited.
			</div><div class="para">
				The second form is an actual <code class="command">pmie</code> configuration file (that is, a file which can be interpreted by <code class="command">pmie</code>, conforming to the <code class="command">pmie</code> syntax described in <a class="xref" href="#LE90227-PARENT">Section 5.3, “Specification Language for <code class="command">pmie</code>”</a>). This file is both input to and output from <code class="command">pmieconf</code>.
			</div><div class="para">
				The input version of the file contains any changed variables or rule states from previous invocations of <code class="command">pmieconf</code>, and the output version contains both the changes in state (for any subsequent <code class="command">pmieconf </code> sessions) and the generated <code class="command">pmie</code> syntax. The <code class="command">pmieconf</code> state is embedded within a <code class="command">pmie</code> comment block at the head of the output file and is not interpreted by <code class="command">pmie</code> itself.
			</div><div class="para">
				<a id="IG31371888236" class="indexterm"></a><code class="command">pmieconf</code> is an integral part of the <code class="command">pmie</code> daemon management process described in <a class="xref" href="#Z927039824sdc">Section 5.8, “Management of <code class="command">pmie</code> Processes”</a>. <a class="xref" href="#Z930357839sdc">Procedure 5.1, “Display <code class="command">pmieconf</code> Rules”</a> and <a class="xref" href="#Z930357878sdc">Procedure 5.2, “Modify <code class="command">pmieconf</code> Rules and Generate a <code class="command">pmie</code> File”</a> introduce the <code class="command">pmieconf</code> tool through a series of typical operations.
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="Z930357839sdc">
      ⁠</a><p class="title"><strong>Procedure 5.1. Display <code class="command">pmieconf</code> Rules</strong></p><ol class="1"><li class="step"><div class="para">
						Start <code class="command">pmieconf</code> interactively (as the superuser).
<pre class="literallayout"><strong class="userinput"><code>pmieconf -f ${PCP_SYSCONF_DIR}/pmie/config.demo</code></strong>
Updates will be made to ${PCP_SYSCONF_DIR}/pmie/config.demo

pmieconf&gt;</pre>
					</div></li><li class="step"><div class="para">
						List the set of available <code class="command">pmieconf</code> rules by using the <code class="command">rules</code> command.
					</div></li><li class="step"><div class="para">
						List the set of rule groups using the <code class="command">groups</code> command.
					</div></li><li class="step"><div class="para">
						List only the enabled rules, using the <code class="command">rules enabled</code> command.
					</div></li><li class="step"><div class="para">
						List a single rule:
					</div><pre class="literallayout">pmieconf&gt; <strong class="userinput"><code>list memory.swap_low</code></strong>
   rule: memory.swap_low  [Low free swap space]
   help: There is only threshold percent swap space remaining - the system
         may soon run out of virtual memory.  Reduce the number and size of
         the running programs or add more swap(1) space before it
completely
         runs out.
         predicate =
           some_host (
               ( 100 * ( swap.free $hosts$ / swap.length $hosts$ ) )
                 &lt; $threshold$
               &amp;&amp; swap.length $hosts$ &gt; 0        // ensure swap in use
            )
   vars: enabled = no
         threshold = 10%

pmieconf&gt;</pre></li><li class="step"><div class="para">
						List one rule variable:
<pre class="literallayout">pmieconf&gt; <strong class="userinput"><code>list memory.swap_low threshold</code></strong>
   rule: memory.swap_low  [Low free swap space]
         threshold = 10%

pmieconf&gt;</pre>
					</div></li></ol></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="Z930357878sdc">
      ⁠</a><p class="title"><strong>Procedure 5.2. Modify <code class="command">pmieconf</code> Rules and Generate a <code class="command">pmie</code> File</strong></p><ol class="1"><li class="step"><div class="para">
						Lower the threshold for the <code class="literal">memory.swap_low</code> rule, and also change the <code class="command">pmie</code> sample interval affecting just this rule. The <code class="literal">delta</code> variable is special in that it is not associated with any particular rule; it has been defined as a global <code class="command">pmieconf</code> variable. Global variables can be displayed using the <code class="command">list global</code> command to <code class="command">pmieconf</code>, and can be modified either globally or local to a specific rule. 
<pre class="literallayout">pmieconf&gt; <strong class="userinput"><code>modify memory.swap_low threshold 5</code></strong>

pmieconf&gt; <strong class="userinput"><code>modify memory.swap_low delta "1 sec"</code></strong>

pmieconf&gt;</pre>
					</div></li><li class="step"><div class="para">
						Disable all of the rules except for the <code class="literal">memory.swap_low</code> rule so that you can see the effects of your change in isolation.
					</div><div class="para">
						This produces a relatively simple <code class="command">pmie</code> configuration file:
<pre class="literallayout">pmieconf&gt; <strong class="userinput"><code>disable all</code></strong>

pmieconf&gt; <strong class="userinput"><code>enable memory.swap_low</code></strong>

pmieconf&gt; <strong class="userinput"><code>status</code></strong>
  verbose:  off
  enabled rules:  1 of 35
  pmie configuration file:  ${PCP_SYSCONF_DIR}/pmie/config.demo
  pmie processes (PIDs) using this file:  (none found)

pmieconf&gt; quit</pre>
					</div><div class="para">
						You can also use the <code class="command">status</code> command to verify that only one rule is enabled at the end of this step.
					</div><div class="para">
					</div></li><li class="step"><a id="Z930357553sdc">
      ⁠</a><div class="para">
						Run <code class="command">pmie</code> with the new configuration file. Use a text editor to view the newly generated <code class="command">pmie</code> configuration file (<code class="filename">${PCP_SYSCONF_DIR}/pmie/config.demo</code>), and then run the command:
<pre class="literallayout"><strong class="userinput"><code>pmie -T "1.5 sec" -v -l ${HOME}/demo.log ${PCP_SYSCONF_DIR}/pmie/config.demo</code></strong>
memory.swap_low: false

memory.swap_low: false

<strong class="userinput"><code>cat ${HOME}/demo.log</code></strong>
Log for pmie on <em class="replaceable">venus</em> started Mon Jun 21 16:26:06 2012

pmie: PID = 21847, default host = <em class="replaceable">venus</em>

[Mon Jun 21 16:26:07] pmie(21847) Info: evaluator exiting

Log finished Mon Jun 21 16:26:07 2012</pre>
					</div></li><li class="step"><div class="para">
						Notice that both of the <code class="command">pmieconf</code> files used in the previous step are simple text files, as described in the <code class="command">pmieconf(5)</code> man page:
					</div><pre class="literallayout"><strong class="userinput"><code>file ${PCP_SYSCONF_DIR}/pmie/config.demo</code></strong>
${PCP_SYSCONF_DIR}/pmie/config.demo:  PCP pmie config (V.1)
<strong class="userinput"><code>file ${PCP_VAR_DIR}/config/pmieconf/memory/swap_low</code></strong>
${PCP_VAR_DIR}/config/pmieconf/memory/swap_low:       PCP pmieconf rules (V.1)</pre></li></ol></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="Z927039824sdc">
      ⁠</a>5.8. Management of <code class="command">pmie</code> Processes</h2></div></div></div><div class="para">
				<a id="IG31371888237" class="indexterm"></a>The <code class="command">pmie</code> process can be run as a daemon as part of the system startup sequence, and can thus be used to perform automated, live performance monitoring of a running system. To do this, run these commands (as superuser):
			</div><pre class="literallayout"><strong class="userinput"><code>chkconfig pmie on</code></strong>
<strong class="userinput"><code>${PCP_RC_DIR}/pmie start</code></strong></pre><div class="para">
				By default, these enable a single <code class="command">pmie</code> process monitoring the local host, with the default set of <code class="command">pmieconf</code> rules enabled (for more information about <code class="command">pmieconf</code>, see <a class="xref" href="#Z927039566sdc">Section 5.7, “Creating <code class="command">pmie</code> Rules with <code class="command">pmieconf</code>”</a>). <a class="xref" href="#Z930363467sdc">Procedure 5.3, “Add a New <code class="command">pmie</code> Instance to the <code class="command">pmie</code> Daemon Management Framework”</a> illustrates how you can use these commands to start any number of <code class="command">pmie</code> processes to monitor local or remote machines.
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="Z930363467sdc">
      ⁠</a><p class="title"><strong>Procedure 5.3. Add a New <code class="command">pmie</code> Instance to the <code class="command">pmie</code> Daemon Management Framework</strong></p><ol class="1"><li class="step"><div class="para">
						Use a text editor (as superuser) to edit the <code class="command">pmie</code><code class="filename">${PCP_PMIECONTROL_PATH}</code> and <code class="filename">${PCP_PMIECONTROL_PATH}.d</code> control files. Notice the default entry, which looks like this:
					</div><pre class="literallayout">#Host           P?  S?  Log File                                  Arguments
LOCALHOSTNAME   y   n   PCP_LOG_DIR/pmie/LOCALHOSTNAME/pmie.log   -c config.default</pre><div class="para">
						This entry is used to enable a local <code class="command">pmie</code> process. Add a new entry for a remote host on your local network (for example, <code class="literal">venus</code>), by using your <code class="command">pmie</code> configuration file (see <a class="xref" href="#Z927039566sdc">Section 5.7, “Creating <code class="command">pmie</code> Rules with <code class="command">pmieconf</code>”</a>):
					</div><pre class="literallayout">
#Host           P?  S?  Log File                                  Arguments
venus           n   n   PCP_LOG_DIR/pmie/venus/pmie.log           -c config.demo
</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							Without an absolute path, the configuration file (<code class="literal">-c</code> above) will be resolved using <code class="filename">${PCP_SYSCONF_DIR}/pmie</code> - if <code class="filename">config.demo</code> was created in <a class="xref" href="#Z930357878sdc">Procedure 5.2, “Modify <code class="command">pmieconf</code> Rules and Generate a <code class="command">pmie</code> File”</a> it would be used here for host <code class="literal">venus</code>, otherwise a new configuration file will be generated using the default rules (at <code class="filename">${PCP_SYSCONF_DIR}/pmie/config.demo</code>).
						</div></div></div></li><li class="step"><div class="para">
						Enable <code class="command">pmie</code> daemon management: 
<pre class="literallayout"><strong class="userinput"><code>chkconfig pmie on</code></strong></pre>
					</div><div class="para">
						This simple step allows <code class="command">pmie</code> to be started as part of your machine's boot process.
					</div></li><li class="step"><div class="para">
						Start the two <code class="command">pmie</code> daemons. At the end of this step, you should see two new <code class="command">pmie</code> processes monitoring the local and remote hosts:
					</div><pre class="literallayout">${PCP_RC_DIR}/pmie start
Performance Co-Pilot starting inference engine(s) ...
</pre><div class="para">
						Wait a few moments while the startup scripts run. The <code class="command">pmie</code> start script uses the <code class="command">pmie_check</code> script to do most of its work.
					</div><div class="para">
						Verify that the <code class="command">pmie</code> processes have started:
					</div><pre class="literallayout"><strong class="userinput"><code>pcp</code></strong>
Performance Co-Pilot configuration on pluto:

 platform: Linux pluto 3.10.0-0.rc7.64.el7.x86_64 #1 SMP
 hardware: 8 cpus, 2 disks, 23960MB RAM
 timezone: EST-10
     pmcd: Version 3.11.3-1, 8 agents
     pmda: pmcd proc xfs linux mmv infiniband gluster elasticsearch
     <em class="replaceable">pmie: pluto: ${PCP_LOG_DIR}/pmie/pluto/pmie.log</em>
           <em class="replaceable">venus: ${PCP_LOG_DIR}/pmie/venus/pmie.log</em></pre></li></ol></div><div class="para">
				If a remote host is not up at the time when <code class="command">pmie</code> is started, the <code class="command">pmie</code> process may exit. <code class="command">pmie</code> processes may also exit if the local machine is starved of memory resources. To counter these adverse cases, it can be useful to have a <code class="command">crontab</code> entry running. Adding an entry as shown in <a class="xref" href="#id5208584">Section 5.8.1, “Add a <code class="command">pmie</code> <code class="command">crontab</code> Entry”</a> ensures that if one of the configured <code class="command">pmie</code> processes exits, it is automatically restarted.
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Depending on your platform, the <code class="command">crontab</code> entry discussed here may already have been installed for you, as part of the package installation process. In this case, the file <code class="filename">/etc/cron.d/pcp-pmie</code> will exist, and the rest of this section can be skipped.
				</div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5208584">
      ⁠</a>5.8.1. Add a <code class="command">pmie</code> <code class="command">crontab</code> Entry</h3></div></div></div><div class="para">
					To activate the maintenance and housekeeping scripts for a collection of inference engines, execute the following tasks while logged into the local host as the superuser (<code class="literal">root</code>):
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
							Augment the <code class="filename">crontab</code> file for the <code class="literal">pcp</code> user. For example:
						</div><pre class="literallayout"><strong class="userinput"><code>crontab -l -u pcp &gt; ${HOME}/crontab.txt</code></strong></pre></li><li class="listitem"><div class="para">
							Edit <code class="filename">${HOME}/crontab.txt</code>, adding lines similar to those from the sample <code class="filename">${PCP_VAR_DIR}/config/pmie/crontab</code> file for <code class="literal">pmie_daily</code> and <code class="literal">pmie_check</code>; for example:
						</div><pre class="literallayout"># daily processing of pmie logs
10     0     *     *     *    ${PCP_BINADM_DIR}/pmie_daily
# every 30 minutes, check pmie instances are running
25,55  *     *     *     *    ${PCP_BINADM_DIR}/pmie_check</pre></li><li class="listitem"><div class="para">
							Make these changes permanent with this command:
						</div><pre class="literallayout"><strong class="userinput"><code>crontab -u pcp &lt; ${HOME}/crontab.txt</code></strong></pre></li></ol></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5205585">
      ⁠</a>5.8.2. Global Files and Directories</h3></div></div></div><div class="para">
					<a id="IG31371888238" class="indexterm"></a>The following global files and directories influence the behavior of <code class="command">pmie</code> and the <code class="command">pmie</code> management scripts:
				</div><div class="variablelist"><a id="Z930361086sdc">
      ⁠</a><dl class="variablelist"><dt><span class="term"><code class="filename">${PCP_DEMOS_DIR}/pmie/*</code></span></dt><dd><div class="para">
								Contains sample <code class="command">pmie</code> rules that may be used as a basis for developing local rules.
							</div></dd><dt><span class="term"><code class="filename">${PCP_SYSCONF_DIR}/pmie/config.default</code></span></dt><dd><div class="para">
								Is the default <code class="command">pmie</code> configuration file that is used when the <code class="command">pmie</code> daemon facility is enabled. Generated by <code class="command">pmieconf</code> if not manually setup beforehand.
							</div></dd><dt><span class="term"><code class="filename">${PCP_VAR_DIR}/config/pmieconf/*/*</code></span></dt><dd><div class="para">
								Contains the <code class="command">pmieconf</code> rule definitions (templates) in its subdirectories.
							</div></dd><dt><span class="term"><code class="filename">${PCP_PMIECONTROL_PATH}</code> and <code class="filename">${PCP_PMIECONTROL_PATH}.d</code> files</span></dt><dd><div class="para">
								Defines which PCP collector hosts require a daemon <code class="command">pmie</code> to be launched on the local host, where the configuration file comes from, where the <code class="command">pmie</code> log file should be created, and <code class="command">pmie</code> startup options.
							</div></dd><dt><span class="term"><code class="filename">${PCP_VAR_DIR}/config/pmlogger/crontab</code></span></dt><dd><div class="para">
								Contains default <code class="command">crontab</code> entries that may be merged with the <code class="command">crontab</code> entries for root to schedule the periodic execution of the <code class="command">pmie_check</code> script, for verifying that <code class="command">pmie</code> instances are running. Only for platforms where a default <code class="command">crontab</code> is not automatically installed during the initial PCP package installation.
							</div></dd><dt><span class="term"><code class="filename">${PCP_LOG_DIR}/pmie/*</code></span></dt><dd><div class="para">
								Contains the <code class="command">pmie</code> log files for the host. These files are created by the default behavior of the <code class="filename">${PCP_RC_DIR}/pmie</code> startup scripts.
							</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5205812">
      ⁠</a>5.8.3. <code class="command">pmie</code> Instances and Their Progress</h3></div></div></div><div class="para">
					The PMCD PMDA exports information about executing <code class="command">pmie</code> instances and their progress in terms of rule evaluations and action execution rates.
				</div><div class="variablelist"><a id="Z929060000sdc">
      ⁠</a><dl class="variablelist"><dt><span class="term"><code class="command">pmie_check</code></span></dt><dd><div class="para">
								This command is similar to the <code class="command">pmlogger</code> support script, <code class="command">pmlogger_check</code>.
							</div></dd><dt><span class="term"><code class="filename">${PCP_RC_DIR}/pmie</code></span></dt><dd><div class="para">
								This start script supports the starting and stopping of multiple <code class="command">pmie</code> instances that are monitoring one or more hosts.
							</div></dd><dt><span class="term"><code class="filename">${PCP_TMP_DIR}/pmie</code></span></dt><dd><div class="para">
								The statistics that <code class="command">pmie</code> gathers are maintained in binary data structure files. These files are located in this directory.
							</div></dd><dt><span class="term"><code class="literal">pmcd.pmie</code> metrics</span></dt><dd><div class="para">
								If <code class="command">pmie</code> is running on a system with a PCP collector deployment, the PMCD PMDA exports these metrics via the <code class="filename">pmcd.pmie</code> group of metrics.
							</div></dd></dl></div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="LE93354-PARENT">
      ⁠</a>Chapter 6. Archive Logging</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#LE43411-PARENT">6.1. Introduction to Archive Logging</a></span></dt><dd><dl><dt><span class="section"><a href="#id5206288">6.1.1. Archive Logs and the PMAPI</a></span></dt><dt><span class="section"><a href="#id5206362">6.1.2. Retrospective Analysis Using Archive Logs</a></span></dt><dt><span class="section"><a href="#id5206454">6.1.3. Using Archive Logs for Capacity Planning</a></span></dt></dl></dd><dt><span class="section"><a href="#LE46764-PARENT">6.2. Using Archive Logs with Performance Tools</a></span></dt><dd><dl><dt><span class="section"><a href="#id5206523">6.2.1. Coordination between <code class="command">pmlogger</code> and PCP tools</a></span></dt><dt><span class="section"><a href="#id5206675">6.2.2. Administering PCP Archive Logs Using <code class="command">cron</code> Scripts </a></span></dt><dt><span class="section"><a href="#LE92914-PARENT">6.2.3. Archive Log File Management</a></span></dt></dl></dd><dt><span class="section"><a href="#LE57424-PARENT">6.3. Cookbook for Archive Logging</a></span></dt><dd><dl><dt><span class="section"><a href="#id5207850">6.3.1. Primary Logger</a></span></dt><dt><span class="section"><a href="#id5208266">6.3.2. Other Logger Configurations</a></span></dt><dt><span class="section"><a href="#id5208588">6.3.3. Archive Log Administration</a></span></dt></dl></dd><dt><span class="section"><a href="#Z930642977sdc">6.4. Other Archive Logging Features and Services</a></span></dt><dd><dl><dt><span class="section"><a href="#LE73509-PARENT">6.4.1. PCP Archive Folios</a></span></dt><dt><span class="section"><a href="#id5208950">6.4.2. Manipulating Archive Logs with <code class="command">pmlogextract</code></a></span></dt><dt><span class="section"><a href="#id5208951">6.4.3. Summarizing Archive Logs with <code class="command">pmlogsummary</code></a></span></dt><dt><span class="section"><a href="#id5209027">6.4.4. Primary Logger</a></span></dt><dt><span class="section"><a href="#id5209191">6.4.5. Using <code class="command">pmlc</code></a></span></dt></dl></dd><dt><span class="section"><a href="#LE80113-PARENT">6.5. Archive Logging Troubleshooting</a></span></dt><dd><dl><dt><span class="section"><a href="#id5209540">6.5.1. <code class="command">pmlogger</code> Cannot Write Log</a></span></dt><dt><span class="section"><a href="#id5209654">6.5.2. Cannot Find Log</a></span></dt><dt><span class="section"><a href="#id5209840">6.5.3. Primary <code class="command">pmlogger</code> Cannot Start</a></span></dt><dt><span class="section"><a href="#id5210097">6.5.4. Identifying an Active <code class="command">pmlogger</code> Process</a></span></dt><dt><span class="section"><a href="#id5210268">6.5.5. Illegal Label Record</a></span></dt><dt><span class="section"><a href="#id5210389">6.5.6. Empty Archive Log Files or <code class="command">pmlogger</code> Exits Immediately </a></span></dt></dl></dd></dl></div><div class="para">
			<a id="IG31371888239" class="indexterm"></a>Performance monitoring and management in complex systems demands the ability to accurately capture performance characteristics for subsequent review, analysis, and comparison. Performance Co-Pilot (PCP) provides extensive support for the creation and management of archive logs that capture a user-specified profile of performance information to support retrospective performance analysis.
		</div><div class="para">
			The following major sections are included in this chapter:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					<a class="xref" href="#LE43411-PARENT">Section 6.1, “Introduction to Archive Logging”</a>, presents the concepts and issues involved with creating and using archive logs.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE46764-PARENT">Section 6.2, “Using Archive Logs with Performance Tools”</a>, describes the interaction of the PCP tools with archive logs.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE57424-PARENT">Section 6.3, “Cookbook for Archive Logging”</a>, shows some shortcuts for setting up useful PCP archive logs.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#Z930642977sdc">Section 6.4, “Other Archive Logging Features and Services”</a>, provides information about other archive logging features and sevices.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE80113-PARENT">Section 6.5, “Archive Logging Troubleshooting”</a>, presents helpful directions if your archive logging implementation is not functioning correctly.
				</div></li></ul></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE43411-PARENT">
      ⁠</a>6.1. Introduction to Archive Logging</h2></div></div></div><div class="para">
				<a id="ITch07-2" class="indexterm"></a>Within the PCP, the <code class="command">pmlogger</code> utility may be configured to collect archives of performance metrics. The archive creation process is simple and very flexible, incorporating the following features:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						Archive log creation at either a PCP collector (typically a server) or a PCP monitor system (typically a workstation), or at some designated PCP archive logger host.
					</div></li><li class="listitem"><div class="para">
						Concurrent independent logging, both local and remote. The performance analyst can activate a private <code class="command">pmlogger</code> instance to collect only the metrics of interest for the problem at hand, independent of other logging on the workstation or remote host.
					</div></li><li class="listitem"><div class="para">
						Independent determination of logging frequency for individual metrics or metric instances. For example, you could log the “5 minute” load average every half hour, the write I/O rate on the DBMS log spindle every 10 seconds, and aggregate I/O rates on the other disks every minute.
					</div></li><li class="listitem"><div class="para">
						<a id="IG31371888240" class="indexterm"></a><a id="IG31371888241" class="indexterm"></a>Dynamic adjustment of what is to be logged, and how frequently, via <code class="command">pmlc</code>. This feature may be used to disable logging or to increase the sample interval during periods of low activity or chronic high activity. A local <code class="command">pmlc</code> may interrogate and control a remote <code class="command">pmlogger</code>, subject to the access control restrictions implemented by <code class="command">pmlogger</code>.
					</div></li><li class="listitem"><div class="para">
						Self-contained logs that include all system configuration and metadata required to interpret the values in the log. These logs can be kept for analysis at a much later time, potentially after the hardware or software has been reconfigured and the logs have been stored as discrete, autonomous files for remote analysis. The logs are endian-neutral and platform independent - there is no requirement that the monitor host machine used for analysis be similar to the collector machine in any way, nor do they have to have the same versions of PCP. PCP archives created over 15 years ago can still be replayed with the current versions of PCP!
					</div></li><li class="listitem"><div class="para">
						<a id="IG31371888242" class="indexterm"></a><code class="literal">cron</code>-based scripts to expedite the operational management, for example, log rotation, consolidation, and culling. Another helper tool, <code class="command">pmlogconf</code> can be used to generate suitable logging configurations for a variety of situations.
					</div></li><li class="listitem"><div class="para">
						<a id="IG31371888243" class="indexterm"></a><a id="IG31371888244" class="indexterm"></a>Archive folios as a convenient aggregation of multiple archive logs. Archive folios may be created with the <code class="command">mkaf</code> utility and processed with the <code class="command">pmafm</code> tool.
					</div></li></ul></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5206288">
      ⁠</a>6.1.1. Archive Logs and the PMAPI</h3></div></div></div><div class="para">
					<a id="IG31371888245" class="indexterm"></a>Critical to the success of the PCP archive logging scheme is the fact that the library routines providing access to real-time feeds of performance metrics also provide access to the archive logs.
				</div><div class="para">
					<a id="IG31371888246" class="indexterm"></a>Live feeds (or real-time) sources of performance metrics and archives are literally interchangeable, with a single Performance Metrics Application Programming Interface (PMAPI) that preserves the same semantics for both styles of metric source. In this way, applications and tools developed against the PMAPI can automatically process either live or historical performance data.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5206362">
      ⁠</a>6.1.2. Retrospective Analysis Using Archive Logs</h3></div></div></div><div class="para">
					<a id="IG31371888247" class="indexterm"></a><a id="IG31371888248" class="indexterm"></a>One of the most important applications of archive logging services provided by PCP is in the area of retrospective analysis. In many cases, understanding today's performance problems can be assisted by side-by-side comparisons with yesterday's performance. With routine creation of performance archive logs, you can concurrently replay pictures of system performance for two or more periods in the past.
				</div><div class="para">
					Archive logs are also an invaluable source of intelligence when trying to diagnose what went wrong, as in a performance post-mortem. Because the PCP archive logs are entirely self-contained, this analysis can be performed off-site if necessary.
				</div><div class="para">
					Each archive log contains metric values from only one host. However, many PCP tools can simultaneously visualize values from multiple archives collected from different hosts.
				</div><div class="para">
					The archives can be replayed using the inference engine (<code class="command">pmie</code> is an application that uses the PMAPI). This allows you to automate the regular, first-level analysis of system performance.
				</div><div class="para">
					Such analysis can be performed by constructing suitable expressions to capture the essence of common resource saturation problems, then periodically creating an archive and playing it against the expressions. For example, you may wish to create a daily performance audit (perhaps run by the <code class="command">cron</code> command) to detect performance regressions.
				</div><div class="para">
					For more about <code class="command">pmie</code>, see <a class="xref" href="#LE21414-PARENT">Chapter 5, <em>Performance Metrics Inference Engine</em></a>.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5206454">
      ⁠</a>6.1.3. Using Archive Logs for Capacity Planning</h3></div></div></div><div class="para">
					<a id="IG31371888249" class="indexterm"></a><a id="IG31371888250" class="indexterm"></a>By collecting performance archives with relatively long sampling periods, or by reducing the daily archives to produce summary logs, the capacity planner can collect the base data required for forward projections, and can estimate resource demands and explore “what if” scenarios by replaying data using visualization tools and the inference engine.
				</div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE46764-PARENT">
      ⁠</a>6.2. Using Archive Logs with Performance Tools</h2></div></div></div><div class="para">
				<a id="ITch07-4" class="indexterm"></a>Most PCP tools default to real-time display of current values for performance metrics from PCP collector host(s). However, most PCP tools also have the capability to display values for performance metrics retrieved from PCP archive log(s). The following sections describe plans, steps, and general issues involving archive logs and the PCP tools.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5206523">
      ⁠</a>6.2.1. Coordination between <code class="command">pmlogger</code> and PCP tools</h3></div></div></div><div class="para">
					<a id="IG31371888251" class="indexterm"></a>Most commonly, a PCP tool would be invoked with the <code class="literal">-a</code> option to process sets of archive logs some time after <code class="command">pmlogger</code> had finished creating the archive. However, a tool such as <code class="command">pmchart</code> that uses a Time Control dialog (see <a class="xref" href="#LE76997-PARENT">Section 3.3, “Time Duration and Control”</a>) stops when the end of a set of archives is reached, but could resume if more data is written to the PCP archive log.
					<div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							<a id="IG31371888252" class="indexterm"></a><a id="IG31371888253" class="indexterm"></a><a id="IG31371888254" class="indexterm"></a><code class="command">pmlogger</code> uses buffered I/O to write the archive log so that the end of the archive may be aligned with an I/O buffer boundary, rather than with a logical archive log record. If such an archive was read by a PCP tool, it would appear truncated and might confuse the tool. These problems may be avoided by sending <code class="command">pmlogger</code> a <code class="literal">SIGUSR1</code> signal, or by using the <code class="command">flush</code> command of <code class="command">pmlc</code> to force <code class="command">pmlogger</code> to flush its output buffers.
						</div></div></div>
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5206675">
      ⁠</a>6.2.2. Administering PCP Archive Logs Using <code class="command">cron</code> Scripts </h3></div></div></div><div class="para">
					<a id="ITch07-6" class="indexterm"></a><a id="IG31371888255" class="indexterm"></a>Many operating systems support the <code class="literal">cron</code> process scheduling system.
				</div><div class="para">
					<a id="ITch07-7" class="indexterm"></a><a id="IG31371888256" class="indexterm"></a><a id="IG31371888257" class="indexterm"></a><a id="IG31371888258" class="indexterm"></a>PCP supplies shell scripts to use the <code class="literal">cron</code> functionality to help manage your archive logs. The following scripts are supplied:
				</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="bold bold"><strong>Script</strong></span></span></dt><dd><div class="para">
								<span class="bold bold"><strong>Description</strong></span>
							</div></dd><dt><span class="term"><code class="literal">pmlogger_daily(1)</code></span></dt><dd><div class="para">
								Performs a daily housecleaning of archive logs and notices.
							</div></dd><dt><span class="term"><code class="literal">pmlogger_merge(1)</code></span></dt><dd><div class="para">
								<code class="literal"></code>Merges archive logs and is called by <code class="literal">pmlogger_daily</code>.
							</div></dd><dt><span class="term"><code class="literal">pmlogger_check(1)</code></span></dt><dd><div class="para">
								Checks to see that all desired <code class="command">pmlogger</code> processes are running on your system, and invokes any that are missing for any reason.
							</div></dd><dt><span class="term"><code class="literal">pmlogconf(1)</code></span></dt><dd><div class="para">
								Generates suitable <code class="command">pmlogger</code> configuration files based on a pre-defined set of templates. It can probe the state of the system under observation to make informed decisions about which metrics to record. This is an extensible facility, allowing software upgrades and new PMDA installations to add to the existing set of templates.
							</div></dd><dt><span class="term"><code class="command">pmsnap(1)</code></span></dt><dd><div class="para">
								Generates graphic image snapshots of <code class="command">pmchart</code> performance charts at regular intervals.
							</div></dd></dl></div><div class="para">
					<a id="IG31371888259" class="indexterm"></a>The configuration files used by these scripts can be edited to suit your particular needs, and are generally controlled by the <code class="filename">${PCP_PMLOGGERCONTROL_PATH}</code> and <code class="filename">${PCP_PMLOGGERCONTROL_PATH}.d</code> files (<code class="literal">pmsnap</code> has an additional control file, <code class="filename">${PCP_PMSNAPCONTROL_PATH}</code>). Complete information on these scripts is available in the <code class="command">pmlogger_daily(1)</code> and <code class="command">pmsnap(1)</code> man pages.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE92914-PARENT">
      ⁠</a>6.2.3. Archive Log File Management</h3></div></div></div><div class="para">
					<a id="IG31371888260" class="indexterm"></a>PCP archive log files can occupy a great deal of disk space, and management of archive logs can be a large task in itself. The following sections provide information to assist you in PCP archive log file management.
				</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5206941">
      ⁠</a>6.2.3.1. Basename Conventions</h4></div></div></div><div class="para">
						<a id="IG31371888261" class="indexterm"></a>When a PCP archive is created by <code class="command">pmlogger</code>, an archive basename must be specified and several physical files are created, as shown in <a class="xref" href="#id5206972">Table 6.1, “Filenames for PCP Archive Log Components (<code class="literal">archive</code>.<em class="replaceable">*</em>)”</a>.
					</div><div class="table"><a id="id5206972">
      ⁠</a><p class="title"><strong>Table 6.1. Filenames for PCP Archive Log Components (<code class="literal">archive</code>.<em class="replaceable">*</em>)</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols lt-7-rows" summary="Filenames for PCP Archive Log Components (archive.*)"><colgroup><col width="26%" /><col width="74%" /></colgroup><thead><tr valign="top"><th align="left" valign="bottom">
									<div class="para">
										Filename
									</div>
									</th><th align="left" valign="bottom">
									<div class="para">
										Contents
									</div>
									</th></tr></thead><tbody><tr valign="top"><td align="left" valign="top">
									<div class="para">
										<code class="filename">archive.</code><span class="bold bold"><strong></strong></span><em class="replaceable">index</em>
									</div>
									</td><td align="left" valign="top">
									<div class="para">
										Temporal index for rapid access to archive contents.
									</div>
									</td></tr><tr class="even" valign="top"><td align="left" valign="top">
									<div class="para">
										<code class="filename">archive.</code><em class="replaceable">meta</em>
									</div>
									</td><td align="left" valign="top">
									<div class="para">
										Metadata descriptions for performance metrics and instance domains appearing in the archive.
									</div>
									</td></tr><tr valign="top"><td align="left" valign="top">
									<div class="para">
										<code class="filename">archive.N</code>
									</div>
									</td><td align="left" valign="top">
									<div class="para">
										Volumes of performance metrics values, for <code class="filename">N</code> = 0,1,2,...
									</div>
									</td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5207181">
      ⁠</a>6.2.3.2. Log Volumes</h4></div></div></div><div class="para">
						<a id="IG31371888262" class="indexterm"></a>A single PCP archive may be partitioned into a number of volumes. These volumes may expedite management of the archive; however, the metadata file and at least one volume must be present before a PCP tool can process the archive.
					</div><div class="para">
						You can control the size of an archive log volume by using the <code class="literal">-v</code> command line option to <code class="command">pmlogger</code>. This option specifies how large a volume should become before <code class="command">pmlogger</code> starts a new volume. Archive log volumes retain the same base filename as other files in the archive log, and are differentiated by a numeric suffix that is incremented with each volume change. For example, you might have a log volume sequence that looks like this:
					</div><pre class="literallayout">netserver-log.0
netserver-log.1
netserver-log.2</pre><div class="para">
						<a id="IG31371888263" class="indexterm"></a><a id="IG31371888264" class="indexterm"></a>You can also cause an existing log to be closed and a new one to be opened by sending a <code class="literal">SIGHUP</code> signal to <code class="command">pmlogger</code>, or by using the <code class="command">pmlc</code> command to change the <code class="command">pmlogger</code> instructions dynamically, without interrupting <code class="command">pmlogger</code> operation. Complete information on log volumes is found in the <code class="command">pmlogger(1)</code> man page.
					</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5207300">
      ⁠</a>6.2.3.3. Basenames for Managed Archive Log Files</h4></div></div></div><div class="para">
						The PCP archive management tools support a consistent scheme for selecting the basenames for the files in a collection of archives and for mapping these files to a suitable directory hierarchy.
					</div><div class="para">
						Once configured, the PCP tools that manage archive logs employ a consistent scheme for selecting the basename for an archive each time <code class="command">pmlogger</code> is launched, namely the current date and time in the format YYYYMMDD.HH.MM. Typically, at the end of each day, all archives for a particular host on that day would be merged to produce a single archive with a basename constructed from the date, namely YYYYMMDD. The <code class="literal">pmlogger_daily</code> script performs this action and a number of other routine housekeeping chores.
					</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5207335">
      ⁠</a>6.2.3.4. Directory Organization for Archive Log Files</h4></div></div></div><div class="para">
						If you are using a deployment of PCP tools and daemons to collect metrics from a variety of hosts and storing them all at a central location, you should develop an organized strategy for storing and naming your log files.
					</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							<a id="IG31371888265" class="indexterm"></a>There are many possible configurations of <code class="command">pmlogger</code>, as described in <a class="xref" href="#LE56598-PARENT">Section 7.3, “PCP Archive Logger Deployment”</a>. The directory organization described in this section is recommended for any system on which <code class="command">pmlogger</code> is configured for permanent execution (as opposed to short-term executions, for example, as launched from <code class="command">pmchart</code> to record some performance data of current interest).
						</div></div></div><div class="para">
						Typically, the filesystem structure can be used to reflect the number of hosts for which a <code class="command">pmlogger</code> instance is expected to be running locally, obviating the need for lengthy and cumbersome filenames. It makes considerable sense to place all logs for a particular host in a separate directory named after that host. Because each instance of <code class="command">pmlogger</code> can only log metrics fetched from a single host, this also simplifies some of the archive log management and administration tasks.
					</div><div class="para">
						For example, consider the filesystem and naming structure shown in <a class="xref" href="#id5207462">Figure 6.1, “Archive Log Directory Structure”</a>.
					</div><div class="figure"><a id="id5207462">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/log-directory.svg" type="image/svg+xml"><img src="images/log-directory.png" alt="Archive Log Directory Structure" /></object></div></div><p class="title"><strong>Figure 6.1. Archive Log Directory Structure</strong></p></div><div class="para">
						<a id="IG31371888266" class="indexterm"></a>The specification of where to place the archive log files for particular <code class="command">pmlogger</code> instances is encoded in the <code class="filename">${PCP_PMLOGGERCONTROL_PATH}</code> and <code class="filename">${PCP_PMLOGGERCONTROL_PATH}.d</code> configuration files, and these files should be customized on each host running an instance of <code class="command">pmlogger</code>.
					</div><div class="para">
						If many archives are being created, and the associated PCP collector systems form peer classes based upon service type (Web servers, DBMS servers, NFS servers, and so on), then it may be appropriate to introduce another layer into the directory structure, or use symbolic links to group together hosts providing similar service types.
					</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5207540">
      ⁠</a>6.2.3.5. Configuration of <code class="command">pmlogger</code></h4></div></div></div><div class="para">
						<a id="IG31371888267" class="indexterm"></a>The configuration files used by <code class="command">pmlogger</code> describe which metrics are to be logged. Groups of metrics may be logged at different intervals to other groups of metrics. Two states, mandatory and advisory, also apply to each group of metrics, defining whether metrics definitely should be logged or not logged, or whether a later advisory definition may change that state.
					</div><div class="para">
						The mandatory state takes precedence if it is <code class="literal">on</code> or <code class="literal">off</code>, causing any subsequent request for a change in advisory state to have no effect. If the mandatory state is <code class="literal">maybe</code>, then the advisory state determines if logging is enabled or not.
					</div><div class="para">
						The mandatory states are <code class="literal">on</code>, <code class="literal">off</code>, and <code class="literal">maybe</code>. The advisory states, which only affect metrics that are mandatory <code class="literal">maybe</code>, are <code class="literal">on</code> and <code class="literal">off</code>. Therefore, a metric that is mandatory <code class="literal">maybe</code> in one definition and advisory <code class="literal">on</code> in another definition would be logged at the advisory interval. Metrics that are not specified in the <code class="command">pmlogger</code> configuration file are mandatory <code class="literal">maybe</code> and advisory <code class="literal">off</code> by default and are not logged.
					</div><div class="para">
						A complete description of the <code class="command">pmlogger</code> configuration format can be found on the <code class="command">pmlogger(1)</code> man page.
					</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h4 class="title"><a id="id5207708">
      ⁠</a>6.2.3.6. PCP Archive Contents</h4></div></div></div><div class="para">
						<a id="IG31371888268" class="indexterm"></a><a id="IG31371888269" class="indexterm"></a>Once a PCP archive log has been created, the <code class="command">pmdumplog</code> utility may be used to display various information about the contents of the archive. For example, start with the following command:
					</div><div class="para">
						<code class="literal">pmdumplog -l ${PCP_LOG_DIR}/pmlogger/www.sgi.com/19960731</code>
					</div><div class="para">
						It might produce the following output:
					</div><pre class="literallayout">Log Label (Log Format Version 1)
Performance metrics from host www.sgi.com
     commencing Wed Jul 31 00:16:34.941 1996
     ending     Thu Aug  1 00:18:01.468 1996</pre><div class="para">
						The simplest way to discover what performance metrics are contained within a set of archives is to use <code class="literal">pminfo</code> as shown in <a class="xref" href="#Z984165598sdc">Example 6.1, “Using <code class="literal">pminfo</code> to Obtain Archive Information”</a>:
					</div><div class="example"><a id="Z984165598sdc">
      ⁠</a><p class="title"><strong>Example 6.1. Using <code class="literal">pminfo</code> to Obtain Archive Information</strong></p><div class="example-contents"><pre class="literallayout"><code class="literal">pminfo -a ${PCP_LOG_DIR}/pmlogger/www.sgi.com/19960731 network.mbuf</code>
network.mbuf.alloc 
network.mbuf.typealloc
network.mbuf.clustalloc
network.mbuf.clustfree
network.mbuf.failed
network.mbuf.waited
network.mbuf.drained</pre></div></div></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE57424-PARENT">
      ⁠</a>6.3. Cookbook for Archive Logging</h2></div></div></div><div class="para">
				<a id="IG31371888270" class="indexterm"></a><a id="IG31371888271" class="indexterm"></a>The following sections present a checklist of tasks that may be performed to enable PCP archive logging with minimal effort. For a complete explanation, refer to the other sections in this chapter and the man pages for <code class="command">pmlogger </code> and related tools.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5207850">
      ⁠</a>6.3.1. Primary Logger</h3></div></div></div><div class="para">
					<a id="IG31371888272" class="indexterm"></a>Assume you wish to activate primary archive logging on the PCP collector host <code class="literal">pluto</code>. Execute the following while logged into <code class="literal">pluto</code> as the superuser (<code class="literal">root</code>).
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
							Start <code class="command">pmcd</code> and <code class="command">pmlogger</code>:
						</div><pre class="literallayout"><strong class="userinput"><code>chkconfig pmcd on</code></strong>
<strong class="userinput"><code>chkconfig pmlogger on</code></strong>
<strong class="userinput"><code>${PCP_RC_DIR}/pmcd start</code></strong>
Starting pmcd ...
<strong class="userinput"><code>${PCP_RC_DIR}/pmlogger start</code></strong>
Starting pmlogger ...</pre></li><li class="listitem"><div class="para">
							Verify that the primary <code class="command">pmlogger</code> instance is running:
						</div><pre class="literallayout"><strong class="userinput"><code>pcp</code></strong>
Performance Co-Pilot configuration on pluto:

 platform: Linux pluto 3.10.0-0.rc7.64.el7.x86_64 #1 SMP
 hardware: 8 cpus, 2 disks, 23960MB RAM
 timezone: EST-10
     pmcd: Version 3.8.3-1, 8 agents
     pmda: pmcd proc xfs linux mmv infiniband gluster elasticsearch
     <em class="replaceable">pmlogger: primary logger: pluto/20130815.10.00</em>
     pmie: pluto: ${PCP_LOG_DIR}/pmie/pluto/pmie.log
           venus: ${PCP_LOG_DIR}/pmie/venus/pmie.log</pre></li><li class="listitem"><div class="para">
							Verify that the archive files are being created in the expected place:
						</div><pre class="literallayout"><strong class="userinput"><code>ls ${PCP_LOG_DIR}/pmlogger/pluto</code></strong>
20130815.10.00.0
20130815.10.00.index
20130815.10.00.meta
Latest
pmlogger.log</pre></li><li class="listitem"><div class="para">
							Verify that no errors are being logged, and the rate of expected growth of the archives:
						</div><pre class="literallayout"><strong class="userinput"><code>cat ${PCP_LOG_DIR}/pmlogger/pluto/pmlogger.log</code></strong>
Log for pmlogger on pluto started Thu Aug 15 10:00:11 2013

Config parsed
Starting primary logger for host "pluto"
Archive basename: 20130815.00.10

Group [26 metrics] {
	hinv.map.lvname
	...
	hinv.ncpu
} logged once: 1912 bytes

Group [11 metrics] {
	kernel.all.cpu.user
	...
	kernel.all.load
} logged every 60 sec: 372 bytes or 0.51 Mbytes/day

...</pre></li></ol></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5208266">
      ⁠</a>6.3.2. Other Logger Configurations</h3></div></div></div><div class="para">
					Assume you wish to create archive logs on the local host for performance metrics collected from the remote host <code class="literal">venus</code>. Execute all of the following tasks while logged into the local host as the superuser (<code class="literal">root</code>).
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="id5208288">
      ⁠</a><p class="title"><strong>Procedure 6.1. Creating Archive Logs</strong></p><ol class="1"><li class="step"><div class="para">
							Create a suitable <code class="command">pmlogger</code> configuration file. There are several options:
						</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
									Run the <code class="command">pmlogconf(1)</code> utility to generate a configuration file, and (optionally) interactively customize it further to suit local needs.
								</div><pre class="literallayout"><strong class="userinput"><code>${PCP_BINADM_DIR}/pmlogconf ${PCP_SYSCONF_DIR}/pmlogger/config.venus</code></strong>
Creating config file "${PCP_SYSCONF_DIR}/pmlogger/config.venus" using default settings

<strong class="userinput"><code>${PCP_BINADM_DIR}/pmlogconf ${PCP_SYSCONF_DIR}/pmlogger/config.venus</code></strong>

Group: utilization per CPU
Log this group? [n] y
Logging interval? [default] 

Group: utilization (usr, sys, idle, ...) over all CPUs
Log this group? [y] y
Logging interval? [default] 

Group: per spindle disk activity
Log this group? [n] y

...</pre></li><li class="listitem"><div class="para">
									Do nothing - a default configuration will be created in the following step, using <code class="command">pmlogconf(1)</code> probing and automatic file generation based on the metrics available at the remote host. The <code class="filename">${PCP_RC_DIR}/pmlogger</code> start script handles this.
								</div></li><li class="listitem"><div class="para">
									Manually - create a configuration file with a text editor, or arrange to have one put in place by configuration management tools like <a href="https://puppetlabs.com/">Puppet</a> or <a href="http://www.opscode.com/chef/">Chef</a>.
								</div></li></ul></div></li><li class="step"><div class="para">
							Edit <code class="filename">${PCP_PMLOGGERCONTROL_PATH}</code>, or one of the <code class="filename">${PCP_PMLOGGERCONTROL_PATH}.d</code> files. Using the line for <code class="literal">remote</code> as a template, add the following line:
						</div><pre class="literallayout"><strong class="userinput"><code>venus n n PCP_LOG_DIR/pmlogger/venus -r -T24h10m -c config.venus</code></strong></pre></li><li class="step"><div class="para">
							Start <code class="command">pmlogger</code>:
						</div><pre class="literallayout"><strong class="userinput"><code>${PCP_BINADM_DIR}/pmlogger_check</code></strong>
Restarting pmlogger for host "venus" ..... done</pre></li><li class="step"><div class="para">
							Verify that the <code class="command">pmlogger</code> instance is running:
						</div><pre class="literallayout"><strong class="userinput"><code>pcp</code></strong>
Performance Co-Pilot configuration on pluto:

 platform: Linux pluto 3.10.0-0.rc7.64.el7.x86_64 #1 SMP
 hardware: 8 cpus, 2 disks, 23960MB RAM
 timezone: EST-10
     pmcd: Version 3.8.3-1, 8 agents
     pmda: pmcd proc linux xfs mmv infiniband gluster elasticsearch
     <em class="replaceable">pmlogger: primary logger: pluto/20130815.10.00</em>
           <em class="replaceable">venus.redhat.com: venus/20130815.11.15</em>
<strong class="userinput"><code>pmlc</code></strong>
pmlc&gt; <strong class="userinput"><code>show loggers</code></strong>
The following pmloggers are running on pluto:
        primary (19144) 5141
pmlc&gt; <strong class="userinput"><code>connect 5141</code></strong>
pmlc&gt; <strong class="userinput"><code>status</code></strong>
<em class="replaceable">pmlogger [5141] on host pluto is logging metrics from host venus</em>
log started      Thu Aug 15 11:15:39 2013 (times in local time)
last log entry   Thu Aug 15 11:47:39 2013
current time     Thu Aug 15 11:48:13 2013
log volume       0
log size         146160</pre></li></ol></div><div class="para">
					To create archive logs on the local host for performance metrics collected from multiple remote hosts, repeat the steps in <a class="xref" href="#id5208288">Procedure 6.1, “Creating Archive Logs”</a> for each remote host (each with a new <code class="filename">control</code> file entry).
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5208588">
      ⁠</a>6.3.3. Archive Log Administration</h3></div></div></div><div class="para">
					<a id="IG31371888290" class="indexterm"></a>Assume the local host has been set up to create archive logs of performance metrics collected from one or more hosts (which may be either the local host or a remote host).
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						Depending on your platform, the <code class="command">crontab</code> entry discussed here may already have been installed for you, as part of the package installation process. In this case, the file <code class="filename">/etc/cron.d/pcp-pmlogger</code> will exist, and the rest of this section can be skipped.
					</div></div></div><div class="para">
					To activate the maintenance and housekeeping scripts for a collection of archive logs, execute the following tasks while logged into the local host as the superuser (<code class="literal">root</code>):
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
							Augment the <code class="filename">crontab</code> file for the <code class="literal">pcp</code> user. For example:
						</div><pre class="literallayout"><strong class="userinput"><code>crontab -l -u pcp &gt; ${HOME}/crontab.txt</code></strong></pre></li><li class="listitem"><div class="para">
							Edit <code class="filename">${HOME}/crontab.txt</code>, adding lines similar to those from the sample <code class="filename">${PCP_VAR_DIR}/config/pmlogger/crontab</code> file for <code class="literal">pmlogger_daily</code> and <code class="literal">pmlogger_check</code>; for example:
						</div><pre class="literallayout"># daily processing of archive logs
10     0     *     *     *    ${PCP_BINADM_DIR}/pmlogger_daily
# every 30 minutes, check pmlogger instances are running
25,55  *     *     *     *    ${PCP_BINADM_DIR}/pmlogger_check</pre></li><li class="listitem"><div class="para">
							Make these changes permanent with this command:
						</div><pre class="literallayout"><strong class="userinput"><code>crontab -u pcp &lt; ${HOME}/crontab.txt</code></strong></pre></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="Z930642977sdc">
      ⁠</a>6.4. Other Archive Logging Features and Services</h2></div></div></div><div class="para">
				Other archive logging features and services include PCP archive folios, manipulating archive logs, primary logger, and using <code class="command">pmlc</code>.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE73509-PARENT">
      ⁠</a>6.4.1. PCP Archive Folios</h3></div></div></div><div class="para">
					<a id="ITch07-9" class="indexterm"></a><a id="IG31371888291" class="indexterm"></a><a id="IG31371888292" class="indexterm"></a><a id="IG31371888293" class="indexterm"></a>A collection of one or more sets of PCP archive logs may be combined with a control file to produce a PCP archive folio. Archive folios are created using either <code class="literal">mkaf</code> or the interactive record mode services of various PCP monitor tools (e.g. <code class="command">pmchart</code> and <code class="command">pmcollectl</code>).
				</div><div class="para">
					<a id="IG31371888294" class="indexterm"></a>The automated archive log management services also create an archive folio named <code class="filename">Latest</code> for each managed <code class="command">pmlogger </code> instance, to provide a symbolic name to the most recent archive log. With reference to <a class="xref" href="#id5207462">Figure 6.1, “Archive Log Directory Structure”</a>, this would mean the creation of the folios <code class="filename">${PCP_LOG_DIR}/pmlogger/one/Latest</code> and <code class="filename">${PCP_LOG_DIR}/pmlogger/two/Latest</code>.
				</div><div class="para">
					<a id="IG31371888295" class="indexterm"></a>The <code class="command">pmafm</code> utility is completely described in the <code class="command">pmafm(1)</code> man page, and provides the interactive commands (single commands may also be executed from the command line) for the following services:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							Checking the integrity of the archives in the folio.
						</div></li><li class="listitem"><div class="para">
							Displaying information about the component archives.
						</div></li><li class="listitem"><div class="para">
							Executing PCP tools with their source of performance metrics assigned concurrently to all of the component archives (where the tool supports this), or serially executing the PCP tool once per component archive.
						</div></li><li class="listitem"><div class="para">
							If the folio was created by a single PCP monitoring tool, replaying all of the archives in the folio with that monitoring tool.
						</div></li><li class="listitem"><div class="para">
							Restricting the processing to particular archives, or the archives associated with particular hosts.
						</div></li></ul></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5208950">
      ⁠</a>6.4.2. Manipulating Archive Logs with <code class="command">pmlogextract</code></h3></div></div></div><div class="para">
					<a id="ITch07-10" class="indexterm"></a> The <code class="literal">pmlogextract</code> tool takes a number of PCP archive logs from a single host and performs the following tasks:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							Merges the archives into a single log, while maintaining the correct time stamps for all values.
						</div></li><li class="listitem"><div class="para">
							Extracts all metric values within a temporal window that could encompass several archive logs.
						</div></li><li class="listitem"><div class="para">
							Extracts only a configurable subset of metrics from the archive logs.
						</div></li></ul></div><div class="para">
					See the <code class="command">pmlogextract(1)</code> man page for full information on this command.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5208951">
      ⁠</a>6.4.3. Summarizing Archive Logs with <code class="command">pmlogsummary</code></h3></div></div></div><div class="para">
					<a id="ITch07-11" class="indexterm"></a> The <code class="literal">pmlogsummary</code> tool provides statistical summaries of archives, or specific metrics within archives, or specific time windows of interest in a set of archives. These summaries include various averages, minima, maxima, sample counts, histogram bins, and so on.
				</div><div class="para">
					As an example, for Linux host <code class="literal">pluto</code>, report on its use of anonymous huge pages - average use, maximum, time at which maximum occured, total number of samples in the set of archives, and the units used for the values - as shown in <a class="xref" href="#Z984165598nat">Example 6.2, “Using <code class="literal">pmlogsummary</code> to Summarize Archive Information”</a>:
				</div><div class="example"><a id="Z984165598nat">
      ⁠</a><p class="title"><strong>Example 6.2. Using <code class="literal">pmlogsummary</code> to Summarize Archive Information</strong></p><div class="example-contents"><pre class="literallayout"><strong class="userinput"><code>pmlogsummary -MIly ${PCP_LOG_DIR}/pmlogger/pluto/20130815 mem.util.anonhugepages</code></strong>
Performance metrics from host pluto
  commencing Thu Aug 15 00:10:12.318 2013
  ending     Fri Aug 16 00:10:12.299 2013

mem.util.anonhugepages  7987742.326 8116224.000 15:02:12.300 1437 Kbyte

<strong class="userinput"><code>pminfo -t mem.util.anonhugepages</code></strong>
mem.util.anonhugepages [amount of memory in anonymous huge pages]</pre></div></div><div class="para">
					See the <code class="command">pmlogsummary(1)</code> man page for detailed information about this commands many options.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5209027">
      ⁠</a>6.4.4. Primary Logger</h3></div></div></div><div class="para">
					<a id="ITch07-14" class="indexterm"></a><a id="ITch07-16" class="indexterm"></a>On each system for which PMCD is active (each PCP collector system), there is an option to have a distinguished instance of the archive logger <code class="command">pmlogger</code> (the “primary” logger) launched each time PMCD is started. This may be used to ensure the creation of minimalist archive logs required for ongoing system management and capacity planning in the event of failure of a system where a remote <code class="command">pmlogger</code> may be running, or because the preferred archive logger deployment is to activate <code class="command">pmlogger</code> on each PCP collector system.
				</div><div class="para">
					Run the following command as superuser on each PCP collector system where you want to activate the primary <code class="command">pmlogger</code>:
				</div><pre class="literallayout"><strong class="userinput"><code>chkconfig pmlogger on</code></strong></pre><div class="para">
					The primary logger launches the next time the <code class="command">${PCP_RC_DIR}/pmlogger start</code> script runs. If you wish this to happen immediately, follow up with this command:
				</div><pre class="literallayout"><strong class="userinput"><code>${PCP_BINADM_DIR}/pmlogger_check -V</code></strong></pre><div class="para">
					<a id="IG31371888296" class="indexterm"></a><a id="IG31371888297" class="indexterm"></a>When it is started in this fashion, the <code class="filename">${PCP_PMLOGGERCONTROL_PATH}</code> file (or one of the <code class="filename">${PCP_PMLOGGERCONTROL_PATH}.d</code> files) must use the second field of one configuration line to designate the primary logger, and usually will also use the <code class="command">pmlogger</code> configuration file <code class="filename">${PCP_SYSCONF_DIR}/pmlogger/config.default</code> (although the latter is not mandatory).
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5209191">
      ⁠</a>6.4.5. Using <code class="command">pmlc</code></h3></div></div></div><div class="para">
					<a id="IG31371888298" class="indexterm"></a><a id="ITch07-17" class="indexterm"></a>You may tailor <code class="command">pmlogger</code> dynamically with the <code class="command">pmlc</code> command (if it is configured to allow access to this functionality). Normally, the <code class="command">pmlogger</code> configuration is read at startup. If you choose to modify the <code class="filename">config</code> file to change the parameters under which <code class="command">pmlogger</code> operates, you must stop and restart the program for your changes to have effect. Alternatively, you may change parameters whenever required by using the <code class="command">pmlc</code> interface.
				</div><div class="para">
					To run the <code class="command">pmlc</code> tool, enter:
				</div><pre class="literallayout"><strong class="userinput"><code>pmlc</code></strong></pre><div class="para">
					By default, <code class="command">pmlc</code> acts on the primary instance of <code class="command">pmlogger</code> on the current host. See the <code class="command">pmlc(1)</code> man page for a description of command line options. When it is invoked, <code class="command">pmlc</code> presents you with a prompt:
				</div><pre class="literallayout">pmlc&gt;</pre><div class="para">
					You may obtain a listing of the available commands by entering a question mark (?) and pressing <span class="keycap"><strong>Enter</strong></span>. You see output similar to that in <a class="xref" href="#Z984165791sdc">Example 6.3, “Listing Available Commands ”</a>:
				</div><div class="example"><a id="Z984165791sdc">
      ⁠</a><p class="title"><strong>Example 6.3. Listing Available Commands </strong></p><div class="example-contents"><pre class="literallayout">     show loggers [@&lt;host&gt;]           display &lt;pid&gt;s of running pmloggers
     connect _logger_id [@&lt;host&gt;]     connect to designated pmlogger
     status                           information about connected pmlogger
     query metric-list                show logging state of metrics
     new volume                       start a new log volume
     flush                            flush the log buffers to disk
     log { mandatory | advisory } on &lt;interval&gt; _metric-list
     log { mandatory | advisory } off _metric-list
     log mandatory maybe _metric-list
     timezone local|logger|'&lt;timezone&gt;' change reporting timezone
     help                               print this help message
     quit                               exit from pmlc
     _logger_id   is  primary | &lt;pid&gt; | port &lt;n&gt;
     _metric-list is  _metric-spec | { _metric-spec ... }
     _metric-spec is  &lt;metric-name&gt; | &lt;metric-name&gt; [ &lt;instance&gt; ... ]</pre><div class="para">
						Here is an example:
					</div><pre class="literallayout"><strong class="userinput"><code>pmlc</code></strong>
pmlc&gt; <strong class="userinput"><code>show loggers @babylon</code></strong>
The following pmloggers are running on babylon:
       primary (1892)
pmlc&gt; <strong class="userinput"><code>connect 1892 @babylon</code></strong>
pmlc&gt; <strong class="userinput"><code>log advisory on 2 secs disk.dev.read</code></strong>
pmlc&gt; <strong class="userinput"><code>query disk.dev</code></strong>
disk.dev.read
       adv  on  nl       5 min  [131073 or “disk1”]
       adv  on  nl       5 min  [131074 or “disk2”]
pmlc&gt; <strong class="userinput"><code>quit</code></strong></pre></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						Any changes to the set of logged metrics made via <code class="command">pmlc</code> are not saved, and are lost the next time <code class="command">pmlogger</code> is started with the same configuration file. Permanent changes are made by modifying the <code class="command">pmlogger</code> configuration file(s).
					</div></div></div><div class="para">
					Refer to the <code class="command">pmlc(1)</code> and <code class="command">pmlogger(1)</code> man pages for complete details.
				</div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE80113-PARENT">
      ⁠</a>6.5. Archive Logging Troubleshooting</h2></div></div></div><div class="para">
				<a id="ITch07-19" class="indexterm"></a><a id="IG31371888299" class="indexterm"></a><a id="IG31371888300" class="indexterm"></a>The following issues concern the creation and use of logs using <code class="command">pmlogger</code>.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5209540">
      ⁠</a>6.5.1. <code class="command">pmlogger</code> Cannot Write Log</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Symptom:</span></dt><dd><div class="para">
								The <code class="command">pmlogger</code> utility does not start, and you see this message:
							</div><pre class="literallayout"><code class="literal">__pmLogNewFile: “foo.index” already exists, not over-written</code></pre></dd><dt><span class="term">Cause:</span></dt><dd><div class="para">
								Archive logs are considered sufficiently precious that <code class="command">pmlogger</code> does not empty or overwrite an existing set of archive log files. The log named <code class="filename">foo</code> actually consists of the physical file <code class="filename">foo.index</code>, <code class="filename">foo.meta</code>, and at least one file <code class="filename">foo.N</code>, where <code class="filename">N</code> is in the range 0, 1, 2, 3, and so on.
							</div><div class="para">
								A message similar to the one above is produced when a new <code class="command">pmlogger</code> instance encounters one of these files already in existence.
							</div></dd><dt><span class="term">Resolution:</span></dt><dd><div class="para">
								Move the existing archive aside, or if you are sure, remove all of the parts of the archive log. For example, use the following command:
<pre class="literallayout"><strong class="userinput"><code>rm -f foo.*</code></strong></pre>
							</div><div class="para">
								Then rerun <code class="command">pmlogger</code>.
							</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5209654">
      ⁠</a>6.5.2. Cannot Find Log</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Symptom:</span></dt><dd><div class="para">
								<a id="ITch07-23" class="indexterm"></a>The <code class="literal">pmdumplog</code> utility, or any tool that can read an archive log, displays this message:
							</div><pre class="literallayout"><code class="literal">Cannot open archive mylog: No such file or directory</code></pre></dd><dt><span class="term">Cause:</span></dt><dd><div class="para">
								An archive consists of at least three physical files. If the base name for the archive is <code class="filename">mylog</code>, then the archive actually consists of the physical files <code class="filename">mylog.index</code>, <code class="filename">mylog.meta</code>, and at least one file <code class="filename">mylog.N</code>, where <code class="filename">N</code> is in the range 0, 1, 2, 3, and so on.
							</div><div class="para">
								The above message is produced if one or more of the files is missing.
							</div></dd><dt><span class="term">Resolution:</span></dt><dd><div class="para">
								Use this command to check which files the utility is trying to open:
							</div><div class="para">
								
<pre class="literallayout"><strong class="userinput"><code>ls mylog.*</code></strong></pre>
							</div><div class="para">
								Turn on the internal debug flag <code class="literal">DBG_TRACE_LOG</code> (<code class="literal">-D</code> 128) to see which files are being inspected by the <code class="literal">pmOpenLog</code> routine as shown in the following example:
<pre class="literallayout"><strong class="userinput"><code>pmdumplog -D 128 -l mylog</code></strong></pre>
							</div><div class="para">
								Locate the missing files and move them all to the same directory, or remove all of the files that are part of the archive, and recreate the archive log.
							</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5209840">
      ⁠</a>6.5.3. Primary <code class="command">pmlogger</code> Cannot Start</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Symptom:</span></dt><dd><div class="para">
								The primary <code class="command">pmlogger</code> cannot be started. A message like the following appears:
							</div><pre class="literallayout"><code class="literal">pmlogger: there is already a primary pmlogger running</code></pre></dd><dt><span class="term">Cause:</span></dt><dd><div class="para">
								There is either a primary <code class="command">pmlogger</code> already running, or the previous primary <code class="command">pmlogger</code> was terminated unexpectedly before it could perform its cleanup operations.
							</div></dd><dt><span class="term">Resolution:</span></dt><dd><div class="para">
								<a id="IG31371888301" class="indexterm"></a><a id="IG31371888302" class="indexterm"></a><a id="IG31371888303" class="indexterm"></a><a id="IG31371888304" class="indexterm"></a>If there is already a primary <code class="command">pmlogger</code> running and you wish to replace it with a new <code class="command">pmlogger</code>, use the <code class="literal">show</code> command in <code class="command">pmlc</code> to determine the process ID of the primary <code class="command">pmlogger</code>. The process ID of the primary <code class="command">pmlogger</code> appears in parentheses after the word “primary.” Send a <code class="literal">SIGINT</code> signal to the process to shut it down (use either the <code class="command">kill</code> command if the platform supports it, or the <code class="command">pmsignal</code> command). If the process does not exist, proceed to the manual cleanup described in the paragraph below. If the process did exist, it should now be possible to start the new <code class="command">pmlogger</code>.
							</div><div class="para">
								If <code class="command">pmlc</code>'s <code class="command">show</code> command displays a process ID for a process that does not exist, a <code class="command">pmlogger</code> process was terminated before it could clean up. If it was the primary <code class="command">pmlogger</code>, the corresponding control files must be removed before one can start a new primary <code class="command">pmlogger</code>. It is a good idea to clean up any spurious control files even if they are not for the primary <code class="command">pmlogger</code>.
							</div><div class="para">
								<a id="IG31371888305" class="indexterm"></a>The control files are kept in <code class="filename">${PCP_TMP_DIR}/pmlogger</code>. A control file with the process ID of the <code class="command">pmlogger</code> as its name is created when the <code class="command">pmlogger</code> is started. In addition, the primary <code class="command">pmlogger</code> creates a symbolic link named <code class="literal">primary</code> to its control file.
							</div><div class="para">
								For the primary <code class="command">pmlogger</code>, remove both the symbolic link and the file (corresponding to its process ID) to which the link points. For other <code class="command">pmlogger</code>s, remove just the process ID file. Do not remove any other files in the directory. If the control file for an active <code class="command">pmlogger</code> is removed, <code class="command">pmlc</code> is not able to contact it.
							</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5210097">
      ⁠</a>6.5.4. Identifying an Active <code class="command">pmlogger</code> Process</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Symptom:</span></dt><dd><div class="para">
								<a id="IG31371888306" class="indexterm"></a>You have a PCP archive log that is demonstrably growing, but do not know the identify of the associated <code class="command">pmlogger</code> process.
							</div></dd><dt><span class="term">Cause:</span></dt><dd><div class="para">
								The PID is not obvious from the log, or the archive name may not be obvious from the output of the <code class="command">ps</code> command.
							</div></dd><dt><span class="term">Resolution:</span></dt><dd><div class="para">
								If the archive basename is <code class="filename">foo</code>, run the following commands:
							</div><pre class="literallayout"><strong class="userinput"><code>pmdumplog -l foo</code></strong>
<code class="literal">Log Label (Log Format Version 1)</code>
Performance metrics from host gonzo 
     commencing Wed Aug  7 00:10:09.214 1996 
     ending     Wed Aug  7 16:10:09.155 1996 

<strong class="userinput"><code>pminfo -a foo -f pmcd.pmlogger</code></strong> 
pmcd.pmlogger.host
     inst [10728 or "10728"] value "gonzo"
pmcd.pmlogger.port
     inst [10728 or "10728"] value 4331
pmcd.pmlogger.archive
     inst [10728 or "10728"] value "<em class="replaceable">/usr/var/adm/pcplog/gonzo/foo</em>"</pre><div class="para">
								All of the information describing the creator of the archive is revealed and, in particular, the instance identifier for the PMCD metrics (<code class="literal">10728</code> in the example above) is the PID of the <code class="command">pmlogger</code> instance, which may be used to control the process via <code class="command">pmlc</code>.
							</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5210268">
      ⁠</a>6.5.5. Illegal Label Record</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Symptom:</span></dt><dd><div class="para">
								<a id="IG31371888307" class="indexterm"></a>PCP tools report:
							</div><pre class="literallayout">Illegal label record at start of PCP archive log file.</pre></dd><dt><span class="term">Cause:</span></dt><dd><div class="para">
								The label record at the start of each of the physical archive log files has become either corrupted or one is out of sync with the others.
							</div></dd><dt><span class="term">Resolution:</span></dt><dd><div class="para">
								If you believe the log may have been corrupted, this can be verified using <code class="command">pmlogcheck</code>. If corruption is limited to just the label record at the start, the <code class="command">pmloglabel</code> can be used to force the labels back in sync with each other, with known-good values that you supply.
							</div><div class="para">
								Refer to the <code class="command">pmlogcheck(1)</code> and <code class="command">pmloglabel(1)</code> man pages.
							</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5210389">
      ⁠</a>6.5.6. Empty Archive Log Files or <code class="command">pmlogger</code> Exits Immediately </h3></div></div></div><div class="variablelist"><a id="Z930351569sdc">
      ⁠</a><dl class="variablelist"><dt><span class="term">Symptom:</span></dt><dd><div class="para">
								Archive log files are zero size, requested metrics are not being logged, or <code class="command">pmlogger</code> exits immediately with no error messages.
							</div></dd><dt><span class="term">Cause:</span></dt><dd><div class="para">
								Either <code class="command">pmlogger</code> encountered errors in the configuration file, has not flushed its output buffers yet, or some (or all) metrics specified in the <code class="command">pmlogger</code> configuration file have had their state changed to advisory <code class="literal">off</code> or mandatory <code class="literal">off</code> via <code class="command">pmlc</code>. It is also possible that the logging interval specified in the <code class="command">pmlogger</code> configuration file for some or all of the metrics is longer than the period of time you have been waiting since <code class="command">pmlogger</code> started.
							</div></dd><dt><span class="term">Resolution:</span></dt><dd><div class="para">
								If <code class="command">pmlogger</code> exits immediately with no error messages, check the <code class="filename">pmlogger.log</code> file in the directory <code class="command">pmlogger</code> was started in for any error messages. If <code class="command">pmlogger</code> has not yet flushed its buffers, enter one of the following commands (depending on platform support): 
<pre class="literallayout">killall -SIGUSR1 pmlogger
${PCP_BINADM_DIR}/pmsignal -a -s USR1 pmlogger</pre>
							</div><div class="para">
								Otherwise, use the <code class="literal">status</code> command for <code class="command">pmlc</code> to interrogate the internal <code class="command">pmlogger</code> state of specific metrics.
							</div></dd></dl></div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="LE83321-PARENT">
      ⁠</a>Chapter 7. Performance Co-Pilot Deployment Strategies</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#LE85282-PARENT">7.1. Basic Deployment</a></span></dt><dt><span class="section"><a href="#LE69500-PARENT">7.2. PCP Collector Deployment</a></span></dt><dd><dl><dt><span class="section"><a href="#id5210938">7.2.1. Principal Server Deployment</a></span></dt><dt><span class="section"><a href="#id5211030">7.2.2. Quality of Service Measurement</a></span></dt></dl></dd><dt><span class="section"><a href="#LE56598-PARENT">7.3. PCP Archive Logger Deployment</a></span></dt><dd><dl><dt><span class="section"><a href="#id5211332">7.3.1. Deployment Options</a></span></dt><dt><span class="section"><a href="#id5211434">7.3.2. Resource Demands for the Deployment Options</a></span></dt><dt><span class="section"><a href="#id5211489">7.3.3. Operational Management</a></span></dt><dt><span class="section"><a href="#id5211573">7.3.4. Exporting PCP Archive Logs</a></span></dt></dl></dd><dt><span class="section"><a href="#LE62310-PARENT">7.4. PCP Inference Engine Deployment</a></span></dt><dd><dl><dt><span class="section"><a href="#id5211669">7.4.1. Deployment Options</a></span></dt><dt><span class="section"><a href="#id5211825">7.4.2. Resource Demands for the Deployment Options</a></span></dt><dt><span class="section"><a href="#id5211850">7.4.3. Operational Management</a></span></dt></dl></dd></dl></div><div class="para">
			<a id="IG31371888308" class="indexterm"></a>Performance Co-Pilot (PCP) is a coordinated suite of tools and utilities allowing you to monitor performance and make automated judgments and initiate actions based on those judgments. PCP is designed to be fully configurable for custom implementation and deployed to meet specific needs in a variety of operational environments.
		</div><div class="para">
			Because each enterprise and site is different and PCP represents a new way of managing performance information, some discussion of deployment strategies is useful.
		</div><div class="para">
			<a id="IG31371888309" class="indexterm"></a><a id="IG31371888310" class="indexterm"></a>The most common use of performance monitoring utilities is a scenario where the PCP tools are executed on a workstation (the PCP monitoring system), while the interesting performance data is collected on remote systems (PCP collector systems) by a number of processes, specifically the Performance Metrics Collection Daemon (PMCD) and the associated Performance Metrics Domain Agents (PMDAs). These processes can execute on both the monitoring system and one or more collector systems, or only on collector systems. However, collector systems are the real objects of performance investigations.
		</div><div class="para">
			The material in this chapter covers the following areas:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					<a class="xref" href="#LE85282-PARENT">Section 7.1, “Basic Deployment”</a>, presents the spectrum of deployment architectures at the highest level.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE69500-PARENT">Section 7.2, “PCP Collector Deployment”</a>, describes alternative deployments for PMCD and the PMDAs.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE56598-PARENT">Section 7.3, “PCP Archive Logger Deployment”</a>, covers alternative deployments for the <code class="command">pmlogger</code> tool.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE62310-PARENT">Section 7.4, “PCP Inference Engine Deployment”</a>, presents the options that are available for deploying the <code class="command">pmie</code> tool.
				</div></li></ul></div><div class="para">
			The options shown in this chapter are merely suggestions. They are not comprehensive, and are intended to demonstrate some possible ways of deploying the PCP tools for specific network topologies and purposes. You are encouraged to use them as the basis for planning your own deployment, consistent with your needs.
		</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE85282-PARENT">
      ⁠</a>7.1. Basic Deployment</h2></div></div></div><div class="para">
				In the simplest PCP deployment, one system is configured as both a collector and a monitor, as shown in <a class="xref" href="#id5210776">Figure 7.1, “PCP Deployment for a Single System”</a>. Because some of the PCP monitor tools make extensive use of visualization, this suggests the monitor system should be configured with a graphical display.
			</div><div class="figure"><a id="id5210776">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/local-deploy.svg" type="image/svg+xml"><img src="images/local-deploy.png" alt="PCP Deployment for a Single System" /></object></div></div><p class="title"><strong>Figure 7.1. PCP Deployment for a Single System</strong></p></div><div class="para">
				However, most PCP deployments involve at least two systems. For example, the setup shown in <a class="xref" href="#id5210808">Figure 7.2, “Basic PCP Deployment for Two Systems”</a> would be representative of many common scenarios.
			</div><div class="figure"><a id="id5210808">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/remote-deploy.svg" type="image/svg+xml"><img src="images/remote-deploy.png" alt="Basic PCP Deployment for Two Systems" /></object></div></div><p class="title"><strong>Figure 7.2. Basic PCP Deployment for Two Systems</strong></p></div><div class="para">
				But the most common site configuration would include a mixture of systems configured as PCP collectors, as PCP monitors, and as both PCP monitors and collectors, as shown in <a class="xref" href="#id5210866">Figure 7.3, “General PCP Deployment for Multiple Systems ”</a>.
			</div><div class="para">
				With one or more PCP collector systems and one or more PCP monitor systems, there are a number of decisions that need to be made regarding the deployment of PCP services across multiple hosts. For example, in <a class="xref" href="#id5210866">Figure 7.3, “General PCP Deployment for Multiple Systems ”</a> there are several ways in which both the inference engine (<code class="command">pmie</code>) and the PCP archive logger (<code class="command">pmlogger</code>) could be deployed. These options are discussed in the following sections of this chapter.
			</div><div class="figure"><a id="id5210866">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/multi-deploy.svg" type="image/svg+xml"><img src="images/multi-deploy.png" alt="General PCP Deployment for Multiple Systems " /></object></div></div><p class="title"><strong>Figure 7.3. General PCP Deployment for Multiple Systems </strong></p></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE69500-PARENT">
      ⁠</a>7.2. PCP Collector Deployment</h2></div></div></div><div class="para">
				<a id="ITch08-0" class="indexterm"></a>Each PCP collector system must have an active <code class="literal">pmcd</code> and, typically, a number of PMDAs installed.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5210938">
      ⁠</a>7.2.1. Principal Server Deployment</h3></div></div></div><div class="para">
					The first hosts selected as PCP collector systems are likely to provide some class of service deemed to be critical to the information processing activities of the enterprise. These hosts include:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							Database servers
						</div></li><li class="listitem"><div class="para">
							Web servers for an Internet or Intranet presence
						</div></li><li class="listitem"><div class="para">
							NFS or other central storage server
						</div></li><li class="listitem"><div class="para">
							A video server
						</div></li><li class="listitem"><div class="para">
							A supercomputer
						</div></li><li class="listitem"><div class="para">
							An infrastructure service provider, for example, print, DNS, LDAP, gateway, firewall, router, or mail services
						</div></li><li class="listitem"><div class="para">
							Any system running a mission-critical application
						</div></li></ul></div><div class="para">
					Your objective may be to improve quality of service on a system functioning as a server for many clients. You wish to identify and repair critical performance bottlenecks and deficiencies in order to maintain maximum performance for clients of the server.
				</div><div class="para">
					For some of these services, the PCP base product or the PCP add-on packages provide the necessary collector components. Others would require customized PMDA development, as described in the companion <em class="citetitle">Performance Co-Pilot Programmer's Guide</em>.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5211030">
      ⁠</a>7.2.2. Quality of Service Measurement</h3></div></div></div><div class="para">
					<a id="IG31371888311" class="indexterm"></a>Applications and services with a client-server architecture need to monitor performance at both the server side and the client side.
				</div><div class="para">
					The arrangement in <a class="xref" href="#id5211102">Figure 7.4, “PCP Deployment to Measure Client-Server Quality of Service”</a> illustrates one way of measuring quality of service for client-server applications.
				</div><div class="figure"><a id="id5211102">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/qos-deploy.svg" type="image/svg+xml"><img src="images/qos-deploy.png" alt="PCP Deployment to Measure Client-Server Quality of Service" /></object></div></div><p class="title"><strong>Figure 7.4. PCP Deployment to Measure Client-Server Quality of Service</strong></p></div><div class="para">
					The configuration of the PCP collector components on the Application Server System is standard. The new facility is the deployment of some PCP collector components on the Application Client System; this uses a customized PMDA and a generalization of the ICMP “ping” tool as follows:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							The <code class="literal">Client App</code> is specially developed to periodically make typical requests of the <code class="literal">App Server</code>, and to measure the response time for these requests (this is an application-specific “ping”).
						</div></li><li class="listitem"><div class="para">
							The PMDA on the Application Client System captures the response time measurements from the <code class="literal">Client App</code> and exports these into the PCP framework.
						</div></li></ul></div><div class="para">
					At the PCP monitor system, the performance of the system running the <code class="literal">App Server</code> and the end-user quality of service measurements from the system where the <code class="literal">Client App</code> is running can be monitored concurrently.
				</div><div class="para">
					PCP contains a number of examples of this architecture, including the <code class="literal">shping</code> PMDA for IP-based services (including HTTP), and the <code class="literal">dbping</code> PMDA for database servers.
				</div><div class="para">
					The source code for each of these PMDAs is readily available; users and administrators are encouraged to adapt these agents to the needs of the local application environment.
				</div><div class="para">
					It is possible to exploit this arrangement even further, with these methods:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							Creating new instances of the <code class="literal">Client App</code> and PMDA to measure service quality for your own mission-critical services.
						</div></li><li class="listitem"><div class="para">
							Deploying the <code class="literal">Client App</code> and associated PCP collector components in a number of strategic hosts allows the quality of service over the enterprise's network to be monitored. For example, service can be monitored on the Application Server System, on the same LAN segment as the Application Server System, on the other side of a firewall system, or out in the WAN.
						</div></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE56598-PARENT">
      ⁠</a>7.3. PCP Archive Logger Deployment</h2></div></div></div><div class="para">
				<a id="ITch08-3" class="indexterm"></a>PCP archive logs are created by the <code class="command">pmlogger</code> utility, as discussed in <a class="xref" href="#LE93354-PARENT">Chapter 6, <em>Archive Logging</em></a>. They provide a critical capability to perform retrospective performance analysis, for example, to detect performance regressions, for problem analysis, or to support capacity planning. The following sections discuss the options and trade-offs for <code class="command">pmlogger</code> deployment.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5211332">
      ⁠</a>7.3.1. Deployment Options</h3></div></div></div><div class="para">
					The issue is relatively simple and reduces to “On which host(s) should <code class="command">pmlogger</code> be running?” The options are these:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							Run <code class="command">pmlogger</code> on each PCP collector system to capture local performance data.
						</div></li><li class="listitem"><div class="para">
							Run <code class="command">pmlogger</code> on some of the PCP monitor systems to capture performance data from remote PCP collector systems.
						</div></li><li class="listitem"><div class="para">
							As an extension of the previous option, designate one system to act as the PCP archive site to run all <code class="command">pmlogger</code> instances. This arrangement is shown in <a class="xref" href="#id5211413">Figure 7.5, “Designated PCP Archive Site”</a>.
						</div><div class="figure"><a id="id5211413">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/designated-logger.svg" type="image/svg+xml"><img src="images/designated-logger.png" alt="Designated PCP Archive Site" /></object></div></div><p class="title"><strong>Figure 7.5. Designated PCP Archive Site</strong></p></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5211434">
      ⁠</a>7.3.2. Resource Demands for the Deployment Options</h3></div></div></div><div class="para">
					The <code class="command">pmlogger</code> process is very lightweight in terms of computational demand; most of the (very small) CPU cost is associated with extracting performance metrics at the PCP collector system (PMCD and the PMDAs), which are independent of the host on which <code class="command">pmlogger</code> is running.
				</div><div class="para">
					A local <code class="command">pmlogger</code> consumes disk bandwidth and disk space on the PCP collector system. A remote <code class="command">pmlogger</code> consumes disk space on the site where it is running and network bandwidth between that host and the PCP collector host.
				</div><div class="para">
					The archive logs typically grow at a rate of anywhere between a few kilobytes (KB) to tens of megabytes (MB) per day, depending on how many performance metrics are logged and the choice of sampling frequencies. There are some advantages in minimizing the number of hosts over which the disk resources for PCP archive logs must be allocated; however, the aggregate requirement is independent of where the <code class="command">pmlogger</code> processes are running.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5211489">
      ⁠</a>7.3.3. Operational Management</h3></div></div></div><div class="para">
					There is an initial administrative cost associated with configuring each <code class="command">pmlogger</code> instance, and an ongoing administrative investment to monitor these configurations, perform regular housekeeping (such as rotation, compression, and culling of PCP archive log files), and execute periodic tasks to process the archives (such as nightly performance regression checking with <code class="command">pmie</code>).
				</div><div class="para">
					Many of these tasks are handled by the supplied <code class="command">pmlogger</code> administrative tools and scripts, as described in <a class="xref" href="#LE92914-PARENT">Section 6.2.3, “Archive Log File Management”</a>. However, the necessity and importance of these tasks favor a centralized <code class="command"> pmlogger</code> deployment, as shown in <a class="xref" href="#id5211413">Figure 7.5, “Designated PCP Archive Site”</a>.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5211573">
      ⁠</a>7.3.4. Exporting PCP Archive Logs</h3></div></div></div><div class="para">
					<a id="IG31371888312" class="indexterm"></a>Collecting PCP archive logs is of little value unless the logs are processed as part of the ongoing performance monitoring and management functions. This processing typically involves the use of the tools on a PCP monitor system, and hence the archive logs may need to be read on a host different from the one they were created on.
				</div><div class="para">
					NFS mounting is obviously an option, but the PCP tools support random access and both forward and backward temporal motion within an archive log. If an archive is to be subjected to intensive and interactive processing, it may be more efficient to copy the files of the archive log to the PCP monitor system first.
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						Each PCP archive log consists of at least three separate files (see <a class="xref" href="#LE92914-PARENT">Section 6.2.3, “Archive Log File Management”</a> for details). You must have concurrent access to all of these files before a PCP tool is able to process an archive log correctly.
					</div></div></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE62310-PARENT">
      ⁠</a>7.4. PCP Inference Engine Deployment</h2></div></div></div><div class="para">
				The <code class="command">pmie</code> utility supports automated reasoning about system performance, as discussed in <a class="xref" href="#LE21414-PARENT">Chapter 5, <em>Performance Metrics Inference Engine</em></a>, and plays a key role in monitoring system performance for both real-time and retrospective analysis, with the performance data being retrieved respectively from a PCP collector system and a PCP archive log.
			</div><div class="para">
				The following sections discuss the options and trade-offs for <code class="command">pmie</code> deployment.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5211669">
      ⁠</a>7.4.1. Deployment Options</h3></div></div></div><div class="para">
					The issue is relatively simple and reduces to “On which host(s) should <code class="command">pmie</code> be running?” You must consider both real-time and retrospective uses, and the options are as follows:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							For real-time analysis, run <code class="command">pmie</code> on each PCP collector system to monitor local system performance.
						</div></li><li class="listitem"><div class="para">
							For real-time analysis, run <code class="command">pmie</code> on some of the PCP monitor systems to monitor the performance of remote PCP collector systems.
						</div></li><li class="listitem"><div class="para">
							For retrospective analysis, run <code class="command">pmie</code> on the systems where the PCP archive logs reside. The problem then reduces to <code class="command">pmlogger</code> deployment as discussed in <a class="xref" href="#LE56598-PARENT">Section 7.3, “PCP Archive Logger Deployment”</a>.
						</div></li><li class="listitem"><div class="para">
							As an example of the “distributed management with centralized control” philosophy, designate some system to act as the PCP Management Site to run all <code class="command">pmlogger</code> and <code class="command">pmie</code> instances. This arrangement is shown in <a class="xref" href="#id5211805">Figure 7.6, “PCP Management Site Deployment”</a>.
						</div></li></ul></div><div class="para">
					One <code class="command">pmie</code> instance is capable of monitoring multiple PCP collector systems; for example, to evaluate some universal rules that apply to all hosts. At the same time a single PCP collector system may be monitored by multiple <code class="command">pmie</code> instances; for example, for site-specific and universal rule evaluation, or to support both tactical performance management (operations) and strategic performance management (capacity planning). Both situations are depicted in <a class="xref" href="#id5211805">Figure 7.6, “PCP Management Site Deployment”</a>.
				</div><div class="figure"><a id="id5211805">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/designated-manager.svg" type="image/svg+xml"><img src="images/designated-manager.png" alt="PCP Management Site Deployment" /></object></div></div><p class="title"><strong>Figure 7.6. PCP Management Site Deployment</strong></p></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5211825">
      ⁠</a>7.4.2. Resource Demands for the Deployment Options</h3></div></div></div><div class="para">
					Depending on the complexity of the rule sets, the number of hosts being monitored, and the evaluation frequency, <code class="command">pmie</code> may consume CPU cycles significantly above the resources required to simply fetch the values of the performance metrics. If this becomes significant, then real-time deployment of <code class="command">pmie</code> away from the PCP collector systems should be considered in order to avoid the “you're part of the problem, not the solution” scenario in terms of CPU utilization on a heavily loaded server.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5211850">
      ⁠</a>7.4.3. Operational Management</h3></div></div></div><div class="para">
					An initial administrative cost is associated with configuring each <code class="command">pmie</code> instance, particularly in the development of the rule sets that accurately capture and classify “good” versus “bad” performance in your environment. These rule sets almost always involve some site-specific knowledge, particularly in respect to the “normal” levels of activity and resource consumption. The <code class="command">pmieconf</code> tool (see <a class="xref" href="#Z927039566sdc">Section 5.7, “Creating <code class="command">pmie</code> Rules with <code class="command">pmieconf</code>”</a>) may be used to help develop localized rules based upon parameterized templates covering many common performance scenarios. In complex environments, customizing these rules may occur over an extended period and require considerable performance analysis insight.
				</div><div class="para">
					One of the functions of <code class="command">pmie</code> provides for continual detection of adverse performance and the automatic generation of alarms (visible, audible, e-mail, pager, and so on). Uncontrolled deployment of this alarm initiating capability throughout the enterprise may cause havoc.
				</div><div class="para">
					These considerations favor a centralized <code class="command">pmie</code> deployment at a small number of PCP monitor sites, or in a PCP Management Site as shown in <a class="xref" href="#id5211805">Figure 7.6, “PCP Management Site Deployment”</a>.
				</div><div class="para">
					However, it is most likely that knowledgeable users with specific needs may find a local deployment of <code class="command">pmie</code> most useful to track some particular class of service difficulty or resource utilization. In these cases, the alarm propagation is unlikely to be required or is confined to the system on which <code class="command">pmie</code> is running.
				</div><div class="para">
					Configuration and management of a number of <code class="command">pmie</code> instances is made much easier with the scripts and control files described in <a class="xref" href="#Z927039824sdc">Section 5.8, “Management of <code class="command">pmie</code> Processes”</a>.
				</div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="LE62564-PARENT">
      ⁠</a>Chapter 8. Customizing and Extending PCP Services</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#LE61335-PARENT">8.1. PMDA Customization</a></span></dt><dd><dl><dt><span class="section"><a href="#LE43074-PARENT">8.1.1. Customizing the Summary PMDA</a></span></dt></dl></dd><dt><span class="section"><a href="#LE80685-PARENT">8.2. PCP Tool Customization</a></span></dt><dd><dl><dt><span class="section"><a href="#id5212794">8.2.1. Archive Logging Customization</a></span></dt><dt><span class="section"><a href="#id5213167">8.2.2. Inference Engine Customization</a></span></dt></dl></dd><dt><span class="section"><a href="#LE50224-PARENT">8.3. PMNS Management</a></span></dt><dd><dl><dt><span class="section"><a href="#id5213650">8.3.1. PMNS Processing Framework</a></span></dt><dt><span class="section"><a href="#id5213751">8.3.2. PMNS Syntax</a></span></dt></dl></dd><dt><span class="section"><a href="#LE10270-PARENT">8.4. PMDA Development</a></span></dt><dt><span class="section"><a href="#LE31248-PARENT">8.5. PCP Tool Development</a></span></dt></dl></div><div class="para">
			<a id="IG31371888313" class="indexterm"></a><a id="IG31371888314" class="indexterm"></a> Performance Co-Pilot (PCP) has been developed to be fully extensible. The following sections summarize the various facilities provided to allow you to extend and customize PCP for your site:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					<a class="xref" href="#LE61335-PARENT">Section 8.1, “PMDA Customization”</a>, describes the procedure for customizing the summary PMDA to export derived metrics formed by aggregation of base PCP metrics from one or more collector hosts.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE80685-PARENT">Section 8.2, “PCP Tool Customization”</a>, describes the various options available for customizing and extending the basic PCP tools.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE50224-PARENT">Section 8.3, “PMNS Management”</a>, covers the concepts and tools provided for updating the PMNS (Performance Metrics Name Space).
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE10270-PARENT">Section 8.4, “PMDA Development”</a>, details where to find further information to assist in the development of new PMDAs to extend the range of performance metrics available through the PCP infrastructure.
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#LE31248-PARENT">Section 8.5, “PCP Tool Development”</a>, outlines how new tools may be developed to process performance data from the PCP infrastructure.
				</div></li></ul></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE61335-PARENT">
      ⁠</a>8.1. PMDA Customization</h2></div></div></div><div class="para">
				The generic procedures for installing and activating the optional PMDAs have been described in <a class="xref" href="#LE43202-PARENT">Section 2.3, “Managing Optional PMDAs”</a>. In some cases, these procedures prompt the user for information based upon the local system or network configuration, application deployment, or processing profile to customize the PMDA and hence the performance metrics it exports.
			</div><div class="para">
				The summary PMDA is a special case that warrants further discussion.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="LE43074-PARENT">
      ⁠</a>8.1.1. Customizing the Summary PMDA</h3></div></div></div><div class="para">
					<a id="ITch09-1" class="indexterm"></a>The summary PMDA exports performance metrics derived from performance metrics made available by other PMDAs. It is described completely in the <code class="command">pmdasummary(1)</code> man page.
				</div><div class="para">
					The summary PMDA consists of two processes:
				</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="command">pmie</code> process</span></dt><dd><div class="para">
								Periodically samples the base metrics and compute values for the derived metrics. This dedicated instance of the PCP <code class="command">pmie</code> inference engine is launched with special command line arguments by the main process. See <a class="xref" href="#LE41170-PARENT">Section 5.1, “Introduction to <code class="command">pmie</code>”</a>, for a complete discussion of the <code class="command">pmie</code> feature set.
							</div></dd><dt><span class="term"><code class="literal">main</code> process</span></dt><dd><div class="para">
								Reads and buffers the values computed by the <code class="command">pmie</code> process and makes them available to the Performance Metrics Collection Daemon (PMCD).
							</div></dd></dl></div><div class="para">
					All of the metrics exported by the summary PMDA have a singular instance and the values are instantaneous; the exported value is the correct value as of the last time the corresponding expression was evaluated by the <code class="command">pmie</code> process.
				</div><div class="para">
					The summary PMDA resides in the <code class="literal">${PCP_PMDAS_DIR}/summary</code> directory and may be installed with a default configuration by following the steps described in <a class="xref" href="#LE31599-PARENT">Section 2.3.1, “PMDA Installation on a PCP Collector Host”</a>.
				</div><div class="para">
					Alternatively, you may customize the summary PMDA to export your own derived performance metrics by following the steps in <a class="xref" href="#id5212322">Procedure 8.1, “Customizing the Summary PMDA”</a>:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="id5212322">
      ⁠</a><p class="title"><strong>Procedure 8.1. Customizing the Summary PMDA</strong></p><ol class="1"><li class="step"><div class="para">
							Check that the symbolic constant <code class="literal">SYSSUMMARY</code> is defined in the <code class="filename">${PCP_VAR_DIR}/pmns/stdpmid</code> file. If it is not, perform the postinstall update of this file, as superuser: 
<pre class="literallayout"><strong class="userinput"><code>cd ${PCP_VAR_DIR}/pmns ./Make.stdpmid</code></strong></pre>
						</div></li><li class="step"><div class="para">
							<a id="IG31371888315" class="indexterm"></a>Choose Performance Metric Name Space (PMNS) names for the new metrics. These must begin with <code class="literal">summary</code> and follow the rules described in the <code class="command">pmns(5)</code> man page. For example, you might use <code class="literal">summary.fs.cache_write</code> and <code class="literal">summary.fs.cache_hit</code>.
						</div></li><li class="step"><div class="para">
							<a id="IG31371888316" class="indexterm"></a>Edit the <code class="filename">pmns</code> file in the <code class="literal">${PCP_PMDAS_DIR}/summary</code> directory to add the new metric names in the format described in the <code class="command">pmns(5)</code> man page. You must choose a unique performance metric identifier (PMID) for each metric. In the <code class="filename">pmns</code> file, these appear as <code class="literal">SYSSUMMARY:0:x</code>. The value of <em class="replaceable">x</em> is arbitrary in the range 0 to 1023 and unique in this file. Refer to <a class="xref" href="#LE50224-PARENT">Section 8.3, “PMNS Management”</a>, for a further explanation of the rules governing PMNS updates.
						</div><div class="para">
							For example:
						</div><pre class="literallayout">summary {
          cpu
          disk
          netif
          fs              /*new*/
}
summary.fs {
          cache_write     SYSSUMMARY:0:10
          cache_hit       SYSSUMMARY:0:11
}</pre></li><li class="step"><div class="para">
							Use the local test PMNS <code class="literal">root</code> and validate that the PMNS changes are correct.
						</div><div class="para">
							For example, enter this command:
						</div><pre class="literallayout"><strong class="userinput"><code>pminfo -n root -m summary.fs</code></strong></pre><div class="para">
							You see output similar to the following:
						</div><pre class="literallayout">summary.fs.cache_write PMID: 27.0.10
summary.fs.cache_hit PMID: 27.0.11</pre></li><li class="step"><div class="para">
							Edit the <code class="filename">${PCP_PMDAS_DIR}/summary/expr.pmie</code> file to add new <code class="command">pmie</code> expressions. If the name to the left of the assignment operator (=) is one of the PMNS names, then the <code class="command">pmie</code> expression to the right will be evaluated and returned by the summary PMDA. The expression must return a numeric value. Additional description of the <code class="command">pmie</code> expression syntax may be found in <a class="xref" href="#LE90227-PARENT">Section 5.3, “Specification Language for <code class="command">pmie</code>”</a>.
						</div><div class="para">
							For example, consider this expression:
						</div><pre class="literallayout">// filesystem buffer cache hit percentages
prefix = "kernel.all.io";          // macro, not exported
summary.fs.cache_write =
                100 - 100 * $prefix.bwrite / $prefix.lwrite;
summary.fs.cache_hit =
                100 - 100 * $prefix.bread / $prefix.lread;</pre></li><li class="step"><div class="para">
							Run <code class="command">pmie</code> in debug mode to verify that the expressions are being evaluated correctly, and the values make sense.
						</div><div class="para">
							For example, enter this command:
						</div><pre class="literallayout"><strong class="userinput"><code>pmie -t 2sec -v expr.pmie</code></strong></pre><div class="para">
							You see output similar to the following:
						</div><pre class="literallayout">summary.fs.cache_write:      ?
summary.fs.cache_hit:      ?
summary.fs.cache_write:  45.83
summary.fs.cache_hit:   83.2
summary.fs.cache_write:  39.22
summary.fs.cache_hit:  84.51</pre></li><li class="step"><div class="para">
							Install the new PMDA.
						</div><div class="para">
							From the <code class="literal">${PCP_PMDAS_DIR}/summary</code> directory, use this command:
						</div><pre class="literallayout"><strong class="userinput"><code>./Install</code></strong></pre><div class="para">
							You see the following output:
						</div><pre class="literallayout">Interval between summary expression evaluation (seconds)? [10] <strong class="userinput"><code>10</code></strong>
Updating the Performance Metrics Name Space...
Installing pmchart view(s) ...
Terminate PMDA if already installed ...
Installing files ..
Updating the PMCD control file, and notifying PMCD ...
Wait 15 seconds for the agent to initialize ...
Check summary metrics have appeared ... 8 metrics and 8 values</pre></li><li class="step"><div class="para">
							Check the metrics.
						</div><div class="para">
							For example, enter this command:
						</div><pre class="literallayout"><strong class="userinput"><code>pmval -t 5sec -s 8 summary.fs.cache_write</code></strong></pre><div class="para">
							You see a response similar to the following:
						</div><pre class="literallayout">metric:    summary.fs.cache_write
host:      localhost
semantics: instantaneous value
units:     none
samples:   8
interval:  5.00 sec
63.60132158590308
62.71878646441073
62.71878646441073
58.73968492123031
58.73968492123031
65.33822758259046
65.33822758259046
72.6099706744868</pre><div class="para">
							Note that the values are being sampled here by <code class="literal">pmval</code> every 5 seconds, but <code class="command">pmie</code> is passing only new values to the summary PMDA every 10 seconds. Both rates could be changed to suit the dynamics of your new metrics.
						</div></li><li class="step"><div class="para">
							You may now create <code class="command">pmchart</code> views, <code class="command">pmie</code> rules, and <code class="command">pmlogger</code> configurations to monitor and archive your new performance metrics.
						</div></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE80685-PARENT">
      ⁠</a>8.2. PCP Tool Customization</h2></div></div></div><div class="para">
				<a id="ITch09-2" class="indexterm"></a><a id="IG31371888317" class="indexterm"></a>Performance Co-Pilot (PCP) has been designed and implemented with a philosophy that embraces the notion of toolkits and encourages extensibility.
			</div><div class="para">
				In most cases, the PCP tools provide orthogonal services, based on external configuration files. It is the creation of new and modified configuration files that enables PCP users to customize tools quickly and meet the needs of the local environment, in many cases allowing personal preferences to be established for individual users on the same PCP monitor system.
			</div><div class="para">
				The material in this section is intended to act as a checklist of pointers to detailed documentation found elsewhere in this guide, in the man pages, and in the files that are made available as part of the PCP installation.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5212794">
      ⁠</a>8.2.1. Archive Logging Customization</h3></div></div></div><div class="para">
					<a id="IG31371888318" class="indexterm"></a><a id="IG31371888319" class="indexterm"></a>The PCP archive logger is presented in <a class="xref" href="#LE93354-PARENT">Chapter 6, <em>Archive Logging</em></a>, and documented in the <code class="command">pmlogger(1)</code> man page.
				</div><div class="para">
					The following global files and directories influence the behavior of <code class="command">pmlogger</code>:
				</div><div class="variablelist"><a id="Z930367453sdc">
      ⁠</a><dl class="variablelist"><dt><span class="term"><code class="filename">${PCP_SYSCONF_DIR}/pmlogger</code> </span></dt><dd><div class="para">
								Enable/disable state for the primary logger facility using this command:
<pre class="literallayout"><strong class="userinput"><code><code class="literal">chkconfig pmlogger on</code></code></strong></pre>
							</div></dd><dt><span class="term"><code class="filename">${PCP_SYSCONF_DIR}/pmlogger/config.default</code> </span></dt><dd><div class="para">
								The default <code class="command">pmlogger</code> configuration file that is used for the primary logger when this facility is enabled.
							</div></dd><dt><span class="term"><code class="filename">${PCP_VAR_DIR}/config/pmlogconf/tools</code> </span></dt><dd><div class="para">
								Every PCP tool with a fixed group of performance metrics contributes a <code class="command">pmlogconf</code> configuration file that includes each of the performance metrics used in the tool, for example, <code class="filename">${PCP_VAR_DIR}/config/pmlogconf/pmstat</code> for <code class="literal">pmstat</code>.
							</div></dd><dt><span class="term"><code class="filename">${PCP_PMLOGGERCONTROL_PATH}</code> or <code class="filename">${PCP_PMLOGGERCONTROL_PATH}.d</code> files</span></dt><dd><div class="para">
								Defines which PCP collector hosts require <code class="command">pmlogger</code> to be launched on the local host, where the configuration file comes from, where the archive log files should be created, and <code class="command">pmlogger</code> startup options.
							</div><div class="para">
								These <code class="literal">control</code> files support the starting and stopping of multiple <code class="command">pmlogger</code> instances that monitor local or remote hosts.
							</div></dd><dt><span class="term"><code class="filename">/etc/cron.d/pcp-pmlogger</code> or <code class="filename">${PCP_VAR_DIR}/config/pmlogger/crontab</code> </span></dt><dd><div class="para">
								Default <code class="literal">crontab</code> entries that may be merged with the <code class="literal">crontab</code> entries for the <code class="literal">pcp</code> user to schedule the periodic execution of the archive log management scripts, for example, <code class="literal">pmlogger_daily</code>.
							</div></dd><dt><span class="term"><code class="filename">${PCP_LOG_DIR}/pmlogger/somehost</code> </span></dt><dd><div class="para">
								The default behavior of the archive log management scripts create archive log files for the host <em class="replaceable">somehost</em> in this directory.
							</div></dd><dt><span class="term"><code class="filename">${PCP_LOG_DIR}/pmlogger/somehost/Latest</code> </span></dt><dd><div class="para">
								A PCP archive folio for the most recent archive for the host <em class="replaceable">somehost</em>. This folio is created and maintained by the <code class="literal">cron</code>-driven periodic archive log management scripts, for example, <code class="literal">pmlogger_check</code>. Archive folios may be processed with the <code class="literal">pmafm</code> tool.
							</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5213167">
      ⁠</a>8.2.2. Inference Engine Customization</h3></div></div></div><div class="para">
					<a id="IG31371888320" class="indexterm"></a><a id="IG31371888321" class="indexterm"></a>The PCP inference engine is presented in <a class="xref" href="#LE21414-PARENT">Chapter 5, <em>Performance Metrics Inference Engine</em></a>, and documented in the <code class="command">pmie(1)</code> man page.
				</div><div class="para">
					The following global files and directories influence the behavior of <code class="command">pmie</code>:
				</div><div class="variablelist"><a id="Z930367570sdc">
      ⁠</a><dl class="variablelist"><dt><span class="term"><code class="filename">${PCP_SYSCONF_DIR}/pmie</code></span></dt><dd><div class="para">
								Controls the pmie daemon facility. Enable using this command:
<pre class="literallayout">chkconfig pmie on</pre>
							</div></dd><dt><span class="term"><code class="filename">${PCP_SYSCONF_DIR}/pmie/config.default</code></span></dt><dd><div class="para">
								The <code class="command">pmie</code> configuration file that is used for monitoring the local host when the <code class="command">pmie</code> daemon facility is enabled in the default configuration. This file is created using <code class="command">pmieconf</code> the first time the daemon facility is activated.
							</div></dd><dt><span class="term"><code class="filename">${PCP_PMIECONTROL_PATH}</code> and <code class="filename">${PCP_PMIECONTROL_PATH}.d</code> files</span></dt><dd><div class="para">
								Defines which PCP collector hosts require a daemon <code class="command">pmie</code> to be monitoring from the local host, where the configuration files comes from, where the <code class="command">pmie</code> log file should be created, and <code class="command">pmie</code> startup options.
							</div><div class="para">
								These <code class="literal">control</code> files support the starting and stopping of multiple <code class="command">pmie</code> instances that are each monitoring one or more hosts.
							</div></dd><dt><span class="term"><code class="filename">${PCP_VAR_DIR}/config/pmieconf/*/*</code></span></dt><dd><div class="para">
								Each <code class="command">pmieconf</code> rule definition can be found below one of these subdirectories.
							</div></dd><dt><span class="term"><code class="filename">/etc/cron.d/pcp-pmie</code> or <code class="filename">${PCP_VAR_DIR}/config/pmie/crontab</code> </span></dt><dd><div class="para">
								Default <code class="literal">crontab</code> entries that may be merged with the <code class="literal">crontab</code> entries for the <code class="literal">pcp</code> user to schedule the periodic execution of the <code class="command">pmie_check</code> and <code class="command">pmie_daily</code> scripts, for verifying that <code class="command">pmie</code> instances are running and logs rotated.
							</div></dd><dt><span class="term"><code class="filename">${PCP_LOG_DIR}/pmie/somehost</code></span></dt><dd><div class="para">
								The default behavior of the <code class="filename">${PCP_RC_DIR}/pmie</code> startup scripts create <code class="command">pmie</code> log files for the host <em class="replaceable">somehost</em> in this directory.
							</div></dd><dt><span class="term"><code class="command">pmie_check</code> and <code class="command">pmie_daily</code></span></dt><dd><div class="para">
								These commands are similar to the <code class="command">pmlogger</code> support scripts, <code class="command">pmlogger_check</code> and <code class="command">pmlogger_daily</code>.
							</div></dd><dt><span class="term"><code class="filename">${PCP_TMP_DIR}/pmie</code></span></dt><dd><div class="para">
								The statistics that <code class="command">pmie</code> gathers are maintained in binary data structure files. These files can be found in the <code class="filename">${PCP_TMP_DIR}/pmie</code> directory.
							</div></dd><dt><span class="term"><code class="literal">pmcd.pmie</code> metrics</span></dt><dd><div class="para">
								The PMCD PMDA exports information about executing <code class="command">pmie</code> processes and their progress in terms of rule evaluations and action execution rates.
							</div><div class="para">
								If <code class="command">pmie</code> is running on a system with a PCP collector deployment, the <code class="command">pmcd</code> PMDA exports these metrics via the <code class="filename">pmcd.pmie</code> group of metrics.
							</div></dd></dl></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE50224-PARENT">
      ⁠</a>8.3. PMNS Management</h2></div></div></div><div class="para">
				<a id="IG31371888322" class="indexterm"></a>This section describes the syntax, semantics, and processing framework for the external specification of a Performance Metrics Name Space (PMNS) as it might be loaded by the PMAPI routine <code class="command">pmLoadNameSpace</code>; see the <code class="command">pmLoadNameSpace(3)</code> man page. This is usually done only by <code class="command">pmcd</code>, except in rare circumstances such as <a class="xref" href="#LE43074-PARENT">Section 8.1.1, “Customizing the Summary PMDA”</a>.
			</div><div class="para">
				The PMNS specification is a simple text source file that can be edited easily. For reasons of efficiency, a binary format is also supported; the utility <code class="literal">pmnscomp</code> translates the ASCII source format into binary format; see the <code class="command">pmnscomp(1)</code> man page.
			</div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5213650">
      ⁠</a>8.3.1. PMNS Processing Framework</h3></div></div></div><div class="para">
					The PMNS specification is initially passed through <code class="command">pmcpp(1)</code>. This means the following facilities may be used in the specification:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							C-style comments
						</div></li><li class="listitem"><div class="para">
							<code class="literal">#include</code> directives
						</div></li><li class="listitem"><div class="para">
							<code class="literal">#define</code> directives and macro substitution
						</div></li><li class="listitem"><div class="para">
							Conditional processing with <code class="literal">#ifdef</code>, <code class="literal">#ifndef</code>, <code class="literal">#endif</code>, and <code class="literal">#undef</code>
						</div></li></ul></div><div class="para">
					When <code class="command">pmcpp(1)</code> is executed, the standard include directories are the current directory and <code class="literal">${PCP_VAR_DIR}/pmns</code>, where some standard macros and default specifications may be found.
				</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5213751">
      ⁠</a>8.3.2. PMNS Syntax</h3></div></div></div><div class="para">
					<a id="ITch09-4" class="indexterm"></a><a id="IG31371888323" class="indexterm"></a>Every PMNS is tree structured. The paths to the leaf nodes are the performance metric names. The general syntax for a non-leaf node in PMNS is as follows:
				</div><pre class="literallayout">pathname {
        name    [pmid]
        ...
}</pre><div class="para">
					Here <code class="literal">pathname</code> is the full pathname from the root of the PMNS to this non-leaf node, with each component in the path separated by a period. The root node for the PMNS has the special name <code class="literal">root</code>, but the prefix string <code class="literal">root.</code> must be omitted from all other <code class="literal">pathnames</code>.
				</div><div class="para">
					For example, refer to the PMNS shown in <a class="xref" href="#id5213846">Figure 8.1, “Small Performance Metrics Name Space (PMNS)”</a>. The correct pathname for the rightmost non-leaf node is <code class="literal">cpu.utilization</code>, not <code class="literal">root.cpu.utilization</code>.
				</div><div class="figure"><a id="id5213846">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><object data="images/pmns-small2.svg" type="image/svg+xml"><img src="images/pmns-small2.png" alt="Small Performance Metrics Name Space (PMNS)" /></object></div></div><p class="title"><strong>Figure 8.1. Small Performance Metrics Name Space (PMNS)</strong></p></div><div class="para">
					Each component in the pathname must begin with an alphabetic character and be followed by zero or more alphanumeric characters or the underscore (_) character. For alphabetic characters in a component, uppercase and lowercase are significant.
				</div><div class="para">
					Non-leaf nodes in the PMNS may be defined in any order desired. The descendent nodes are defined by the set of <code class="literal">names</code>, relative to the pathname of their parent non-leaf node. For descendent nodes, leaf nodes have a <code class="literal">pmid</code> specification, but non-leaf nodes do not.
				</div><div class="para">
					The syntax for the <code class="literal">pmid</code> specification was chosen to help manage the allocation of Performance Metric IDs (PMIDs) across disjoint and autonomous domains of administration and implementation. Each <code class="literal">pmid</code> consists of three integers separated by colons, for example, <code class="literal">14:27:11</code>. This is intended to mirror the implementation hierarchy of performance metrics. The first integer identifies the domain in which the performance metric lies. Within a domain, related metrics are often grouped into clusters. The second integer identifies the cluster, and the third integer, the metric within the cluster.
				</div><div class="para">
					The PMNS specification for <a class="xref" href="#id5213846">Figure 8.1, “Small Performance Metrics Name Space (PMNS)”</a> is shown in <a class="xref" href="#Z928447759sdc">Example 8.1, “PMNS Specification”</a>:
				</div><div class="example"><a id="Z928447759sdc">
      ⁠</a><p class="title"><strong>Example 8.1. PMNS Specification</strong></p><div class="example-contents"><pre class="literallayout">/*
* PMNS Specification
*/
#define KERNEL 1
root {
       network
       cpu
}
#define NETWORK 26
network {
       interrupts    KERNEL:NETWORK:1
       packets
}
network.packets {
       in     KERNEL:NETWORK:35
       out    KERNEL:NETWORK:36
}
#define CPU 10
cpu {
       syscalls    KERNEL:CPU:10
       utilization
}
#define USER 20
#define SYSTEM 21
#define IDLE 22
cpu.utilization {
       user    KERNEL:CPU:USER
       sys     KERNEL:CPU:SYSTEM
       idle    KERNEL:CPU:IDLE
}</pre></div></div><div class="para">
					For complete documentation of the PMNS and associated utilities, see the <code class="command">pmns(5)</code>, <code class="command">pmnsadd(1)</code>, <code class="command">pmnsdel(1)</code> and <code class="command">pmnsmerge(1)</code> man pages.
				</div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE10270-PARENT">
      ⁠</a>8.4. PMDA Development</h2></div></div></div><div class="para">
				<a id="ITch09-5" class="indexterm"></a>Performance Co-Pilot (PCP) is designed to be extensible at the collector site.
			</div><div class="para">
				Application developers are encouraged to create new PMDAs to export performance metrics from the applications and service layers that are particularly relevant to a specific site, application suite, or processing environment.
			</div><div class="para">
				These PMDAs use the routines of the <code class="literal">libpcp_pmda</code> library, which is discussed in detail in the <em class="citetitle">Performance Co-Pilot Programmer's Guide</em>.
			</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="LE31248-PARENT">
      ⁠</a>8.5. PCP Tool Development</h2></div></div></div><div class="para">
				<a id="ITch09-6" class="indexterm"></a><a id="IG31371888324" class="indexterm"></a>Performance Co-Pilot (PCP) is designed to be extensible at the monitor site.
			</div><div class="para">
				Application developers are encouraged to create new PCP client applications to monitor or display performance metrics in a manner that is particularly relevant to a specific site, application suite, or processing environment.
			</div><div class="para">
				Client applications use the routines of the PMAPI (performance metrics application programming interface) described in the <em class="citetitle">Performance Co-Pilot Programmer's Guide</em>. At the time of writing, native PMAPI interfaces are available for the C, C++ and Python languages.
			</div></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="LE65325-PARENT">
      ⁠</a>Appendix A. Acronyms</h1></div></div></div><div class="para">
			<a id="ITchA-0" class="indexterm"></a><a id="ITchA-1" class="indexterm"></a><a class="xref" href="#id5214266">Table A.1, “Performance Co-Pilot Acronyms and Their Meanings ”</a> provides a list of the acronyms used in the Performance Co-Pilot (PCP) documentation, help cards, man pages, and user interface.
		</div><div class="table"><a id="id5214266">
      ⁠</a><p class="title"><strong>Table A.1. Performance Co-Pilot Acronyms and Their Meanings </strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-14-rows" summary="Performance Co-Pilot Acronyms and Their Meanings "><colgroup><col width="30%" /><col width="70%" /></colgroup><thead><tr valign="top"><th align="left" valign="bottom">
						<div class="para">
							Acronym
						</div>
						</th><th align="left" valign="bottom">
						<div class="para">
							Meaning
						</div>
						</th></tr></thead><tbody><tr valign="top"><td align="left" valign="top">
						<div class="para">
							API
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Application Programming Interface
						</div>
						</td></tr><tr class="even" valign="top"><td align="left" valign="top">
						<div class="para">
							DBMS
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Database Management System
						</div>
						</td></tr><tr valign="top"><td align="left" valign="top">
						<div class="para">
							DNS
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Domain Name Service
						</div>
						</td></tr><tr class="even" valign="top"><td align="left" valign="top">
						<div class="para">
							<a id="IG31371888325" class="indexterm"></a> DSO
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Dynamic Shared Object
						</div>
						</td></tr><tr valign="top"><td align="left" valign="top">
						<div class="para">
							<a id="IG31371888326" class="indexterm"></a> I/O
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Input/Output
						</div>
						</td></tr><tr class="even" valign="top"><td align="left" valign="top">
						<div class="para">
							<a id="IG31371888327" class="indexterm"></a> IPC
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Interprocess Communication
						</div>
						</td></tr><tr valign="top"><td align="left" valign="top">
						<div class="para">
							<a id="ITchA-4" class="indexterm"></a> PCP
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Performance Co-Pilot
						</div>
						</td></tr><tr class="even" valign="top"><td align="left" valign="top">
						<div class="para">
							<a id="ITchA-5" class="indexterm"></a> PDU
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Protocol data unit
						</div>
						</td></tr><tr valign="top"><td align="left" valign="top">
						<div class="para">
							<a id="ITchA-6" class="indexterm"></a> PMAPI
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Performance Metrics Application Programming Interface
						</div>
						</td></tr><tr class="even" valign="top"><td align="left" valign="top">
						<div class="para">
							<a id="ITchA-7" class="indexterm"></a> PMCD
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Performance Metrics Collection Daemon
						</div>
						</td></tr><tr valign="top"><td align="left" valign="top">
						<div class="para">
							<a id="ITchA-9" class="indexterm"></a> PMD
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Performance Metrics Domain
						</div>
						</td></tr><tr class="even" valign="top"><td align="left" valign="top">
						<div class="para">
							<a id="ITchA-10" class="indexterm"></a> PMDA
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Performance Metrics Domain Agent
						</div>
						</td></tr><tr valign="top"><td align="left" valign="top">
						<div class="para">
							<a id="ITchA-11" class="indexterm"></a> PMID
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Performance Metric Identifier
						</div>
						</td></tr><tr class="even" valign="top"><td align="left" valign="top">
						<div class="para">
							<a id="ITchA-12" class="indexterm"></a> PMNS
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Performance Metrics Name Space
						</div>
						</td></tr><tr valign="top"><td align="left" valign="top">
						<div class="para">
							<a id="ITchA-13" class="indexterm"></a> TCP/IP
						</div>
						</td><td align="left" valign="top">
						<div class="para">
							Transmission Control Protocol/Internet Protocol
						</div>
						</td></tr></tbody></table></div></div></div><div class="index"><div class="titlepage"><div><div><h1 class="title"><a id="sgi-index">
      ⁠</a>Index</h1></div></div></div><dl><dt>*_inst operator <a class="link" href="#IG31371888221">Arithmetic Aggregation</a></dt><dd></dd><dt>*_sample operator <a class="link" href="#IG31371888222">Arithmetic Aggregation</a></dt><dd></dd><dt>2D tools <a class="link" href="#IG31371888171">Monitoring System Performance</a></dt><dd></dd><dt>64-bit IEEE format <a class="link" href="#IG3137188876">Descriptions for Performance Metrics</a></dt><dd></dd><dt>pmGetConfig function <a class="link" href="#IG31371888139">PCP Environment Variables</a></dt><dd></dd><dt>acronyms <a class="link" href="#ITchA-0">Acronyms</a></dt><dd></dd><dt>active pmlogger process <a class="link" href="#IG31371888306">Identifying an Active <code class="command">pmlogger</code> Process</a></dt><dd></dd><dt>adaptation <a class="link" href="#IG3137188815">Dynamic Adaptation to Change</a></dt><dd></dd><dt>application programs <a class="link" href="#ITch01-114">Application and Agent Development</a> <a class="link" href="#IG3137188869">Sources of Performance Metrics and Their Domains</a></dt><dd></dd><dt>archive logs</dt><dd><dl><dt>administration <a class="link" href="#IG31371888290">Archive Log Administration</a></dt><dd></dd></dl><dl><dt>analysis <a class="link" href="#IG3137188816">Logging and Retrospective Analysis</a></dt><dd></dd></dl><dl><dt>capacity planning <a class="link" href="#IG31371888249">Using Archive Logs for Capacity Planning</a></dt><dd></dd></dl><dl><dt>collection time <a class="link" href="#ITch01-135">Current Metric Context</a></dt><dd></dd></dl><dl><dt>contents <a class="link" href="#IG31371888268">PCP Archive Contents</a></dt><dd></dd></dl><dl><dt>creation <a class="link" href="#IG3137188836">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd></dl><dl><dt>customization <a class="link" href="#IG3137188819">Automated Operational Support</a> <a class="link" href="#IG31371888318">Archive Logging Customization</a></dt><dd></dd></dl><dl><dt>export <a class="link" href="#IG31371888312">Exporting PCP Archive Logs</a></dt><dd></dd></dl><dl><dt>fetching metrics <a class="link" href="#ITch03-5">Fetching Metrics from an Archive Log</a></dt><dd></dd></dl><dl><dt>file management <a class="link" href="#IG31371888260">Archive Log File Management</a></dt><dd></dd></dl><dl><dt>folios <a class="link" href="#IG31371888291">PCP Archive Folios</a></dt><dd></dd></dl><dl><dt>physical filenames <a class="link" href="#ITch03-9">Fetching Metrics from an Archive Log</a></dt><dd></dd></dl><dl><dt>PMAPI <a class="link" href="#IG31371888245">Archive Logs and the PMAPI</a></dt><dd></dd></dl><dl><dt>retrospective analysis <a class="link" href="#IG31371888247">Retrospective Analysis Using Archive Logs</a></dt><dd></dd></dl><dl><dt>troubleshooting <a class="link" href="#IG31371888299">Archive Logging Troubleshooting</a></dt><dd></dd></dl><dl><dt>usage <a class="link" href="#IG31371888239">Archive Logging</a></dt><dd></dd></dl></dd><dt>arithmetic aggregation <a class="link" href="#IG31371888215">Arithmetic Aggregation</a></dt><dd></dd><dt>arithmetic expressions <a class="link" href="#IG31371888199"><code class="command">pmie</code> Arithmetic Expressions</a></dt><dd></dd><dt>audience <a class="link" href="#IG313718884">Empowering the PCP User</a></dt><dd></dd><dt>audits <a class="link" href="#IG3137188820">Automated Operational Support</a></dt><dd></dd><dt>automated operational support <a class="link" href="#IG3137188817">Automated Operational Support</a></dt><dd></dd><dt>avg_host operator <a class="link" href="#IG31371888216">Arithmetic Aggregation</a></dt><dd></dd><dt>basename conventions <a class="link" href="#IG31371888261">Basename Conventions</a></dt><dd></dd><dt>Boolean expressions <a class="link" href="#IG31371888203">Boolean Expressions</a></dt><dd></dd><dt>capacity planning <a class="link" href="#IG31371888250">Using Archive Logs for Capacity Planning</a></dt><dd></dd><dt>caveats <a class="link" href="#IG31371888229">Caveats and Notes on <code class="command">pmie</code></a></dt><dd></dd><dt>centralized archive logging <a class="link" href="#IG3137188818">Automated Operational Support</a></dt><dd></dd><dt>coverage <a class="link" href="#IG3137188824">Metric Coverage</a></dt><dd></dd><dt>chkhelp tool <a class="link" href="#ITch01-115">Application and Agent Development</a></dt><dd></dd><dt>client-server architecture <a class="link" href="#IG3137188813">PCP Distributed Operation</a></dt><dd></dd><dt>collection time <a class="link" href="#ITch01-134">Current Metric Context</a></dt><dd></dd><dt>collector hosts <a class="link" href="#ITch01-143">Distributed Collection</a> <a class="link" href="#ITch01-156">Collector and Monitor Roles</a> <a class="link" href="#ITch02-33">PMDA Installation on a PCP Collector Host</a></dt><dd></dd><dt>comments <a class="link" href="#IG31371888190">Comments </a></dt><dd></dd><dt>common directories <a class="link" href="#IG31371888119">Common Directories and File Locations</a></dt><dd></dd><dt>component software <a class="link" href="#IG3137188826">Overview of Component Software</a></dt><dd></dd><dt>conceptual foundations <a class="link" href="#ITch01-129">Conceptual Foundations</a></dt><dd></dd><dt>configuring PCP <a class="link" href="#ITch02-1">Installing and Configuring Performance Co-Pilot </a></dt><dd></dd><dt>conventions <a class="link" href="#ITch03-1">Common Conventions and Arguments</a></dt><dd></dd><dt>cookbook <a class="link" href="#IG31371888270">Cookbook for Archive Logging</a></dt><dd></dd><dt>count_host operator <a class="link" href="#IG31371888218">Arithmetic Aggregation</a></dt><dd></dd><dt>cron scripts <a class="link" href="#IG31371888242">Introduction to Archive Logging</a> <a class="link" href="#ITch07-6">Administering PCP Archive Logs Using <code class="command">cron</code> Scripts </a></dt><dd></dd><dt>customization</dt><dd><dl><dt>archive logs <a class="link" href="#IG31371888319">Archive Logging Customization</a></dt><dd></dd></dl><dl><dt>inference engine <a class="link" href="#IG31371888321">Inference Engine Customization</a></dt><dd></dd></dl><dl><dt>PCP services <a class="link" href="#IG31371888313">Customizing and Extending PCP Services</a></dt><dd></dd></dl></dd><dt>data collection tools <a class="link" href="#IG3137188834">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>dbpmda tool <a class="link" href="#ITch01-117">Application and Agent Development</a></dt><dd></dd><dt>debugging tools <a class="link" href="#ITch01-90">Operational and Infrastructure Support</a></dt><dd></dd><dt>deployment strategies <a class="link" href="#IG31371888308">Performance Co-Pilot Deployment Strategies</a></dt><dd></dd><dt>diagnostic tools <a class="link" href="#IG3137188851">Operational and Infrastructure Support</a></dt><dd></dd><dt>DISPLAY variable <a class="link" href="#IG31371888207"><code class="command">pmie</code> Rule Expressions</a></dt><dd></dd><dt>distributed collection <a class="link" href="#ITch01-142">Distributed Collection</a></dt><dd></dd><dt>domains <a class="link" href="#IG313718885">Unification of Performance Metric Domains</a></dt><dd></dd><dt>DSO <a class="link" href="#IG31371888325">Acronyms</a></dt><dd></dd><dt>duration <a class="link" href="#IG31371888131">Performance Monitor Reporting Frequency and Duration</a></dt><dd></dd><dt>dynamic adaptation <a class="link" href="#IG3137188814">Dynamic Adaptation to Change</a></dt><dd></dd><dt>environ man page <a class="link" href="#IG31371888135">Timezone Options</a></dt><dd></dd><dt>environment variables <a class="link" href="#IG31371888136">PCP Environment Variables</a></dt><dd></dd><dt>error detection <a class="link" href="#IG31371888233"><code class="command">pmie</code> Error Detection</a></dt><dd></dd><dt>${PCP_PMLOGGERCONTROL_PATH} file <a class="link" href="#IG31371888296">Primary Logger</a></dt><dd></dd><dt>${PCP_DIR}/etc/pcp.conf file <a class="link" href="#IG31371888122">Common Directories and File Locations</a> <a class="link" href="#IG31371888137">PCP Environment Variables</a></dt><dd></dd><dt>${PCP_DIR}/etc/pcp.env file <a class="link" href="#IG31371888121">Common Directories and File Locations</a> <a class="link" href="#IG31371888138">PCP Environment Variables</a></dt><dd></dd><dt>${PCP_RC_DIR}/pmcd file <a class="link" href="#IG31371888127">Common Directories and File Locations</a></dt><dd></dd><dt>evaluation frequency <a class="link" href="#IG31371888193">Setting Evaluation Frequency</a></dt><dd></dd><dt>extensibility <a class="link" href="#IG3137188821">PCP Extensibility</a> <a class="link" href="#IG31371888314">Customizing and Extending PCP Services</a></dt><dd></dd><dt>external equipment <a class="link" href="#IG3137188871">Sources of Performance Metrics and Their Domains</a></dt><dd></dd><dt>fetching metrics <a class="link" href="#ITch03-3">Fetching Metrics from Another Host</a> <a class="link" href="#ITch03-6">Fetching Metrics from an Archive Log</a></dt><dd></dd><dt>file locations <a class="link" href="#IG31371888120">Common Directories and File Locations</a></dt><dd></dd><dt>firewalls <a class="link" href="#IG31371888153">Running PCP Tools through a Firewall</a></dt><dd></dd><dt>flush command <a class="link" href="#IG31371888253">Coordination between <code class="command">pmlogger</code> and PCP tools</a></dt><dd></dd><dt>folios <a class="link" href="#ITch07-9">PCP Archive Folios</a></dt><dd></dd><dt>functional domains <a class="link" href="#ITch01-138">Sources of Performance Metrics and Their Domains</a></dt><dd></dd><dt>glossary <a class="link" href="#ITchA-1">Acronyms</a></dt><dd></dd><dt>illegal label record <a class="link" href="#IG31371888307">Illegal Label Record</a></dt><dd></dd><dt>inference engine <a class="link" href="#IG31371888320">Inference Engine Customization</a></dt><dd></dd><dt>infrastructure support tools <a class="link" href="#ITch01-76">Operational and Infrastructure Support</a></dt><dd></dd><dt>installing PCP <a class="link" href="#ITch02-0">Installing and Configuring Performance Co-Pilot </a></dt><dd></dd><dt>intrinsic operators <a class="link" href="#IG31371888213"><code class="command">pmie</code> Intrinsic Operators</a></dt><dd></dd><dt>I/O <a class="link" href="#IG31371888326">Acronyms</a></dt><dd></dd><dt>IPC <a class="link" href="#IG31371888327">Acronyms</a></dt><dd></dd><dt>kill command <a class="link" href="#IG31371888304">Primary <code class="command">pmlogger</code> Cannot Start</a></dt><dd></dd><dt>layered software services <a class="link" href="#IG3137188868">Sources of Performance Metrics and Their Domains</a></dt><dd></dd><dt>lexical elements <a class="link" href="#IG31371888189">Lexical Elements</a></dt><dd></dd><dt>libpcp_mmv library <a class="link" href="#IG3137188886">Product Extensibility</a></dt><dd></dd><dt>libpcp_pmda library <a class="link" href="#IG3137188885">Product Extensibility</a></dt><dd></dd><dt>log volumes <a class="link" href="#IG31371888262">Log Volumes</a></dt><dd></dd><dt>logging</dt><dd><dt>(see archive logs)</dt></dd><dt>logical constants <a class="link" href="#IG31371888201">Logical Constants</a></dt><dd></dd><dt>logical expressions <a class="link" href="#IG31371888200"><code class="command">pmie</code> Logical Expressions</a></dt><dd></dd><dt>macros <a class="link" href="#IG31371888191">Macros</a></dt><dd></dd><dt>man command</dt><dd><dl><dt>usage <a class="link" href="#IG31371888168">Monitoring System Performance</a></dt><dd></dd></dl></dd><dt>max_host operator <a class="link" href="#IG31371888220">Arithmetic Aggregation</a></dt><dd></dd><dt>metadata <a class="link" href="#ITch01-150">Descriptions for Performance Metrics</a></dt><dd></dd><dt>metric domains <a class="link" href="#IG313718886">Unification of Performance Metric Domains</a></dt><dd></dd><dt>metric wraparound <a class="link" href="#IG31371888231">Performance Metrics Wraparound</a></dt><dd></dd><dt>min_host operator <a class="link" href="#IG31371888219">Arithmetic Aggregation</a></dt><dd></dd><dt>mkaf tool <a class="link" href="#ITch01-48">Collecting, Transporting, and Archiving Performance Information </a> <a class="link" href="#IG31371888243">Introduction to Archive Logging</a></dt><dd></dd><dt>monitor configuration <a class="link" href="#ITch02-5">Product Structure</a></dt><dd></dd><dt>monitor hosts <a class="link" href="#IG3137188881">Collector and Monitor Roles</a></dt><dd></dd><dt>monitoring system performance <a class="link" href="#IG31371888166">Monitoring System Performance</a></dt><dd></dd><dt>naming scheme <a class="link" href="#IG3137188810">Uniform Naming and Access to Performance Metrics </a></dt><dd></dd><dt>netstat command <a class="link" href="#IG31371888111">PMCD Does Not Start</a></dt><dd></dd><dt>network routers and bridges <a class="link" href="#IG3137188870">Sources of Performance Metrics and Their Domains</a></dt><dd></dd><dt>network transportation tools <a class="link" href="#IG3137188835">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>newhelp tool <a class="link" href="#ITch01-119">Application and Agent Development</a></dt><dd></dd><dt>Mail servers <a class="link" href="#IG3137188867">Sources of Performance Metrics and Their Domains</a></dt><dd></dd><dt>objectives <a class="link" href="#IG313718882">Objectives</a></dt><dd></dd><dt>operational support tools <a class="link" href="#IG3137188848">Operational and Infrastructure Support</a></dt><dd></dd><dt>operators <a class="link" href="#IG31371888205">Quantification Operators</a></dt><dd></dd><dt>overview <a class="link" href="#ITch01-0">Introduction to Performance Co-Pilot</a></dt><dd></dd><dt>pmatop tool</dt><dd><dl><dt>brief description <a class="link" href="#IG3137188800">Performance Monitoring and Visualization</a></dt><dd></dd></dl></dd><dt>pmcd.options file <a class="link" href="#ITch02-27">The <code class="filename">pmcd.options</code> File</a></dt><dd></dd><dt>PCP</dt><dd><dl><dt>acronym <a class="link" href="#ITchA-4">Acronyms</a></dt><dd></dd></dl><dl><dt>archive logger deployment <a class="link" href="#ITch08-3">PCP Archive Logger Deployment</a></dt><dd></dd></dl><dl><dt>collector deployment <a class="link" href="#ITch08-0">PCP Collector Deployment</a></dt><dd></dd></dl><dl><dt>configuring and installing <a class="link" href="#ITch02-3">Installing and Configuring Performance Co-Pilot </a></dt><dd></dd></dl><dl><dt>conventions <a class="link" href="#ITch03-0">Common Conventions and Arguments</a></dt><dd></dd></dl><dl><dt>distributed operation <a class="link" href="#ITch01-2">PCP Distributed Operation</a></dt><dd></dd></dl><dl><dt>environment variables <a class="link" href="#ITch03-14">PCP Environment Variables</a></dt><dd></dd></dl><dl><dt>extensibility <a class="link" href="#IG3137188822">PCP Extensibility</a> <a class="link" href="#ITch01-160">Product Extensibility</a></dt><dd></dd></dl><dl><dt>features <a class="link" href="#IG313718880">Introduction to Performance Co-Pilot</a></dt><dd></dd></dl><dl><dt>log file option <a class="link" href="#ITch03-8">Fetching Metrics from an Archive Log</a></dt><dd></dd></dl><dl><dt>naming conventions <a class="link" href="#ITch03-2">Common Conventions and Arguments</a></dt><dd></dd></dl><dl><dt>pmie capabilities <a class="link" href="#IG31371888177">Introduction to <code class="command">pmie</code></a></dt><dd></dd></dl><dl><dt>pmie tool <a class="link" href="#ITch06-7"><code class="command">pmie</code> use of PCP services</a></dt><dd></dd></dl><dl><dt>tool customization <a class="link" href="#ITch09-2">PCP Tool Customization</a></dt><dd></dd></dl><dl><dt>tool development <a class="link" href="#ITch09-6">PCP Tool Development</a></dt><dd></dd></dl><dl><dt>tool summaries <a class="link" href="#IG3137188827">Performance Monitoring and Visualization</a> <a class="link" href="#IG3137188833">Collecting, Transporting, and Archiving Performance Information </a> <a class="link" href="#IG3137188847">Operational and Infrastructure Support</a> <a class="link" href="#IG3137188860">Application and Agent Development</a></dt><dd></dd></dl></dd><dt>pcp tool <a class="link" href="#IG3137188850">Operational and Infrastructure Support</a> <a class="link" href="#IG3137188859">Operational and Infrastructure Support</a></dt><dd></dd><dt>PCP Tutorials and Case Studies</dt><dd><dl><dt>pminfo command <a class="link" href="#IG31371888176">The <code class="command">pminfo</code> Command</a></dt><dd></dd></dl><dl><dt>pmval command <a class="link" href="#IG31371888173">The <code class="command">pmval</code> Command</a></dt><dd></dd></dl></dd><dt>PCP_COUNTER_WRAP variable <a class="link" href="#ITch03-15">PCP Environment Variables</a> <a class="link" href="#IG31371888165">Performance Metric Wraparound</a> <a class="link" href="#IG31371888230">Performance Metrics Wraparound</a></dt><dd></dd><dt>PCP_STDERR variable <a class="link" href="#ITch03-18">PCP Environment Variables</a></dt><dd></dd><dt>PCPIntro command <a class="link" href="#IG31371888112">PMCD Does Not Start</a> <a class="link" href="#IG31371888132">Performance Monitor Reporting Frequency and Duration</a></dt><dd></dd><dt>PDU <a class="link" href="#ITch02-28">The <code class="filename">pmcd.options</code> File</a> <a class="link" href="#ITchA-5">Acronyms</a></dt><dd></dd><dt>Performance Co-Pilot</dt><dd><dt>(see PCP)</dt></dd><dt>Performance Metric Identifier</dt><dd><dt>(see PMID)</dt></dd><dt>performance metric wraparound <a class="link" href="#ITch03-32">Performance Metric Wraparound</a> <a class="link" href="#ITch06-21">Performance Metrics Wraparound</a></dt><dd></dd><dt>performance metrics</dt><dd><dl><dt>concept <a class="link" href="#IG3137188863">Performance Metrics</a></dt><dd></dd></dl><dl><dt>descriptions <a class="link" href="#ITch01-149">Descriptions for Performance Metrics</a></dt><dd></dd></dl><dl><dt>methods <a class="link" href="#ITch01-139">Sources of Performance Metrics and Their Domains</a></dt><dd></dd></dl><dl><dt>missing and incomplete values <a class="link" href="#ITch02-39">Missing and Incomplete Values for Performance Metrics </a></dt><dd></dd></dl><dl><dt>PMNS <a class="link" href="#ITch01-148">Performance Metrics Name Space</a></dt><dd></dd></dl><dl><dt>retrospective sources <a class="link" href="#ITch01-159">Retrospective Sources of Performance Metrics</a></dt><dd></dd></dl><dl><dt>sources <a class="link" href="#ITch01-137">Sources of Performance Metrics and Their Domains</a></dt><dd></dd></dl></dd><dt>Performance Metrics Application Programming Interface</dt><dd><dt>(see PMAPI)</dt></dd><dt>Performance Metrics Collection Daemon</dt><dd><dt>(see PMCD)</dt></dd><dt>Performance Metrics Domain</dt><dd><dt>(see PMD)</dt></dd><dt>Performance Metrics Domain Agent</dt><dd><dt>(see PMDA)</dt></dd><dt>Performance Metrics Inference Engine</dt><dd><dt>(see pmie tool)</dt></dd><dt>Performance Metrics Name Space</dt><dd><dt>(see PMNS)</dt></dd><dt>performance monitoring <a class="link" href="#IG3137188828">Performance Monitoring and Visualization</a> <a class="link" href="#IG31371888167">Monitoring System Performance</a></dt><dd></dd><dt>performance visualization tools <a class="link" href="#ITch07-4">Using Archive Logs with Performance Tools</a></dt><dd></dd><dt>PM_INDOM_NULL <a class="link" href="#ITch06-8"><code class="command">pmie</code> and the Performance Metrics Collection System</a></dt><dd></dd><dt>pmafm tool</dt><dd><dl><dt>archive folios <a class="link" href="#IG31371888244">Introduction to Archive Logging</a></dt><dd></dd></dl><dl><dt>brief description <a class="link" href="#ITch01-50">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd></dl><dl><dt>interactive commands <a class="link" href="#IG31371888295">PCP Archive Folios</a></dt><dd></dd></dl></dd><dt>PMAPI</dt><dd><dl><dt>acronym <a class="link" href="#ITchA-6">Acronyms</a></dt><dd></dd></dl><dl><dt>archive logs <a class="link" href="#IG31371888246">Archive Logs and the PMAPI</a></dt><dd></dd></dl><dl><dt>brief description <a class="link" href="#IG3137188861">Application and Agent Development</a></dt><dd></dd></dl><dl><dt>naming metrics <a class="link" href="#ITch01-130">Performance Metrics</a></dt><dd></dd></dl><dl><dt>pmie capabilities <a class="link" href="#IG31371888178">Introduction to <code class="command">pmie</code></a></dt><dd></dd></dl></dd><dt>PMCD</dt><dd><dl><dt>acronym <a class="link" href="#ITchA-7">Acronyms</a></dt><dd></dd></dl><dl><dt>brief description <a class="link" href="#ITch01-52">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd></dl><dl><dt>collector host <a class="link" href="#IG31371888196"><code class="command">pmie</code> Metric Expressions</a></dt><dd></dd></dl><dl><dt>configuration files <a class="link" href="#ITch02-26">PMCD Options and Configuration Files</a></dt><dd></dd></dl><dl><dt>diagnostics and error messages <a class="link" href="#ITch02-23">PMCD Diagnostics and Error Messages</a></dt><dd></dd></dl><dl><dt>distributed collection <a class="link" href="#IG3137188874">Distributed Collection</a> <a class="link" href="#IG3137188875">Distributed Collection</a></dt><dd></dd></dl><dl><dt>maintenance <a class="link" href="#ITch02-20">Performance Metrics Collection Daemon (PMCD)</a></dt><dd></dd></dl><dl><dt>monitoring utilities <a class="link" href="#IG31371888309">Performance Co-Pilot Deployment Strategies</a></dt><dd></dd></dl><dl><dt>not starting <a class="link" href="#IG31371888109">PMCD Does Not Start</a></dt><dd></dd></dl><dl><dt>PMCD_CONNECT_TIMEOUT variable <a class="link" href="#IG31371888143">PCP Environment Variables</a></dt><dd></dd></dl><dl><dt>PMCD_PORT variable <a class="link" href="#IG31371888144">PCP Environment Variables</a></dt><dd></dd></dl><dl><dt>PMCD_LOCAL variable <a class="link" href="#IG31371889144">PCP Environment Variables</a></dt><dd></dd></dl><dl><dt>PMCD_RECONNECT_TIMEOUT variable <a class="link" href="#IG31371888146">PCP Environment Variables</a></dt><dd></dd></dl><dl><dt>PMCD_REQUEST_TIMEOUT variable <a class="link" href="#IG31371888147">PCP Environment Variables</a></dt><dd></dd></dl><dl><dt>remote connection <a class="link" href="#IG31371888101">Cannot Connect to Remote PMCD</a></dt><dd></dd></dl><dl><dt>starting and stopping <a class="link" href="#IG3137188891">Starting and Stopping the PMCD</a></dt><dd></dd></dl><dl><dt>TCP/IP firewall <a class="link" href="#IG31371888157">Running PCP Tools through a Firewall</a></dt><dd></dd></dl><dl><dt>${PCP_PMCDCONF_PATH} file <a class="link" href="#IG31371888124">Common Directories and File Locations</a></dt><dd></dd></dl></dd><dt>pmcd tool</dt><dd><dt>(see PMCD)</dt></dd><dt>PMCD_CONNECT_TIMEOUT variable <a class="link" href="#IG31371888106">Cannot Connect to Remote PMCD</a> <a class="link" href="#ITch03-22">PCP Environment Variables</a></dt><dd></dd><dt>PMCD_PORT variable <a class="link" href="#IG31371888160">Running PCP Tools through a Firewall</a> <a class="link" href="#IG31371888113">PMCD Does Not Start</a> <a class="link" href="#ITch03-23">PCP Environment Variables</a></dt><dd></dd><dt>PMCD_LOCAL variable <a class="link" href="#IG31371888106">Cannot Connect to Remote PMCD</a> <a class="link" href="#ITch03-21">PCP Environment Variables</a></dt><dd></dd><dt>PMCD_RECONNECT_TIMEOUT variable <a class="link" href="#ITch03-24">PCP Environment Variables</a></dt><dd></dd><dt>PMCD_REQUEST_TIMEOUT variable <a class="link" href="#ITch03-25">PCP Environment Variables</a></dt><dd></dd><dt>pmcd_wait tool <a class="link" href="#IG3137188839">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmcd.conf file <a class="link" href="#ITch02-29">The <code class="filename">pmcd.conf</code> File</a> <a class="link" href="#ITch02-30">Controlling Access to PMCD with <code class="filename">pmcd.conf</code></a></dt><dd></dd><dt>pmchart tool</dt><dd><dl><dt>brief description <a class="link" href="#IG3137188800nat">Performance Monitoring and Visualization</a></dt><dd></dd></dl><dl><dt>fetching metrics <a class="link" href="#IG31371888115">Fetching Metrics from Another Host</a></dt><dd></dd></dl><dl><dt>man example <a class="link" href="#Z1033415772tls">Monitoring System Performance</a></dt><dd></dd></dl><dl><dt>record mode <a class="link" href="#IG31371888292">PCP Archive Folios</a></dt><dd></dd></dl><dl><dt>remote PMCD <a class="link" href="#IG31371888102">Cannot Connect to Remote PMCD</a></dt><dd></dd></dl><dl><dt>short-term executions <a class="link" href="#IG31371888265">Directory Organization for Archive Log Files</a></dt><dd></dd></dl></dd><dt>pmclient tool <a class="link" href="#ITch01-121">Application and Agent Development</a> <a class="link" href="#ITch01-123">Application and Agent Development</a></dt><dd></dd><dt>pmcollectl tool</dt><dd><dl><dt>brief description <a class="link" href="#IG3137188801">Performance Monitoring and Visualization</a></dt><dd></dd></dl><dl><dt>record mode <a class="link" href="#IG31371888293">PCP Archive Folios</a></dt><dd></dd></dl></dd><dt>pmconfirm command</dt><dd><dl><dt>error messages <a class="link" href="#IG31371888141">PCP Environment Variables</a></dt><dd></dd></dl><dl><dt>visible alarm <a class="link" href="#IG31371888180">Introduction to <code class="command">pmie</code></a></dt><dd></dd></dl></dd><dt>PMD <a class="link" href="#IG3137188893">PMDA Installation on a PCP Collector Host</a> <a class="link" href="#ITchA-9">Acronyms</a></dt><dd></dd><dt>PMDA</dt><dd><dl><dt>acronym <a class="link" href="#ITchA-10">Acronyms</a></dt><dd></dd></dl><dl><dt>collectors <a class="link" href="#IG3137188880">Collector and Monitor Roles</a></dt><dd></dd></dl><dl><dt>customizing <a class="link" href="#ITch09-1">Customizing the Summary PMDA</a></dt><dd></dd></dl><dl><dt>development <a class="link" href="#ITch09-5">PMDA Development</a></dt><dd></dd></dl><dl><dt>installation <a class="link" href="#ITch02-32">PMDA Installation on a PCP Collector Host</a></dt><dd></dd></dl><dl><dt>instance names <a class="link" href="#IG31371888197"><code class="command">pmie</code> Metric Expressions</a></dt><dd></dd></dl><dl><dt>libraries <a class="link" href="#IG3137188823">PCP Extensibility</a></dt><dd></dd></dl><dl><dt>managing optional agents <a class="link" href="#ITch02-31">Managing Optional PMDAs</a></dt><dd></dd></dl><dl><dt>monitoring utilities <a class="link" href="#IG31371888310">Performance Co-Pilot Deployment Strategies</a></dt><dd></dd></dl><dl><dt>removal <a class="link" href="#ITch02-35">PMDA Removal on a PCP Collector Host</a></dt><dd></dd></dl><dl><dt>unification <a class="link" href="#IG313718887">Unification of Performance Metric Domains</a></dt><dd></dd></dl></dd><dt>pmdaapache tool <a class="link" href="#IG3137188803">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdacisco tool <a class="link" href="#ITch01-54">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdaelasticsearch tool <a class="link" href="#IG3137188714">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdagfs2 tool <a class="link" href="#IG3137188804">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdagluster tool <a class="link" href="#IG3137188712">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdainfiniband tool <a class="link" href="#IG3137188805">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdakvm tool <a class="link" href="#IG3137188806">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdalustrecomm tool <a class="link" href="#IG3137188807">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdamailq tool <a class="link" href="#ITch01-58">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdamemcache tool <a class="link" href="#IG3137188808">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdammv tool <a class="link" href="#IG3137188841">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdamysql tool <a class="link" href="#IG3137188809">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdanamed tool <a class="link" href="#IG3137188701">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdanginx tool <a class="link" href="#IG3137188702">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdapostfix tool <a class="link" href="#IG3137188703">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdapostgresql tool <a class="link" href="#IG3137188704">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdaproc tool <a class="link" href="#IG3137188705">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdarsyslog tool <a class="link" href="#IG3137188706">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdasamba tool <a class="link" href="#IG3137188707">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdasendmail tool <a class="link" href="#IG3137188842">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdasnmp tool <a class="link" href="#IG3137188708">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdasummary tool <a class="link" href="#ITch01-62">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdasystemd tool <a class="link" href="#IG3137188709">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdavmware tool <a class="link" href="#IG3137188710">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdaweblog tool <a class="link" href="#IG3137188843">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdaxfs tool <a class="link" href="#IG3137188711">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmdbg facility <a class="link" href="#ITch01-89">Operational and Infrastructure Support</a></dt><dd></dd><dt>pmdumplog tool</dt><dd><dl><dt>archive log contents <a class="link" href="#IG31371888269">PCP Archive Contents</a></dt><dd></dd></dl><dl><dt>brief description <a class="link" href="#ITch01-66">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd></dl><dl><dt>troubleshooting <a class="link" href="#ITch07-23">Cannot Find Log</a></dt><dd></dd></dl></dd><dt>pmdumptext tool</dt><dd><dl><dt>brief description <a class="link" href="#ITch01-22">Performance Monitoring and Visualization</a></dt><dd></dd></dl><dl><dt>description <a class="link" href="#IG31371888172">The <code class="command">pmdumptext</code> Command</a></dt><dd></dd></dl></dd><dt>pmerr tool <a class="link" href="#ITch01-91">Operational and Infrastructure Support</a></dt><dd></dd><dt>pmgenmap tool <a class="link" href="#ITch01-125">Application and Agent Development</a></dt><dd></dd><dt>pmhostname tool <a class="link" href="#IG3137188852">Operational and Infrastructure Support</a></dt><dd></dd><dt>PMID</dt><dd><dl><dt>acronym <a class="link" href="#ITchA-11">Acronyms</a></dt><dd></dd></dl><dl><dt>description <a class="link" href="#IG3137188872">Sources of Performance Metrics and Their Domains</a> <a class="link" href="#ITch01-146">Performance Metrics Name Space</a></dt><dd></dd></dl><dl><dt>PMNS names <a class="link" href="#IG31371888316">Customizing the Summary PMDA</a></dt><dd></dd></dl><dl><dt>printing <a class="link" href="#IG31371888174">The <code class="command">pminfo</code> Command</a></dt><dd></dd></dl></dd><dt>pmie tool</dt><dd><dl><dt>%-token <a class="link" href="#IG31371888211"><code class="command">pmie</code> Rule Expressions</a></dt><dd></dd></dl><dl><dt>arithmetic aggregation <a class="link" href="#IG31371888214">Arithmetic Aggregation</a></dt><dd></dd></dl><dl><dt>arithmetic expressions <a class="link" href="#ITch06-15"><code class="command">pmie</code> Arithmetic Expressions</a></dt><dd></dd></dl><dl><dt>automated reasoning <a class="link" href="#ITch06-4">Introduction to <code class="command">pmie</code></a></dt><dd></dd></dl><dl><dt>basic examples <a class="link" href="#IG31371888186">Basic <code class="command">pmie</code> Usage</a></dt><dd></dd></dl><dl><dt>brief description <a class="link" href="#ITch01-32">Performance Monitoring and Visualization</a> <a class="link" href="#IG3137188853">Operational and Infrastructure Support</a></dt><dd></dd></dl><dl><dt>customization <a class="link" href="#IG31371888184">Introduction to <code class="command">pmie</code></a></dt><dd></dd></dl><dl><dt>developing rules <a class="link" href="#ITch06-20">Developing and Debugging <code class="command">pmie</code> Rules</a></dt><dd></dd></dl><dl><dt>error detection <a class="link" href="#ITch06-24"><code class="command">pmie</code> Error Detection</a></dt><dd></dd></dl><dl><dt>examples <a class="link" href="#ITch06-9">Simple <code class="command">pmie</code> Usage</a> <a class="link" href="#ITch06-10">Complex <code class="command">pmie</code> Examples</a></dt><dd></dd></dl><dl><dt>fetching metrics <a class="link" href="#IG31371888116">Fetching Metrics from Another Host</a></dt><dd></dd></dl><dl><dt>global files and directories <a class="link" href="#IG31371888238">Global Files and Directories</a></dt><dd></dd></dl><dl><dt>instance names <a class="link" href="#ITch06-23"><code class="command">pmie</code> Instance Names</a></dt><dd></dd></dl><dl><dt>intrinsic operators <a class="link" href="#ITch06-17"><code class="command">pmie</code> Intrinsic Operators</a></dt><dd></dd></dl><dl><dt>language <a class="link" href="#IG31371888179">Introduction to <code class="command">pmie</code></a> <a class="link" href="#IG31371888188">Specification Language for <code class="command">pmie</code></a></dt><dd></dd></dl><dl><dt>logical expressions <a class="link" href="#ITch06-16"><code class="command">pmie</code> Logical Expressions</a></dt><dd></dd></dl><dl><dt>metric expressions <a class="link" href="#ITch06-13"><code class="command">pmie</code> Metric Expressions</a></dt><dd></dd></dl><dl><dt>performance metrics inference engine <a class="link" href="#ITch06-0">Performance Metrics Inference Engine</a></dt><dd></dd></dl><dl><dt>pmieconf rules <a class="link" href="#IG3137188830">Performance Monitoring and Visualization</a> <a class="link" href="#IG31371888234">Creating <code class="command">pmie</code> Rules with <code class="command"> pmieconf</code></a></dt><dd></dd></dl><dl><dt>procedures <a class="link" href="#IG31371888236">Creating <code class="command">pmie</code> Rules with <code class="command"> pmieconf</code></a> <a class="link" href="#IG31371888237">Management of <code class="command">pmie</code> Processes</a></dt><dd></dd></dl><dl><dt>rate conversion <a class="link" href="#ITch06-14"><code class="command">pmie</code> Rate Conversion</a></dt><dd></dd></dl><dl><dt>rate operator <a class="link" href="#IG31371888223">The <code class="command">rate</code> Operator</a></dt><dd></dd></dl><dl><dt>real examples <a class="link" href="#ITch06-18"><code class="command">pmie</code> Examples</a></dt><dd></dd></dl><dl><dt>remote PMCD <a class="link" href="#IG31371888103">Cannot Connect to Remote PMCD</a></dt><dd></dd></dl><dl><dt>sample intervals <a class="link" href="#ITch06-22"><code class="command">pmie</code> Sample Intervals</a></dt><dd></dd></dl><dl><dt>setting evaluation frequency <a class="link" href="#ITch06-12">Setting Evaluation Frequency</a></dt><dd></dd></dl><dl><dt>syntax <a class="link" href="#ITch06-11">Basic <code class="command">pmie</code> Syntax</a></dt><dd></dd></dl><dl><dt>transitional operators <a class="link" href="#IG31371888225">Transitional Operators</a></dt><dd></dd></dl></dd><dt>pmevent tool</dt><dd><dl><dt>brief description <a class="link" href="#IG3137188713">Performance Monitoring and Visualization</a></dt><dd></dd></dl></dd><dt>pmieconf tool</dt><dd><dl><dt>brief description <a class="link" href="#IG3137188829">Performance Monitoring and Visualization</a></dt><dd></dd></dl><dl><dt>customization <a class="link" href="#IG31371888185">Introduction to <code class="command">pmie</code></a></dt><dd></dd></dl><dl><dt>rules <a class="link" href="#IG31371888235">Creating <code class="command">pmie</code> Rules with <code class="command"> pmieconf</code></a></dt><dd></dd></dl></dd><dt>pminfo tool</dt><dd><dl><dt>brief description <a class="link" href="#ITch01-34">Performance Monitoring and Visualization</a></dt><dd></dd></dl><dl><dt>description <a class="link" href="#ITch04-25">The <code class="command">pminfo</code> Command</a></dt><dd></dd></dl><dl><dt>displaying the PMNS <a class="link" href="#IG3137188897">Performance Metrics Name Space</a></dt><dd></dd></dl><dl><dt>PCP Tutorials and Case Studies <a class="link" href="#IG31371888175">The <code class="command">pminfo</code> Command</a></dt><dd></dd></dl><dl><dt>pmie arguments <a class="link" href="#IG31371888187"><code class="command">pmie</code> and the Performance Metrics Collection System</a></dt><dd></dd></dl></dd><dt>pmstat tool</dt><dd><dl><dt>brief description <a class="link" href="#ITch01-37">Performance Monitoring and Visualization</a></dt><dd></dd></dl><dl><dt>description <a class="link" href="#ITch04-20">The <code class="command">pmstat</code> Command</a></dt><dd></dd></dl></dd><dt>pmlc tool</dt><dd><dl><dt>brief description <a class="link" href="#ITch01-68">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd></dl><dl><dt>description <a class="link" href="#ITch07-17">Using <code class="command">pmlc</code></a></dt><dd></dd></dl><dl><dt>dynamic adjustment <a class="link" href="#IG31371888240">Introduction to Archive Logging</a></dt><dd></dd></dl><dl><dt>flush command <a class="link" href="#IG31371888254">Coordination between <code class="command">pmlogger</code> and PCP tools</a></dt><dd></dd></dl><dl><dt>PMLOGGER_PORT variable <a class="link" href="#IG31371888150">PCP Environment Variables</a></dt><dd></dd></dl><dl><dt>PMLOGGER_LOCAL variable <a class="link" href="#IG31371888142">PCP Environment Variables</a></dt><dd></dd></dl><dl><dt>show command <a class="link" href="#IG31371888302">Primary <code class="command">pmlogger</code> Cannot Start</a></dt><dd></dd></dl><dl><dt>SIGHUP signal <a class="link" href="#IG31371888264">Log Volumes</a></dt><dd></dd></dl><dl><dt>TCP/IP firewall <a class="link" href="#IG31371888159">Running PCP Tools through a Firewall</a></dt><dd></dd></dl></dd><dt>pmlock tool <a class="link" href="#ITch01-95">Operational and Infrastructure Support</a></dt><dd></dd><dt>pmlogcheck tool <a class="link" href="#IG3137188844">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmlogconf tool <a class="link" href="#IG3137188845">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmlogextract tool <a class="link" href="#ITch01-72">Collecting, Transporting, and Archiving Performance Information </a> <a class="link" href="#ITch07-10">Manipulating Archive Logs with <code class="command">pmlogextract</code></a></dt><dd></dd><dt>pmlogger tool <a class="link" href="#IG31371888149">PCP Environment Variables</a> <a class="link" href="#IG31371888208"><code class="command">pmie</code> Rule Expressions</a></dt><dd><dl><dt>archive logs <a class="link" href="#IG31371888117">Fetching Metrics from an Archive Log</a> <a class="link" href="#ITch07-2">Introduction to Archive Logging</a></dt><dd></dd></dl><dl><dt>brief description <a class="link" href="#IG3137188846">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd></dl><dl><dt>configuration <a class="link" href="#IG31371888267">Configuration of <code class="command">pmlogger</code></a> <a class="link" href="#IG31371888298">Using <code class="command">pmlc</code></a></dt><dd></dd></dl><dl><dt>cookbook tasks <a class="link" href="#IG31371888271">Cookbook for Archive Logging</a></dt><dd></dd></dl><dl><dt>current metric context <a class="link" href="#IG3137188865">Current Metric Context</a></dt><dd></dd></dl><dl><dt>folios <a class="link" href="#IG31371888294">PCP Archive Folios</a></dt><dd></dd></dl><dl><dt>PCP tool coordination <a class="link" href="#IG31371888251">Coordination between <code class="command">pmlogger</code> and PCP tools</a></dt><dd></dd></dl><dl><dt>pmlc control <a class="link" href="#IG31371888241">Introduction to Archive Logging</a></dt><dd></dd></dl><dl><dt>primary instance <a class="link" href="#ITch07-16">Primary Logger</a></dt><dd></dd></dl><dl><dt>remote PMCD <a class="link" href="#IG31371888104">Cannot Connect to Remote PMCD</a></dt><dd></dd></dl><dl><dt>TCP/IP firewall <a class="link" href="#IG31371888158">Running PCP Tools through a Firewall</a></dt><dd></dd></dl><dl><dt>troubleshooting <a class="link" href="#IG31371888300">Archive Logging Troubleshooting</a></dt><dd></dd></dl></dd><dt>pmlogger_check script <a class="link" href="#IG3137188854">Operational and Infrastructure Support</a> <a class="link" href="#ITch07-7">Administering PCP Archive Logs Using <code class="command">cron</code> Scripts </a></dt><dd></dd><dt>pmlogger_daily script <a class="link" href="#IG3137188855">Operational and Infrastructure Support</a> <a class="link" href="#IG31371888256">Administering PCP Archive Logs Using <code class="command">cron</code> Scripts </a></dt><dd></dd><dt>pmlogger_merge script <a class="link" href="#IG3137188856">Operational and Infrastructure Support</a> <a class="link" href="#IG31371888258">Administering PCP Archive Logs Using <code class="command">cron</code> Scripts </a></dt><dd></dd><dt>PMLOGGER_PORT variable <a class="link" href="#IG31371888161">Running PCP Tools through a Firewall</a> <a class="link" href="#IG31371888148">PCP Environment Variables</a></dt><dd></dd><dt>PMLOGGER_LOCAL variable <a class="link" href="#IG31371889148">PCP Environment Variables</a></dt><dd></dd><dt>pmlogsummary tool <a class="link" href="#IG3137188831">Performance Monitoring and Visualization </a> <a class="link" href="#ITch07-11">Summarizing Archive Logs with <code class="command">pmlogsummary</code></a></dt><dd></dd><dt>pmnewlog tool <a class="link" href="#ITch01-100">Operational and Infrastructure Support</a></dt><dd></dd><dt>PMNS</dt><dd><dl><dt>acronym <a class="link" href="#ITchA-12">Acronyms</a></dt><dd></dd></dl><dl><dt>brief description <a class="link" href="#IG3137188864">Performance Metrics</a></dt><dd></dd></dl><dl><dt>defined names <a class="link" href="#IG3137188811">Uniform Naming and Access to Performance Metrics </a></dt><dd></dd></dl><dl><dt>description <a class="link" href="#ITch01-144">Performance Metrics Name Space</a></dt><dd></dd></dl><dl><dt>management <a class="link" href="#IG31371888322">PMNS Management</a></dt><dd></dd></dl><dl><dt>metric expressions <a class="link" href="#IG31371888194"><code class="command">pmie</code> Metric Expressions</a></dt><dd></dd></dl><dl><dt>names <a class="link" href="#IG31371888315">Customizing the Summary PMDA</a></dt><dd></dd></dl><dl><dt>PMNS <a class="link" href="#ITch03-10">Alternate Performance Metric Name Spaces</a></dt><dd></dd></dl><dl><dt>syntax <a class="link" href="#ITch09-4">PMNS Syntax</a></dt><dd></dd></dl><dl><dt>troubleshooting <a class="link" href="#IG3137188898">Performance Metrics Name Space</a></dt><dd></dd></dl></dd><dt>PMPROXY_PORT variable <a class="link" href="#ITch03-30">PCP Environment Variables</a></dt><dd></dd><dt>PMPROXY_LOCAL variable <a class="link" href="#ITch03-31">PCP Environment Variables</a></dt><dd></dd><dt>pmnsadd tool <a class="link" href="#ITch01-102">Operational and Infrastructure Support</a></dt><dd></dd><dt>pmnsdel tool <a class="link" href="#ITch01-106">Operational and Infrastructure Support</a></dt><dd></dd><dt>pmprintf tool <a class="link" href="#IG31371888140">PCP Environment Variables</a></dt><dd></dd><dt>pmprobe tool <a class="link" href="#IG3137188832">Performance Monitoring and Visualization</a></dt><dd></dd><dt>pmrun tool <a class="link" href="#IG31371888114">Common Conventions and Arguments</a></dt><dd></dd><dt>pmsnap tool</dt><dd><dl><dt>brief description <a class="link" href="#IG3137188857">Operational and Infrastructure Support</a></dt><dd></dd></dl><dl><dt>script usage <a class="link" href="#IG31371888257">Administering PCP Archive Logs Using <code class="command">cron</code> Scripts </a></dt><dd></dd></dl></dd><dt>pmproxy tool</dt><dd><dl><dt>brief description <a class="link" href="#ITch01-38">Performance Monitoring and Visualization</a></dt><dd></dd></dl><dl><dt>pmproxy port <a class="link" href="#IG31371888152">PCP Environment Variables</a></dt><dd></dd></dl><dl><dt>pmproxy local <a class="link" href="#IG31371888152">PCP Environment Variables</a></dt><dd></dd></dl><dl><dt>TCP/IP firewall <a class="link" href="#IG31371888156">Running PCP Tools through a Firewall</a></dt><dd></dd></dl></dd><dt>pmstore tool</dt><dd><dl><dt>brief description <a class="link" href="#ITch01-112">Operational and Infrastructure Support</a></dt><dd></dd></dl><dl><dt>description <a class="link" href="#ITch04-26">The <code class="command">pmstore</code> Command</a></dt><dd></dd></dl><dl><dt>setting metric values <a class="link" href="#IG31371888169">Monitoring System Performance</a></dt><dd></dd></dl></dd><dt>pmtrace tool <a class="link" href="#ITch01-74">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>pmval tool</dt><dd><dl><dt>brief description <a class="link" href="#ITch01-42">Performance Monitoring and Visualization</a></dt><dd></dd></dl><dl><dt>description <a class="link" href="#ITch04-23">The <code class="command">pmval</code> Command</a></dt><dd></dd></dl></dd><dt>pmwebd tool <a class="link" href="#IG3137188802">Collecting, Transporting, and Archiving Performance Information </a></dt><dd></dd><dt>primary archive <a class="link" href="#IG31371888272">Primary Logger</a></dt><dd></dd><dt>primary logger <a class="link" href="#ITch07-14">Primary Logger</a></dt><dd></dd><dt>protocol data units</dt><dd><dt>(see PDU)</dt></dd><dt>quantification operators <a class="link" href="#IG31371888204">Quantification Operators</a></dt><dd></dd><dt>rate conversion <a class="link" href="#IG31371888198"><code class="command">pmie</code> Rate Conversion</a></dt><dd></dd><dt>rate operator <a class="link" href="#IG31371888224">The <code class="command">rate</code> Operator</a></dt><dd></dd><dt>relational expressions <a class="link" href="#IG31371888202">Relational Expressions</a></dt><dd></dd><dt>reporting frequency <a class="link" href="#IG31371888130">Performance Monitor Reporting Frequency and Duration</a></dt><dd></dd><dt>retrospective analysis <a class="link" href="#IG31371888248">Retrospective Analysis Using Archive Logs</a></dt><dd></dd><dt>roles</dt><dd><dl><dt>collector <a class="link" href="#ITch01-155">Collector and Monitor Roles</a> <a class="link" href="#IG3137188888">Product Structure</a></dt><dd></dd></dl><dl><dt>monitor <a class="link" href="#IG3137188879">Collector and Monitor Roles</a> <a class="link" href="#IG3137188889">Product Structure</a></dt><dd></dd></dl></dd><dt>rule expressions <a class="link" href="#IG31371888206"><code class="command">pmie</code> Rule Expressions</a></dt><dd></dd><dt>sample intervals <a class="link" href="#IG31371888232"><code class="command">pmie</code> Sample Intervals</a></dt><dd></dd><dt>kernel data structures <a class="link" href="#IG3137188866">Sources of Performance Metrics and Their Domains</a></dt><dd></dd><dt>scripts <a class="link" href="#IG3137188858">Operational and Infrastructure Support</a> <a class="link" href="#IG31371888255">Administering PCP Archive Logs Using <code class="command">cron</code> Scripts </a></dt><dd></dd><dt>service management <a class="link" href="#IG31371888311">Quality of Service Measurement</a></dt><dd></dd><dt>set-valued performance metrics <a class="link" href="#IG3137188878">Set-Valued Performance Metrics</a></dt><dd></dd><dt>show command <a class="link" href="#IG31371888301">Primary <code class="command">pmlogger</code> Cannot Start</a></dt><dd></dd><dt>SIGHUP signal <a class="link" href="#IG31371888107">PMCD Not Reconfiguring after <code class="literal">SIGHUP</code></a> <a class="link" href="#IG31371888263">Log Volumes</a></dt><dd></dd><dt>SIGINT signal <a class="link" href="#IG31371888303">Primary <code class="command">pmlogger</code> Cannot Start</a></dt><dd></dd><dt>SIGUSR1 signal <a class="link" href="#IG31371888252">Coordination between <code class="command">pmlogger</code> and PCP tools</a></dt><dd></dd><dt>single-valued performance metrics <a class="link" href="#IG3137188877">Single-Valued Performance Metrics</a></dt><dd></dd><dt>PROXY protocol <a class="link" href="#IG31371888155">Running PCP Tools through a Firewall</a></dt><dd></dd><dt>software <a class="link" href="#IG3137188825">Overview of Component Software</a></dt><dd></dd><dt>subsystems <a class="link" href="#IG3137188887">Product Structure</a></dt><dd></dd><dt>sum_host operator <a class="link" href="#IG31371888217">Arithmetic Aggregation</a></dt><dd></dd><dt>syntax <a class="link" href="#IG31371888323">PMNS Syntax</a></dt><dd></dd><dt>syslog function <a class="link" href="#IG31371888181">Introduction to <code class="command">pmie</code></a> <a class="link" href="#IG31371888209"><code class="command">pmie</code> Rule Expressions</a></dt><dd></dd><dt>system log file <a class="link" href="#IG31371888182">Introduction to <code class="command">pmie</code></a> <a class="link" href="#IG31371888212"><code class="command">pmie</code> Rule Expressions</a></dt><dd></dd><dt>target usage <a class="link" href="#IG313718883">PCP Target Usage</a></dt><dd></dd><dt>TCP/IP</dt><dd><dl><dt>acronym <a class="link" href="#ITchA-13">Acronyms</a></dt><dd></dd></dl><dl><dt>collector and monitor hosts <a class="link" href="#IG31371888154">Running PCP Tools through a Firewall</a></dt><dd></dd></dl><dl><dt>remote PMCD <a class="link" href="#IG31371888105">Cannot Connect to Remote PMCD</a></dt><dd></dd></dl><dl><dt>sockets <a class="link" href="#IG31371888145">PCP Environment Variables</a></dt><dd></dd></dl></dd><dt>text-based tools <a class="link" href="#IG31371888170">Monitoring System Performance</a></dt><dd></dd><dt>time dilation <a class="link" href="#ITch03-33">Time Dilation and Time Skew</a></dt><dd></dd><dt>time duration <a class="link" href="#IG31371888129">Time Duration and Control</a></dt><dd></dd><dt>time window options <a class="link" href="#IG31371888133">Time Window Options</a></dt><dd></dd><dt>time-stamped message <a class="link" href="#IG31371888210"><code class="command">pmie</code> Rule Expressions</a></dt><dd></dd><dt>timezone options <a class="link" href="#ITch03-12">Timezone Options</a></dt><dd></dd><dt>tool customization <a class="link" href="#IG31371888317">PCP Tool Customization</a></dt><dd></dd><dt>tool development <a class="link" href="#IG31371888324">PCP Tool Development</a></dt><dd></dd><dt>tool options <a class="link" href="#IG31371888118">General PCP Tool Options</a> <a class="link" href="#ITch06-1">Performance Metrics Inference Engine</a></dt><dd></dd><dt>transient problems <a class="link" href="#IG31371888164">Transient Problems with Performance Metric Values </a></dt><dd></dd><dt>transitional operators <a class="link" href="#IG31371888226">Transitional Operators</a></dt><dd></dd><dt>troubleshooting</dt><dd><dl><dt>archive logging <a class="link" href="#ITch07-19">Archive Logging Troubleshooting</a></dt><dd></dd></dl><dl><dt>general utilities <a class="link" href="#ITch02-42">Cannot Connect to Remote PMCD</a></dt><dd></dd></dl><dl><dt>kernel metrics <a class="link" href="#IG3137188899">Kernel Metrics and the PMCD</a></dt><dd></dd></dl><dl><dt>PMCD <a class="link" href="#ITch02-38">Troubleshooting</a> <a class="link" href="#IG31371888100">Kernel Metrics and the PMCD</a></dt><dd></dd></dl></dd><dt>uniform naming <a class="link" href="#IG313718889">Uniform Naming and Access to Performance Metrics </a></dt><dd></dd><dt>units <a class="link" href="#IG31371888192">Units</a></dt><dd></dd><dt>user interface components <a class="link" href="#Z1033415461tls">Common Conventions and Arguments</a></dt><dd></dd><dt>${PCP_BINADM_DIR}/pmcd file <a class="link" href="#IG31371888125">Common Directories and File Locations</a></dt><dd></dd><dt>${PCP_LOG_DIR}/NOTICES file <a class="link" href="#IG31371888183">Introduction to <code class="command">pmie</code></a></dt><dd></dd><dt>${PCP_LOGDIR}/pmcd/pmcd.log file <a class="link" href="#IG31371888110">PMCD Does Not Start</a></dt><dd></dd><dt>${PCP_PMCDOPTIONS_PATH} file <a class="link" href="#IG31371888126">Common Directories and File Locations</a></dt><dd></dd><dt>${PCP_PMCDCONF_PATH} file<a class="link" href="#IG3137188896">PMDA Installation on a PCP Collector Host</a> <a class="link" href="#IG31371888108">PMCD Not Reconfiguring after <code class="literal">SIGHUP</code></a> <a class="link" href="#IG31371888123">Common Directories and File Locations</a></dt><dd></dd><dt>${PCP_SYSCONF_DIR}/pmlogger/config.default file <a class="link" href="#IG31371888297">Primary Logger</a></dt><dd></dd><dt>${PCP_PMLOGGERCONTROL_PATH} file <a class="link" href="#IG31371888259">Administering PCP Archive Logs Using <code class="command">cron</code> Scripts </a> <a class="link" href="#IG31371888266">Directory Organization for Archive Log Files</a></dt><dd></dd><dt>${PCP_DEMOS_DIR} <a class="link" href="#IG31371888228"><code class="command">pmie</code> Examples</a></dt><dd></dd><dt>${PCP_VAR_DIR}/pmns/stdpmid file <a class="link" href="#IG3137188895">PMDA Installation on a PCP Collector Host</a></dt><dd></dd><dt>${PCP_TMP_DIR}/pmlogger files <a class="link" href="#IG31371888305">Primary <code class="command">pmlogger</code> Cannot Start</a></dt><dd></dd><dt>window options <a class="link" href="#IG31371888134">Time Window Options</a></dt><dd></dd></dl></div></div></div></div></div></div>
<footer xmlns="" class="global-footer is-typeset">
  <div class="row-parent">
    <div class="row">
      <section class="row__colspaced"><div class="colspan12-3 colspan8-2 colspan6-2 colspan2-2 as-grid with-gutter">
          <div class="col__module">
            <h4>Main Menu</h4>
            <ul>
              <li>
                <a href="/features.html">Features</a>
              </li>
              <li>
                <a href="/documentation.html">Documentation</a>
              </li>
              <li>
                <a class="download" href="/download.html">Download</a>
              </li>
            </ul>
          </div>
        </div><div class="colspan12-3 colspan8-2 colspan6-2 colspan2-2 as-grid with-gutter">
          <div class="col__module">
            <h4>Developers</h4>
            <ul>
              <li>
                <a href="http://git.pcp.io/bugzilla">Report a bug</a>
              </li>
              <li>
                <a href="/community.html">Contributing</a>
              </li>
              <li>
                <a href="/team.html">Team</a>
              </li>
            </ul>
          </div>
        </div><div class="colspan12-3 colspan8-2 colspan6-2 colspan2-2 as-grid with-gutter">
          <div class="col__module">
            <h4>About</h4>
            <ul>
              <li>
                <a href="/news.html">News</a>
              </li>
              <li>
                <a href="/testimonials.html">Testimonials</a>
              </li>
              <li>
                <a href="/faq.html">FAQ</a>
              </li>
              <li>
                <a href="/website.html">Website</a>
              </li>
            </ul>
          </div>
        </div><div class="colspan12-3 colspan8-2 colspan6-2 colspan2-2 as-grid with-gutter">
          <div class="col__module">
            <h4>Get Social</h4>
            <ul>
              <li>
                <a class="twitter" href="https://twitter.com/performancepcp" rel="external">Twitter</a>
              </li>
              <li>
                <a class="github" href="https://github.com/performancecopilot" rel="external">Github</a>
              </li>
            </ul>
          </div>
        </div></section>
    </div>
    <div class="row">
      <div class="colspan2-2">
        <p class="legal">
          Copyright 2000-2004 Silicon Graphics Inc, 2007-2010 Aconex, 2012-2015 Red Hat
        </p>
      </div>
    </div>
  </div>
</footer>
</body></html>