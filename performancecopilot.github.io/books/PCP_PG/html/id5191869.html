<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format"><head xmlns="http://www.w3.org/1999/xhtml"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns:d="http://docbook.org/ns/docbook">2.4.5. Management of Evolution within a PMDA</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.2" /><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content="PCP-pcp-programmers-guide-3-en-US-4.0-4" /><link rel="home" href="index.html" title="Performance Co-Pilot™ Programmer's Guide" /><link rel="up" href="id5191164.html" title="2.4. Other Issues" /><link rel="prev" href="LE72473-PARENT.html" title="2.4.4. PMDA Help Text" /><link rel="next" href="LE21831-PARENT.html" title="2.5. PMDA Interface" />
<meta xmlns="" charset="utf-8" />
<meta xmlns="" content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
<meta xmlns="" content="initial-scale=1" name="viewport" />
<title xmlns="">Performance Co-Pilot</title>
<link xmlns="" href="/assets/css/screen.css" media="all" rel="stylesheet" type="text/css" />
<link xmlns="" href="/assets/css/master.css" media="all" rel="stylesheet" type="text/css" />
<link xmlns="" href="/images/pcp.ico" rel="shortcut icon" type="image/ico" />
</head><body>
    <header xmlns="" class="global-header">
      <div class="row">
        <h1 class="global-logo colspan12-6 colspan8-4 colspan6-3 colspan2-1 as-grid">
          <a href="/index.html">Performance Co-Pilot</a>
        </h1>
        <nav class="global-header__navigation colspan12-6 colspan8-6 colspan6-4 colspan2-1 as-grid">
          <ul>
            <li>
              <a href="/features.html">Features</a>
            </li>
            <li>
              <a href="/documentation.html">Documentation</a>
            </li>
            <li>
              <a href="/download.html">Download</a>
            </li>
            <li>
              <a href="/community.html">Get Involved</a>
            </li>
          </ul>
        </nav>
      </div>
    </header>
<div class="site-content"><div class="how-to is-typeset"><div class="row-parent"><div class="row"><p xmlns="http://www.w3.org/1999/xhtml" id="title"><a class="left" href="http://www.pcp.io"><img alt="Product Site" src="Common_Content/images//image_left.png" /></a><a class="right" href="http://www.pcp.io/documentation.html"><img alt="Documentation Site" src="Common_Content/images//image_right.png" /></a></p><ul xmlns="http://www.w3.org/1999/xhtml" class="docnav top"><li class="previous"><a accesskey="p" href="LE72473-PARENT.html"><strong>Prev</strong></a></li><li class="home">pcp-programmers-guide</li><li class="next"><a accesskey="n" href="LE21831-PARENT.html"><strong>Next</strong></a></li></ul><div xmlns="http://www.w3.org/1999/xhtml" class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="id5191869">
      ⁠</a>2.4.5. Management of Evolution within a PMDA</h3></div></div></div><div class="para">
					<a id="IG31340177160" class="indexterm"></a> <a id="IG31340177161" class="indexterm"></a>Evolution of a PMDA, or more particularly the underlying instrumentation to which it provides access, over time naturally results in the appearance of new metrics and the disappearance of old metrics. This creates potential problems for PMAPI clients and PCP tools that may be required to interact with both new and former versions of the PMDA.
				</div><div class="para">
					The following guidelines are intended to help reduce the complexity of implementing a PMDA in the face of evolutionary change, while maintaining predictability and semantic coherence for tools using the PMAPI, and for end users of those tools.
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							<a id="IG31340177162" class="indexterm"></a>Try to support as full a range of metrics as possible in every version of the PMDA. In this context, <em class="firstterm">support</em> means responding sensibly to requests, even if the underlying instrumentation is not available.
						</div></li><li class="listitem"><div class="para">
							<a id="IG31340177163" class="indexterm"></a> <a id="IG31340177164" class="indexterm"></a> <a id="IG31340177165" class="indexterm"></a>If a metric is not supported in a given version of the underlying instrumentation, the PMDA should respond to <code class="command">pmLookupDesc</code> requests with a <code class="filename">pmDesc</code> structure whose <code class="literal">type</code> field has the special value <code class="literal">PM_TYPE_NOSUPPORT</code>. Values of fields other than <code class="literal">pmid</code> and <code class="literal">type</code> are immaterial, but <a class="xref" href="id5191869.html#Z976047129sdc">Example 2.19, “ Setting Values”</a> is typically benign:
						</div><div class="example"><a id="Z976047129sdc">
      ⁠</a><p class="title"><strong>Example 2.19.  Setting Values</strong></p><div class="example-contents"><pre class="programlisting">pmDesc dummy = { 
     .pmid  = PMDA_PMID(3,0),           /* pmid, fill this in */
     .type  = PM_TYPE_NOSUPPORT,        /* this is the important part */
     .indom = PM_INDOM_NULL,            /* singular,causes no problems */
     .sem   = 0,                        /* no semantics */
     .units = PMDA_PMUNITS(0,0,0,0,0,0) /* no units */
};</pre></div></div></li><li class="listitem"><div class="para">
							<a id="IG31340177166" class="indexterm"></a> <a id="IG31340177167" class="indexterm"></a>If a metric lacks support in a particular version of the underlying instrumentation, the PMDA should respond to <code class="command">pmFetch</code> requests with a <code class="command">pmResult</code> in which no values are returned for the unsupported metric. This is marginally friendlier than the other semantically acceptable option of returning an illegal PMID error or <code class="literal">PM_ERR_PMID</code>.
						</div></li><li class="listitem"><div class="para">
							<a id="IG31340177168" class="indexterm"></a> <a id="IG31340177169" class="indexterm"></a>Help text should be updated with annotations to describe different versions of the underlying product, or product configuration options, for which a specific metric is available. This is so <code class="command">pmLookupText</code> can always respond correctly.
						</div></li><li class="listitem"><div class="para">
							<a id="IG31340177170" class="indexterm"></a> <a id="IG31340177171" class="indexterm"></a>The <code class="command">pmStore</code> operation should fail with return status of <code class="literal">PM_ERR_PERMISSION</code> if a user or application tries to amend the value of an unsupported metric.
						</div></li><li class="listitem"><div class="para">
							<a id="IG31340177172" class="indexterm"></a> <a id="IG31340177173" class="indexterm"></a> <a id="IG31340177174" class="indexterm"></a> <a id="IG31340177175" class="indexterm"></a> <a id="IG31340177176" class="indexterm"></a> <a id="IG31340177177" class="indexterm"></a>The value extraction, conversion, and printing functions (<code class="command">pmExtractValue</code>, <code class="command">pmConvScale</code>, <code class="command">pmAtomStr</code>, <code class="command">pmTypeStr</code>, and <code class="command">pmPrintValue</code>) return the <code class="literal">PM_ERR_CONV</code> error or an appropriate diagnostic string, if an attempt is made to operate on a value for which <code class="literal">type</code> is <code class="literal">PM_TYPE_NOSUPPORT</code>.
						</div><div class="para">
							If performance tools take note of the <code class="literal">type</code> field in the <code class="filename">pmDesc</code> structure, they should not manipulate values for unsupported metrics. Even if tools ignore <code class="literal">type</code> in the metric's description, following these development guidelines ensures that no misleading value is ever returned; so there is no reason to call the extraction, conversion, and printing functions.
						</div></li></ul></div></div><ul xmlns="http://www.w3.org/1999/xhtml" class="docnav"><li class="previous"><a accesskey="p" href="LE72473-PARENT.html"><strong>Prev</strong>2.4.4. PMDA Help Text</a></li><li class="up"><a accesskey="u" href="#"><strong>Up</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Home</strong></a></li><li class="next"><a accesskey="n" href="LE21831-PARENT.html"><strong>Next</strong>2.5. PMDA Interface</a></li></ul></div></div></div></div>
<footer xmlns="" class="global-footer is-typeset">
  <div class="row-parent">
    <div class="row">
      <section class="row__colspaced"><div class="colspan12-3 colspan8-2 colspan6-2 colspan2-2 as-grid with-gutter">
          <div class="col__module">
            <h4>Main Menu</h4>
            <ul>
              <li>
                <a href="/features.html">Features</a>
              </li>
              <li>
                <a href="/documentation.html">Documentation</a>
              </li>
              <li>
                <a class="download" href="/download.html">Download</a>
              </li>
            </ul>
          </div>
        </div><div class="colspan12-3 colspan8-2 colspan6-2 colspan2-2 as-grid with-gutter">
          <div class="col__module">
            <h4>Developers</h4>
            <ul>
              <li>
                <a href="http://git.pcp.io/bugzilla">Report a bug</a>
              </li>
              <li>
                <a href="/community.html">Contributing</a>
              </li>
              <li>
                <a href="/team.html">Team</a>
              </li>
            </ul>
          </div>
        </div><div class="colspan12-3 colspan8-2 colspan6-2 colspan2-2 as-grid with-gutter">
          <div class="col__module">
            <h4>About</h4>
            <ul>
              <li>
                <a href="/news.html">News</a>
              </li>
              <li>
                <a href="/testimonials.html">Testimonials</a>
              </li>
              <li>
                <a href="/faq.html">FAQ</a>
              </li>
              <li>
                <a href="/website.html">Website</a>
              </li>
            </ul>
          </div>
        </div><div class="colspan12-3 colspan8-2 colspan6-2 colspan2-2 as-grid with-gutter">
          <div class="col__module">
            <h4>Get Social</h4>
            <ul>
              <li>
                <a class="twitter" href="https://twitter.com/performancepcp" rel="external">Twitter</a>
              </li>
              <li>
                <a class="github" href="https://github.com/performancecopilot" rel="external">Github</a>
              </li>
            </ul>
          </div>
        </div></section>
    </div>
    <div class="row">
      <div class="colspan2-2">
        <p class="legal">
          Copyright 2000-2004 Silicon Graphics Inc, 2007-2010 Aconex, 2012-2015 Red Hat
        </p>
      </div>
    </div>
  </div>
</footer>
</body></html>